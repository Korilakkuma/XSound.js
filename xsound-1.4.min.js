/** 
 * xsound.min.js
 * @fileoverview Web Audio API Library
 *
 * Copyright 2012, 2013, 2014@Tomohiro IKEDA
 * Released under the MIT license
 */
(function(v){function K(){}function A(){this.media=null;this.ext="";this.duration=0;this.playbackRate=this.volume=1;this.muted=this.loop=this.controls=!1;this.callbacks={}}function w(a,e){function b(a){this.listener=a.listener;this.dopplerFactor=1;this.speedOfSound=343.3;this.positions={x:0,y:0,z:0};this.fronts={x:0,y:0,z:-1};this.ups={x:0,y:1,z:0};this.velocities={x:0,y:0,z:0};this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z);this.listener.setOrientation(this.fronts.x,
this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z);this.listener.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z)}function g(a){function t(a){this.isActive=!1;this.SAMPLE_RATE=a;this.drawType="";this.svgParent=this.svg=this.context=this.canvas=null;this.interval=1E3;this.timerid=null;this.styles={shape:"line",grad:[{offset:0,color:"rgba(0, 128, 255, 1.0)"},{offset:1,color:"rgba(0, 0, 255, 1.0)"}],wave:"rgba(0, 0, 255, 1.0)",grid:"rgba(255, 0, 0, 1.0)",text:"rgba(255, 255, 255, 1.0)",
font:"13px Arial",width:1.5,cap:"round",join:"miter",top:15,right:15,bottom:15,left:15}}function h(a){t.call(this,a);this.savedImage=null;this.length=0;this.currentTime="rgba(255, 255, 255, 1.0)";this.plotinterval=.0625;this.textinterval=60}function c(a){t.call(this,a);this.textinterval=.005}function b(a){t.call(this,a);this.type="uint";this.size=256;this.textinterval=1E3}v.requestAnimationFrame=v.requestAnimationFrame||v.webkitRequestAnimationFrame||v.mozRequestAnimationFrame||function(a){v.setTimeout(a,
1E3/60)};v.cancelAnimationFrame=v.cancelAnimationFrame||v.webkitCancelAnimationFrame||v.mozCancelAnimationFrame||v.clearTimeout;this.analyser=a.createAnalyser();this.input=a.createGain();this.output=a.createGain();this.input.connect(this.analyser);this.analyser.connect(this.output);t.prototype=Object.create(K.prototype);t.prototype.constructor=t;h.prototype=Object.create(t.prototype);c.prototype=Object.create(t.prototype);b.prototype=Object.create(t.prototype);h.prototype.constructor=h;c.prototype.constructor=
c;b.prototype.constructor=b;this.timeAllL=new h(a.sampleRate);this.timeAllR=new h(a.sampleRate);this.time=new c(a.sampleRate);this.fft=new b(a.sampleRate);this.analyser.fftSize=2048;this.analyser.minDecibels=-100;this.analyser.maxDecibels=-30;this.analyser.smoothingTimeConstant=.8;t.prototype.setup=function(a,k,c){switch(String(a).toLowerCase()){case "canvas":this.drawType="canvas";this.canvas=document.getElementById(String(k));this.canvas instanceof HTMLCanvasElement&&(this.context=this.canvas.getContext("2d"));
break;case "svg":this.drawType="svg",this.svg=document.getElementById(String(k)),this.svg instanceof SVGElement&&(this.svgParent=document.getElementById(String(c)))}return this};t.prototype.param=function(a,k){var c=String(a).replace(/-/g,"").toLowerCase();switch(c){case "interval":if(void 0===k)return this.interval;if("auto"===String(k).toLowerCase())this.interval="auto";else{var h=parseFloat(k);0<=h&&(this.interval=h)}break;case "shape":if(void 0===k)return this.styles.shape;h=String(k).toLowerCase();
if("line"===h||"rect"===h)this.styles.shape="gradient"!==this.styles.wave?h:"rect";break;case "grad":if(void 0===k)return this.styles.grad;Array.isArray(k)||(k=[k]);for(var c=!1,h=0,t=k.length;h<t;h++){var b=k[h];if("offset"in b&&"color"in b){if(b=parseFloat(b.offset),isNaN(b)||0>b||1<b){c=!0;break}}else{c=!0;break}}c||(this.styles.grad=k);break;case "wave":case "grid":case "text":case "font":case "cap":case "join":if(void 0===k)return this.styles[c];"string"===typeof k&&("wave"===c&&"gradient"===
k&&(this.styles.shape="rect"),this.styles[c]="font"===c?k:k.toLowerCase());break;case "width":case "top":case "right":case "bottom":case "left":if(void 0===k)return this.styles[c];h="width"===c?parseFloat(k):parseInt(k);0<=h&&(this.styles[c]=h)}};t.prototype.start=function(a,k,c){switch(this.drawType){case "canvas":this.drawToCanvas(a,k,c);break;case "svg":this.drawToSVG(a,k,c)}return this};t.prototype.download=function(){switch(this.drawType){case "canvas":return this.canvas.toDataURL("image/png").replace("image/png",
"image/octet-stream");case "svg":return this.svgParent.innerHTML;default:return this}};t.prototype.state=function(a){if(void 0===a)return this.isActive;"toggle"===String(a).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(a);return this};t.prototype.drawToCanvas=function(a){};t.prototype.drawToSVG=function(a){};t.prototype.toString=function(){return"[SoundModule Visualizer]"};h.prototype.param=function(a,k){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,
a[c]);else{c=String(a).replace(/-/g,"").toLowerCase();var h=t.prototype.param.call(this,c,k);if(void 0!==h)return h;switch(c){case "currenttime":if(void 0===k)return this.currentTime;"string"===typeof k&&(this.currentTime=k.toLowerCase());break;case "plotinterval":case "textinterval":if(void 0===k)return this[c];h=parseFloat(k);0<h&&(this[c]=h)}}return this};h.prototype.drawToCanvas=function(a){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var k=this.context,c=this.canvas.width,
h=this.canvas.height,t=c-(this.styles.left+this.styles.right),b=h-(this.styles.top+this.styles.bottom),e=Math.floor(b/2)+this.styles.top,g=0,d=0,f="",f=Math.floor(this.plotinterval*this.SAMPLE_RATE),l=Math.floor(this.textinterval*this.SAMPLE_RATE);k.clearRect(0,0,c,h);switch(this.styles.shape){case "line":k.strokeStyle=this.styles.wave;k.lineWidth=this.styles.width;k.lineCap=this.styles.cap;k.lineJoin=this.styles.join;k.beginPath();for(var x=0,p=a.length;x<p;x++)0===x%f&&(g=Math.floor(x/p*t)+this.styles.left,
d=Math.floor(b/2*(1-a[x]))+this.styles.top,0===x?k.moveTo(g,d):k.lineTo(g,d));k.stroke();break;case "rect":for("gradient"!==this.styles.wave&&(k.fillStyle=this.styles.wave),x=0,p=a.length;x<p;x++)if(0===x%f){g=Math.floor(x/p*t)+this.styles.left;d=-1*Math.floor(b/2*a[x]);if("gradient"===this.styles.wave){for(var m=b/2+this.styles.top,m=k.createLinearGradient(0,m,0,m+d),s=0,n=this.styles.grad.length;s<n;s++){var q=this.styles.grad[s];m.addColorStop(q.offset,q.color)}k.fillStyle=m}k.fillRect(g,e,this.styles.width,
d)}}if("none"!==this.styles.grid||"none"!==this.styles.text){x=0;for(p=a.length;x<p;x++)0===x%l&&(g=Math.floor(x/p*t)+this.styles.left,f=Math.floor(x/this.SAMPLE_RATE)+" min","none"!==this.styles.grid&&(k.fillStyle=this.styles.grid,k.fillRect(g,this.styles.top,1,b)),"none"!==this.styles.text&&(k.fillStyle=this.styles.text,k.font=this.styles.font,k.fillText(f,g-k.measureText(f).width/2,h)));e=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];x=0;for(p=e.length;x<p;x++)f=e[x],g=Math.floor(c-k.measureText(f).width),
d=Math.floor((1-parseFloat(f.trim()))*(b/2))+this.styles.top,"none"!==this.styles.grid&&(k.fillStyle=this.styles.grid,k.fillRect(this.styles.left,d,t,1)),d-=parseInt(k.font.match(/\s*(\d+)px.*/)[1]/4),"none"!==this.styles.text&&(k.fillStyle=this.styles.text,k.font=this.styles.font,k.fillText(f,g,d))}this.savedImage=k.getImageData(0,0,c,h);this.length=a.length;k.fillStyle=this.currentTime;k.fillRect(this.styles.left,this.styles.top,1,b);return this};h.prototype.drawToSVG=function(a){if(!(this.svg instanceof
SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return this;var k=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>",c=this.svg.getAttribute("width"),h=this.svg.getAttribute("height"),t=c-(this.styles.left+this.styles.right),b=h-(this.styles.top+this.styles.bottom),e=Math.floor(b/2)+this.styles.top,g=0,d=0,f="",f=Math.floor(this.plotinterval*this.SAMPLE_RATE),l=Math.floor(this.textinterval*this.SAMPLE_RATE),x="";switch(this.styles.shape){case "line":x+="stroke : "+
this.styles.wave+"; ";x=x+"fill : none; "+("stroke-width : "+this.styles.width+"; ");x+="stroke-linecap : "+this.styles.cap+"; ";x+="stroke-linejoin : "+this.styles.join+";";break;case "rect":if("gradient"===this.styles.wave){var p;p='<defs><linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var m=0,s=this.styles.grad.length;m<s;m++){var n=this.styles.grad[m];p+='<stop offset="'+n.offset+'" stop-color="'+n.color+'" />'}p+="</linearGradient>";p+="</defs>";x+="stroke : none; ";
x+="fill : url(#svg-linear-gradient); "}else x+="stroke : none; ",x+="fill : "+this.styles.wave+"; ";x+="stroke-width : 0;"}var n="stroke : none; "+("fill : "+this.styles.grid+"; "),n=n+"stroke-width : 0;",s=this.styles.font.match(/\s*(\d+)px (.*)/),m=s[2],q=s[1],r;r="stroke : none; "+("fill : "+this.styles.text+"; ");r+="font-family : "+m+"; ";r+="font-size : "+q+";";var B;B="stroke : none; "+("fill : "+this.currentTime+"; ");B+="stroke-width : 0;";this.svgParent.innerHTML=k;k=this.svgParent.innerHTML.replace("</svg>",
"");"gradient"===this.styles.wave&&(k+=p);switch(this.styles.shape){case "line":k+='<path style="'+x+'" d="';m=0;for(s=a.length;m<s;m++)0===m%f&&(g=Math.floor(m/s*t)+this.styles.left,d=Math.floor(b/2*(1-a[m]))+this.styles.top,0===m?k+="M"+g+" "+d:(k+=" ",k+="L"+g+" "+d));k+='" />';break;case "rect":for(m=0,s=a.length;m<s;m++)0===m%f&&(g=Math.floor(m/s*t)+this.styles.left,d=Math.floor(b/2*a[m]),k+=0>d?'<rect style="'+x+'" x="'+g+'" y="'+e+'" width="'+this.styles.width+'" height="'+-d+'" />':'<rect style="'+
x+'" x="'+g+'" y="'+e+'" width="'+this.styles.width+'" height="'+d+'" transform="translate('+this.styles.width+" 0) rotate(180 "+g+" "+e+')" />')}if("none"!==this.styles.grid||"none"!==this.styles.text){m=0;for(s=a.length;m<s;m++)0===m%l&&(g=Math.floor(m/s*t)+this.styles.left,f=Math.floor(m/this.SAMPLE_RATE)+" min","none"!==this.styles.grid&&(k+='<rect style="'+n+'" x="'+g+'" y="'+this.styles.top+'" width="1" height="'+b+'" />'),"none"!==this.styles.text&&(k+='<text text-anchor="middle" style="'+
r+'" x="'+g+'" y="'+h+'">'+f+"</text>"));h=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];m=0;for(s=h.length;m<s;m++)f=h[m],g=c,d=Math.floor((1-parseFloat(f.trim()))*(b/2))+this.styles.top,"none"!==this.styles.grid&&(k+='<rect style="'+n+'" x="'+this.styles.left+'" y="'+d+'" width="'+t+'" height="1" />'),d-=Math.floor(parseInt(q)/4),"none"!==this.styles.text&&(k+='<text text-anchor="end" style="'+r+'" x="'+g+'" y="'+d+'">'+f+"</text>")}k+='<rect class="svg-current-time" style="'+B+'" x="'+this.styles.left+
'" y="'+this.styles.top+'" width="1" height="'+b+'" />';k+="</svg>";this.savedImage=this.svgParent.innerHTML=k;this.length=a.length;return this};h.prototype.update=function(k){switch(this.drawType){case "canvas":if(this.canvas instanceof HTMLCanvasElement&&this.isActive)break;else return;case "svg":if(!(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return}k=parseFloat(k);if(!(isNaN(k)||0>k)){var a=0,c=0,h=0,t=0,h=0;switch(this.drawType){case "canvas":if(this.savedImage instanceof
ImageData){var b=this.context,a=this.canvas.width,c=this.canvas.height,h=a-(this.styles.left+this.styles.right),t=c-(this.styles.top+this.styles.bottom),h=Math.floor(k*this.SAMPLE_RATE/this.length*h)+this.styles.left;b.clearRect(0,0,a,c);b.putImageData(this.savedImage,0,0);b.fillStyle=this.currentTime;b.fillRect(h,this.styles.top,1,t)}break;case "svg":c=this.svgParent.getElementsByClassName("svg-current-time")[0],c instanceof SVGElement&&(a=this.svg.getAttribute("width"),this.svg.getAttribute("height"),
h=a-(this.styles.left+this.styles.right),h=Math.floor(k*this.SAMPLE_RATE/this.length*h),c.setAttribute("transform","translate("+h+" 0)"))}return this}};h.prototype.drag=function(k){var a=null,c=!0;switch(this.drawType){case "canvas":if(this.canvas instanceof HTMLCanvasElement&&this.isActive){a=this.canvas;c=!0;break}else return;case "svg":if(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive)a=this.svgParent,c=!1;else return}var h="",t="",b="";/iPhone|iPad|iPod|Android/.test(navigator.userAgent)?
(h="touchstart",t="touchmove",b="touchend"):(h="mousedown",t="mousemove",b="mouseup");var e=function(a){var c=0,h=0;switch(this.drawType){case "canvas":c=this.canvas.offsetLeft;h=this.canvas.width;break;case "svg":c=this.svgParent.offsetLeft,h=this.svg.getAttribute("width")}a-=c+this.styles.left;h-=this.styles.left+this.styles.right;0>a&&(a=0);a>h&&(a=h);h=a/h*this.length/this.SAMPLE_RATE;this.update(h);"[object Function]"===Object.prototype.toString.call(k)&&k(h)},g=function(k){if(k.pageX)return k.pageX;
if(k.touches[0])return k.touches[0].pageX},d=!1,f=this;a.addEventListener(h,function(k){null!==f.savedImage&&(e.call(f,g(k)),d=!0)},c);a.addEventListener(t,function(k){k.preventDefault();d&&f.savedImage instanceof ImageData&&e.call(f,g(k))},c);v.addEventListener(b,function(k){d=!1},!0);return this};h.prototype.toString=function(){return"[SoundModule Analyser TimeAll]"};c.prototype.param=function(k,a){if("[object Object]"===Object.prototype.toString.call(k))for(var c in k)this.param(c,k[c]);else{c=
String(k).replace(/-/g,"").toLowerCase();var h=t.prototype.param.call(this,c,a);if(void 0!==h)return h;switch(c){case "textinterval":if(void 0===a)return this.textinterval;c=parseFloat(a);0<c&&(this.textinterval=c)}}return this};c.prototype.drawToCanvas=function(k){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var a=this.context,c=this.canvas.width,h=this.canvas.height,t=c-(this.styles.left+this.styles.right),b=h-(this.styles.top+this.styles.bottom),e=Math.floor(b/2)+this.styles.top,
g=0,d=0,f="",m=Math.floor(this.textinterval*this.SAMPLE_RATE);a.clearRect(0,0,c,h);switch(this.styles.shape){case "line":a.strokeStyle=this.styles.wave;a.lineWidth=this.styles.width;a.lineCap=this.styles.cap;a.lineJoin=this.styles.join;a.beginPath();for(var p=0,l=k.length;p<l;p++)g=Math.floor(p/l*t)+this.styles.left,d=Math.floor((1-k[p]/255)*b)+this.styles.top,0===p?a.moveTo(g,d):a.lineTo(g,d);a.stroke();break;case "rect":for("gradient"!==this.styles.wave&&(a.fillStyle=this.styles.wave),p=0,l=k.length;p<
l;p++){g=Math.floor(p/l*t)+this.styles.left;d=Math.floor((.5-k[p]/255)*b);if("gradient"===this.styles.wave){for(var f=b/2+this.styles.top,f=a.createLinearGradient(0,f,0,f+d),s=0,n=this.styles.grad.length;s<n;s++){var q=this.styles.grad[s];f.addColorStop(q.offset,q.color)}a.fillStyle=f}a.fillRect(g,e,this.styles.width,d)}}if("none"!==this.styles.grid||"none"!==this.styles.text){p=0;for(l=k.length;p<l;p++)0===p%m&&(g=Math.floor(p/l*t)+this.styles.left,f=Math.floor(p/this.SAMPLE_RATE*1E3)+" ms","none"!==
this.styles.grid&&(a.fillStyle=this.styles.grid,a.fillRect(g,this.styles.top,1,b)),"none"!==this.styles.text&&(a.fillStyle=this.styles.text,a.font=this.styles.font,a.fillText(f,g-a.measureText(f).width/2,h)));k=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];p=0;for(l=k.length;p<l;p++)f=k[p],g=Math.floor(c-a.measureText(f).width),d=Math.floor((1-parseFloat(f.trim()))*(b/2))+this.styles.top,"none"!==this.styles.grid&&(a.fillStyle=this.styles.grid,a.fillRect(this.styles.left,d,t,1)),d-=parseInt(a.font.match(/\s*(\d+)px.*/)[1]/
4),"none"!==this.styles.text&&(a.fillStyle=this.styles.text,a.font=this.styles.font,a.fillText(f,g,d))}return this};c.prototype.drawToSVG=function(a){if(!(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return this;var k=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>",c=this.svg.getAttribute("width"),h=this.svg.getAttribute("height"),t=c-(this.styles.left+this.styles.right),b=h-(this.styles.top+this.styles.bottom),e=Math.floor(b/2)+this.styles.top,
g=0,d=0,f="",p=Math.floor(this.textinterval*this.SAMPLE_RATE),f="";switch(this.styles.shape){case "line":f+="stroke : "+this.styles.wave+"; ";f=f+"fill : none; "+("stroke-width : "+this.styles.width+"; ");f+="stroke-linecap : "+this.styles.cap+"; ";f+="stroke-linejoin : "+this.styles.join+";";break;case "rect":if("gradient"===this.styles.wave){var m;m='<defs><linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var l=0,s=this.styles.grad.length;l<s;l++){var n=this.styles.grad[l];
m+='<stop offset="'+n.offset+'" stop-color="'+n.color+'" />'}m+="</linearGradient>";m+="</defs>";f+="stroke : none; ";f+="fill : url(#svg-linear-gradient); "}else f+="stroke : none; ",f+="fill : "+this.styles.wave+"; ";f+="stroke-width : 0;"}var n="stroke : none; "+("fill : "+this.styles.grid+"; "),n=n+"stroke-width : 0;",s=this.styles.font.match(/\s*(\d+)px (.*)/),l=s[2],q=s[1],r;r="stroke : none; "+("fill : "+this.styles.text+"; ");r+="font-family : "+l+"; ";r+="font-size : "+q+";";this.svgParent.innerHTML=
k;k=this.svgParent.innerHTML.replace("</svg>","");"gradient"===this.styles.wave&&(k+=m);switch(this.styles.shape){case "line":k+='<path style="'+f+'" d="';l=0;for(s=a.length;l<s;l++)g=Math.floor(l/s*t)+this.styles.left,d=Math.floor((1-a[l]/255)*b)+this.styles.top,0===l?k+="M"+g+" "+d:(k+=" ",k+="L"+g+" "+d);k+='" />';break;case "rect":for(l=0,s=a.length;l<s;l++)g=Math.floor(l/s*t)+this.styles.left,d=Math.floor((a[l]/255-.5)*b),k+=0>d?'<rect style="'+f+'" x="'+g+'" y="'+e+'" width="'+this.styles.width+
'" height="'+-d+'" />':'<rect style="'+f+'" x="'+g+'" y="'+e+'" width="'+this.styles.width+'" height="'+d+'" transform="translate('+this.styles.width+" 0) rotate(180 "+g+" "+e+')" />'}if("none"!==this.styles.grid||"none"!==this.styles.text){l=0;for(s=a.length;l<s;l++)0===l%p&&(g=Math.floor(l/s*t)+this.styles.left,f=Math.floor(l/this.SAMPLE_RATE*1E3)+" ms","none"!==this.styles.grid&&(k+='<rect style="'+n+'" x="'+g+'" y="'+this.styles.top+'" width="1" height="'+b+'" />'),"none"!==this.styles.text&&
(k+='<text text-anchor="middle" style="'+r+'" x="'+g+'" y="'+h+'">'+f+"</text>"));a=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];l=0;for(s=a.length;l<s;l++)f=a[l],g=c,d=Math.floor((1-parseFloat(f.trim()))*(b/2))+this.styles.top,"none"!==this.styles.grid&&(k+='<rect style="'+n+'" x="'+this.styles.left+'" y="'+d+'" width="'+t+'" height="1" />'),d-=Math.floor(parseInt(q)/4),"none"!==this.styles.text&&(k+='<text text-anchor="end" style="'+r+'" x="'+g+'" y="'+d+'">'+f+"</text>")}this.svgParent.innerHTML=
k+"</svg>";return this};c.prototype.toString=function(){return"[SoundModule Analyser Time]"};b.prototype.param=function(k,a){if("[object Object]"===Object.prototype.toString.call(k))for(var c in k)this.param(c,k[c]);else{c=String(k).replace(/-/g,"").toLowerCase();var h=t.prototype.param.call(this,c,a);if(void 0!==h)return h;switch(c){case "type":if(void 0===a)return this.type;c=String(a).toLowerCase();if("uint"===c||"float"===c)this.type=c;break;case "size":if(void 0===a)return this.size;c=parseFloat(a);
0<=c&&1024>=c&&(this.size=c);break;case "textinterval":if(void 0===a)return this.textinterval;c=parseFloat(a);0<c&&(this.textinterval=c)}}return this};b.prototype.drawToCanvas=function(k,a,c){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var h=parseFloat(a),t=parseFloat(c),b=t-h;c=this.context;a=this.canvas.width;var e=this.canvas.height,f=a-(this.styles.left+this.styles.right),g=e-(this.styles.top+this.styles.bottom),d=0,l=0,p="",m=this.size>k.length?k.length:this.size,
s=Math.floor(this.textinterval/(this.SAMPLE_RATE/(2*k.length)));c.clearRect(0,0,a,e);switch(this.type){case "float":c.strokeStyle="gradient"!==this.styles.wave?this.styles.wave:"rgba(0, 0, 255, 1.0)";c.lineWidth=this.styles.width;c.lineCap=this.styles.cap;c.lineJoin=this.styles.join;c.beginPath();for(var n=0;n<m;n++)d=Math.floor(n/m*f)+this.styles.left,l=Math.abs(k[n]-t)*(g/b)+this.styles.top,0===n?c.moveTo(d,l):c.lineTo(d,l);c.stroke();break;default:switch(this.styles.shape){case "line":c.strokeStyle=
this.styles.wave;c.lineWidth=this.styles.width;c.lineCap=this.styles.cap;c.lineJoin=this.styles.join;c.beginPath();for(n=0;n<m;n++)d=Math.floor(n/m*f)+this.styles.left,l=Math.floor((1-k[n]/255)*g)+this.styles.top,0===n?c.moveTo(d,l):c.lineTo(d,l);c.stroke();break;case "rect":for("gradient"!==this.styles.wave&&(c.fillStyle=this.styles.wave),n=0;n<m;n++){d=Math.floor(n/m*f)+this.styles.left;l=-1*Math.floor(k[n]/255*g);if("gradient"===this.styles.wave){for(var p=g+this.styles.top,p=c.createLinearGradient(0,
p,0,p+l),q=0,r=this.styles.grad.length;q<r;q++){var B=this.styles.grad[q];p.addColorStop(B.offset,B.color)}c.fillStyle=p}c.fillRect(d,g+this.styles.top,this.styles.width,l)}}}if("none"!==this.styles.grid||"none"!==this.styles.text){for(n=k=0;n<m;n++)0===n%s&&(d=Math.floor(n/m*f)+this.styles.left,k=Math.floor(n/s*this.textinterval),p=1E3>k?k+" Hz":String(k/1E3).slice(0,3)+" kHz","none"!==this.styles.grid&&(c.fillStyle=this.styles.grid,c.fillRect(d,this.styles.top,1,g)),"none"!==this.styles.text&&(c.fillStyle=
this.styles.text,c.font=this.styles.font,c.fillText(p,d-c.measureText(p).width/2,e)));switch(this.type){case "float":for(n=h;n<=t;n+=10)p=n+"dB",d=a-Math.floor(c.measureText(p).width),l=Math.floor(-1*(n-t)/b*g)+this.styles.top,"none"!==this.styles.grid&&(c.fillStyle=this.styles.grid,c.fillRect(this.styles.left,l,f,1)),l-=parseInt(c.font.match(/\s*(\d+)px.*/)[1]/4),"none"!==this.styles.text&&(c.fillStyle=this.styles.text,c.font=this.styles.font,c.fillText(p,d,l));break;default:for(k=["0.00","0.25",
"0.50","0.75","1.00"],n=0,h=k.length;n<h;n++)p=k[n],d=a-Math.floor(c.measureText(p).width),l=(1-parseFloat(p))*g+this.styles.top,"none"!==this.styles.grid&&(c.fillStyle=this.styles.grid,c.fillRect(this.styles.left,l,f,1)),l-=parseInt(c.font.match(/\s*(\d+)px.*/)[1]/4),"none"!==this.styles.text&&(c.fillStyle=this.styles.text,c.font=this.styles.font,c.fillText(p,d,l))}}return this};b.prototype.drawToSVG=function(k,a,c){if(!(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return this;
a=parseFloat(a);var h=parseFloat(c),t=h-a;c=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>";var b=this.svg.getAttribute("width"),d=this.svg.getAttribute("height"),e=b-(this.styles.left+this.styles.right),g=d-(this.styles.top+this.styles.bottom),f=0,l=0,p="",m=this.size>k.length?k.length:this.size,n=Math.floor(this.textinterval/(this.SAMPLE_RATE/(2*k.length))),p="";switch(this.styles.shape){case "line":p+="stroke : "+this.styles.wave+"; ";p=p+"fill : none; "+("stroke-width : "+
this.styles.width+"; ");p+="stroke-linecap : "+this.styles.cap+"; ";p+="stroke-linejoin : "+this.styles.join+";";break;case "rect":if("uint"===this.type&&"gradient"===this.styles.wave){var s;s='<defs><linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var q=0,r=this.styles.grad.length;q<r;q++){var B=this.styles.grad[q];s+='<stop offset="'+B.offset+'" stop-color="'+B.color+'" />'}s+="</linearGradient>";s+="</defs>";p+="stroke : none; ";p+="fill : url(#svg-linear-gradient); ";
p+="stroke-width : 0;"}else"uint"===this.type&&"gradient"!==this.styles.wave?(p+="stroke : none; ",p+="fill : "+this.styles.wave+"; ",p+="stroke-width : 0;"):"uint"!==this.type&&(p+="stroke : rgba(0, 0, 255, 1.0); ",p+="fill : none; ",p+="stroke-width : "+this.styles.width+"; ",p+="stroke-linecap : "+this.styles.cap+"; ",p+="stroke-linejoin : "+this.styles.join+";")}var B="stroke : none; "+("fill : "+this.styles.grid+"; "),B=B+"stroke-width : 0;",z=this.styles.font.match(/\s*(\d+)px (.*)/),q=z[2],
z=z[1],D;D="stroke : none; "+("fill : "+this.styles.text+"; ");D+="font-family : "+q+"; ";D+="font-size : "+z+";";this.svgParent.innerHTML=c;c=this.svgParent.innerHTML.replace("</svg>","");"uint"===this.type&&"gradient"===this.styles.wave&&(c+=s);switch(this.type){case "float":c+='<path style="'+p+'" d="';for(q=0;q<m;q++)f=Math.floor(q/m*e)+this.styles.left,l=Math.floor(g/t*(k[q]-h)*-1)+this.styles.top,0===q?c+="M"+f+" "+l:(c+=" ",c+="L"+f+" "+l);c+='" />';break;default:switch(this.styles.shape){case "line":c+=
'<path style="'+p+'" d="';for(q=0;q<m;q++)f=Math.floor(q/m*e)+this.styles.left,l=Math.floor((1-k[q]/255)*g)+this.styles.top,0===q?c+="M"+f+" "+l:(c+=" ",c+="L"+f+" "+l);c+='" />';break;case "rect":for(q=0;q<m;q++)f=Math.floor(q/m*e)+this.styles.left,l=Math.floor(k[q]/255*g),c+='<rect style="'+p+'" x="'+f+'" y="'+(this.styles.top+g)+'" width="'+this.styles.width+'" height="'+l+'" transform="translate('+this.styles.width+" 0) rotate(180 "+f+" "+(this.styles.top+g)+')" />'}}if("none"!==this.styles.grid||
"none"!==this.styles.text){for(q=k=0;q<m;q++)0===q%n&&(f=Math.floor(q/m*e)+this.styles.left,k=Math.floor(q/n*this.textinterval),p=1E3>k?k+" Hz":String(k/1E3).slice(0,3)+" kHz","none"!==this.styles.grid&&(c+='<rect style="'+B+'" x="'+f+'" y="'+this.styles.top+'" width="1" height="'+g+'" />'),"none"!==this.styles.text&&(c+='<text text-anchor="middle" style="'+D+'" x="'+f+'" y="'+d+'">'+p+"</text>"));switch(this.type){case "float":for(q=a;q<=h;q+=10)p=q+"dB",f=b,l=Math.floor(-1*(q-h)/t*g)+this.styles.top,
"none"!==this.styles.grid&&(c+='<rect style="'+B+'" x="'+this.styles.left+'" y="'+l+'" width="'+e+'" height="1" />'),l-=Math.floor(parseInt(z)/4),"none"!==this.styles.text&&(c+='<text text-anchor="end" style="'+D+'" x="'+f+'" y="'+l+'">'+p+"</text>");break;default:for(k=["0.00","0.25","0.50","0.75","1.00"],q=0,r=k.length;q<r;q++)p=k[q],f=b,l=(1-parseFloat(p))*g+this.styles.top,"none"!==this.styles.grid&&(c+='<rect style="'+B+'" x="'+this.styles.left+'" y="'+l+'" width="'+e+'" height="1" />'),l-=Math.floor(parseInt(z)/
4),"none"!==this.styles.text&&(c+='<text text-anchor="end" style="'+D+'" x="'+f+'" y="'+l+'">'+p+"</text>")}}this.svgParent.innerHTML=c+"</svg>";return this};b.prototype.toString=function(){return"[SoundModule Analyser FFT]"}}function d(k,a,h,c){this.SAMPLE_RATE=k.sampleRate;this.context=k;this.processor=k.createScriptProcessor(a,h,c);this.mixLs=[];this.mixRs=[];this.trackLs=[];this.trackRs=[];this.numtrack=0;this.activeTrack=-1;this.paused=!0;this.gainR=this.gainL=1}function l(k,a,h,c,b){this.isActive=
!1;this.context=k;this.analyser=b;this.sender=k.createScriptProcessor(a,h,c);this.receiver=k.createScriptProcessor(a,h,c);this.websocket=null;this.paused=!0}function f(k,a){this.isActive=!0;this.context=k;this.input=k.createGain();this.output=k.createGain();this.lfo=k.createOscillator();this.depth=k.createGain();this.rate=this.lfo.frequency;this.processor=k.createScriptProcessor(a,1,2);this.lfo.start=this.lfo.start||this.lfo.noteOn;this.lfo.stop=this.lfo.stop||this.lfo.noteOff;this.values={};this.isStop=
!0}function m(k,a){f.call(this,k,a);this.compressor=k.createDynamicsCompressor();this.compressor.threshold.value=-24;this.compressor.knee.value=30;this.compressor.ratio.value=12;this.compressor.attack.value=.003;this.compressor.release.value=.25;this.connect()}function s(k,a){f.call(this,k,a);this.distortion=k.createWaveShaper();this.drive=k.createGain();this.color=k.createBiquadFilter();this.tone=k.createBiquadFilter();this.color.BANDPASS=this.color.BANDPASS||2;this.tone.LOWPASS=this.tone.LOWPASS||
0;this.type="clean";this.numberOfSamples=4096;this.drive.gain.value=1;this.color.type="[object String]"===Object.prototype.toString.call(this.color.type)?"bandpass":this.color.BANDPASS;this.color.frequency.value=350;this.color.Q.value=Math.SQRT1_2;this.color.gain.value=0;this.tone.type="[object String]"===Object.prototype.toString.call(this.tone.type)?"lowpass":this.tone.LOWPASS;this.tone.frequency.value=350;this.tone.Q.value=Math.SQRT1_2;this.tone.gain.value=0;this.connect()}function n(k,a){f.call(this,
k,a);this.lowpass=k.createBiquadFilter();this.lowpass.LOWPASS=this.lowpass.LOWPASS||0;this.lowpass.type="[object String]"===Object.prototype.toString.call(this.lowpass.type)?"lowpass":this.lowpass.LOWPASS;this.lowpass.frequency.value=350;this.lowpass.gain.value=0;this.lowpass.Q.value=1;this.depth.gain.value=0;this.depthRate=this.rate.value=0;this.connect();this.lfo.connect(this.depth);this.depth.connect(this.lowpass.frequency)}function q(k,a){f.call(this,k,a);this.bass=k.createBiquadFilter();this.middle=
k.createBiquadFilter();this.treble=k.createBiquadFilter();this.presence=k.createBiquadFilter();this.bass.LOWSHELF=this.bass.LOWSHELF||3;this.middle.PEAKING=this.middle.PEAKING||5;this.treble.HIGHSHELF=this.treble.HIGHSHELF||4;this.presence.HIGHSHELF=this.presence.HIGHSHELF||4;this.bass.type="[object String]"===Object.prototype.toString.call(this.bass.type)?"lowshelf":this.bass.LOWSHELF;this.middle.type="[object String]"===Object.prototype.toString.call(this.middle.type)?"peaking":this.middle.PEAKING;
this.treble.type="[object String]"===Object.prototype.toString.call(this.treble.type)?"highshelf":this.treble.HIGHSHELF;this.presence.type="[object String]"===Object.prototype.toString.call(this.presence.type)?"highshelf":this.presence.HIGHSHELF;this.bass.frequency.value=500;this.middle.frequency.value=1E3;this.treble.frequency.value=2E3;this.presence.frequency.value=4E3;this.middle.Q.value=Math.SQRT1_2;this.bass.gain.value=0;this.middle.gain.value=0;this.treble.gain.value=0;this.presence.gain.value=
0;this.connect()}function B(k,a){f.call(this,k,a);this.filter=k.createBiquadFilter();this.filter.LOWPASS=this.filter.LOWPASS||0;this.filter.HIGHPASS=this.filter.HIGHPASS||1;this.filter.BANDPASS=this.filter.BANDPASS||2;this.filter.LOWSHELF=this.filter.LOWSHELF||3;this.filter.HIGHSHELF=this.filter.HIGHSHELF||4;this.filter.PEAKING=this.filter.PEAKING||5;this.filter.NOTCH=this.filter.NOTCH||6;this.filter.ALLPASS=this.filter.ALLPASS||7;this.filter.frequency.setTargetAtTime=this.filter.frequency.setTargetAtTime||
this.filter.frequency.setTargetValueAtTime;this.filter.type="[object String]"===Object.prototype.toString.call(this.filter.type)?"lowpass":this.filter.LOWPASS;this.filter.frequency.value=350;this.filter.Q.value=1;this.filter.gain.value=0;this.maxFrequency=this.filter.frequency.value;this.attack=.01;this.decay=.3;this.release=this.sustain=1;this.connect()}function D(k,a){f.call(this,k,a);this.amplitudeL=k.createGain();this.amplitudeR=k.createGain();this.splitter=k.createChannelSplitter(2);this.merger=
k.createChannelMerger(2);this.amplitudeL.gain.value=1;this.amplitudeR.gain.value=1;this.depth.gain.value=0;this.rate.value=0;this.connect();this.lfoSplitter=k.createChannelSplitter(2);this.lfo.connect(this.depth);this.depth.connect(this.processor);this.processor.connect(this.lfoSplitter);this.lfoSplitter.connect(this.amplitudeL.gain,0);this.lfoSplitter.connect(this.amplitudeR.gain,1)}function E(k,a){f.call(this,k,a);this.amplitude=k.createGain();this.amplitude.gain.value=1;this.depth.gain.value=0;
this.rate.value=0;this.connect();this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain)}function z(k,a){f.call(this,k,a);this.amplitude=k.createGain();this.amplitude.gain.value=0;this.depth.gain.value=1;this.rate.value=0;this.connect();this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain)}function r(k,a){f.call(this,k,a);this.MAXIMUM_STAGES=24;this.numberOfStages=12;this.filters=Array(this.MAXIMUM_STAGES);for(var h=0;h<this.MAXIMUM_STAGES;h++)this.filters[h]=k.createBiquadFilter(),
this.filters[h].ALLPASS=this.filters[h].ALLPASS||7,this.filters[h].type="[object String]"===Object.prototype.toString.call(this.filters[h].type)?"allpass":this.filters[h].ALLPASS,this.filters[h].frequency.value=350,this.filters[h].Q.value=1,this.filters[h].gain.value=0;this.mix=k.createGain();this.feedback=k.createGain();this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0;this.depthRate=this.feedback.gain.value=0;this.connect();this.lfo.connect(this.depth);for(h=0;h<this.MAXIMUM_STAGES;h++)this.depth.connect(this.filters[h].frequency)}
function w(k,a){f.call(this,k,a);this.delay=k.createDelay();this.mix=k.createGain();this.tone=k.createBiquadFilter();this.feedback=k.createGain();this.tone.LOWPASS=this.tone.LOWPASS||0;this.delay.delayTime.value=0;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0;this.tone.type="[object String]"===Object.prototype.toString.call(this.tone.type)?"lowpass":this.tone.LOWPASS;this.tone.frequency.value=350;this.tone.Q.value=Math.SQRT1_2;this.tone.gain.value=0;this.depthRate=this.feedback.gain.value=
0;this.connect();this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime)}function y(k,a){f.call(this,k,a);this.delay=k.createDelay();this.mix=k.createGain();this.tone=k.createBiquadFilter();this.feedback=k.createGain();this.tone.LOWPASS=this.tone.LOWPASS||0;this.delay.delayTime.value=0;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0;this.tone.type="[object String]"===Object.prototype.toString.call(this.tone.type)?"lowpass":this.tone.LOWPASS;this.tone.frequency.value=
350;this.tone.Q.value=Math.SQRT1_2;this.tone.gain.value=0;this.depthRate=this.feedback.gain.value=0;this.connect();this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime)}function J(k,a){f.call(this,k,a);this.MAX_DELAY_TIME=5;this.delay=k.createDelay(this.MAX_DELAY_TIME);this.dry=k.createGain();this.wet=k.createGain();this.tone=k.createBiquadFilter();this.feedback=k.createGain();this.tone.LOWPASS=this.tone.LOWPASS||0;this.delay.delayTime.value=0;this.dry.gain.value=1;this.wet.gain.value=
0;this.tone.type="[object String]"===Object.prototype.toString.call(this.tone.type)?"lowpass":this.tone.LOWPASS;this.tone.frequency.value=350;this.tone.Q.value=Math.SQRT1_2;this.tone.gain.value=0;this.feedback.gain.value=0;this.connect()}function u(a,b){f.call(this,a,b);this.rirs=[];this.convolver=a.createConvolver();this.dry=a.createGain();this.wet=a.createGain();this.tone=a.createBiquadFilter();this.tone.LOWPASS=this.tone.LOWPASS||0;this.decodeAudioData=function(h,c,b){a.decodeAudioData(h,c,b)};
this.dry.gain.value=1;this.wet.gain.value=0;this.tone.type="[object String]"===Object.prototype.toString.call(this.tone.type)?"lowpass":this.tone.LOWPASS;this.tone.frequency.value=350;this.tone.Q.value=Math.SQRT1_2;this.tone.gain.value=0;this.connect()}function C(a,b){f.call(this,a,b);this.panner=a.createPanner();this.panner.EQUALPOWER=this.panner.EQUALPOWER||0;this.panner.HRTF=this.panner.HRTF||1;this.panner.LINEAR_DISTANCE=this.panner.LINEAR_DISTANCE||0;this.panner.INVERSE_DISTANCE=this.panner.INVERSE_DISTANCE||
1;this.panner.EXPONENTIAL_DISTANCE=this.panner.EXPONENTIAL_DISTANCE||2;this.positions={x:0,y:0,z:0};this.orientations={x:1,y:0,z:0};this.velocities={x:0,y:0,z:0};this.panner.refDistance=1;this.panner.maxDistance=1E4;this.panner.rolloffFactor=1;this.panner.coneInnerAngle=360;this.panner.coneOuterAngle=360;this.panner.coneOuterGain=0;this.panner.panningModel="[object String]"===Object.prototype.toString.call(this.panner.panningModel)?"HRTF":1;this.panner.distanceModel="[object String]"===Object.prototype.toString.call(this.panner.distanceModel)?
"inverse":1;this.panner.setPosition(this.positions.x,this.positions.y,this.positions.z);this.panner.setOrientation(this.orientations.x,this.orientations.y,this.orientations.z);this.panner.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z);this.connect()}function A(a){this.context=a;this.generators=[];this.activeIndexes=[];this.activeCounter=0;this.attack=.01;this.decay=.3;this.sustain=.5;this.release=1}this.context=a;this.SAMPLE_RATE=a.sampleRate;this.NUM_OUTPUT=this.NUM_INPUT=2;if(void 0!==
e)switch(parseInt(e)){case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:this.BUFFER_SIZE=parseInt(e);break;default:return}else/(Win(dows )?NT 6\.2)/.test(navigator.userAgent)?this.BUFFER_SIZE=1024:/(Win(dows )?NT 6\.1)/.test(navigator.userAgent)?this.BUFFER_SIZE=1024:/(Win(dows )?NT 6\.0)/.test(navigator.userAgent)?this.BUFFER_SIZE=2048:/Win(dows )?(NT 5\.1|XP)/.test(navigator.userAgent)?this.BUFFER_SIZE=4096:/Mac|PPC/.test(navigator.userAgent)?this.BUFFER_SIZE=1024:/Linux/.test(navigator.userAgent)?
this.BUFFER_SIZE=8192:/iPhone|iPad|iPod/.test(navigator.userAgent)?this.BUFFER_SIZE=2048:this.BUFFER_SIZE=16384;this.masterVolume=a.createGain();this.processor=a.createScriptProcessor(this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT);l.prototype=Object.create(K.prototype);f.prototype=Object.create(K.prototype);l.prototype.constructor=l;f.prototype.constructor=f;m.prototype=Object.create(f.prototype);s.prototype=Object.create(f.prototype);n.prototype=Object.create(f.prototype);q.prototype=Object.create(f.prototype);
B.prototype=Object.create(f.prototype);E.prototype=Object.create(f.prototype);z.prototype=Object.create(f.prototype);D.prototype=Object.create(f.prototype);r.prototype=Object.create(f.prototype);w.prototype=Object.create(f.prototype);y.prototype=Object.create(f.prototype);J.prototype=Object.create(f.prototype);u.prototype=Object.create(f.prototype);C.prototype=Object.create(f.prototype);m.prototype.constructor=m;s.prototype.constructor=s;n.prototype.constructor=n;q.prototype.constructor=q;B.prototype.constructor=
B;E.prototype.constructor=E;z.prototype.constructor=z;D.prototype.constructor=D;r.prototype.constructor=r;w.prototype.constructor=w;y.prototype.constructor=y;J.prototype.constructor=J;u.prototype.constructor=u;C.prototype.constructor=C;this.Effector=f;this.plugins=[];b.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "dopplerfactor":if(void 0===b)return this.listener.dopplerFactor;
var c=parseFloat(b);0<=c&&(this.listener.dopplerFactor=c);break;case "speedofsound":if(void 0===b)return this.listener.speedOfSound;c=parseFloat(b);0<=c&&(this.listener.speedOfSound=c);break;case "x":case "y":case "z":if(void 0===b)return this.positions[h];c=parseFloat(b);isNaN(c)||(this.positions[h]=c,this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case "fx":case "fy":case "fz":if(void 0===b)return this.fronts[h.charAt(1)];c=parseFloat(b);isNaN(c)||(this.fronts[h.charAt(1)]=
c,this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z));break;case "ux":case "uy":case "uz":if(void 0===b)return this.ups[h.charAt(1)];c=parseFloat(b);isNaN(c)||(this.ups[h.charAt(1)]=c,this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z));break;case "vx":case "vy":case "vz":if(void 0===b)return this.velocities[h.charAt(1)];c=parseFloat(b);isNaN(c)||(this.velocities[h.charAt(1)]=c,this.listener.setVelocity(this.velocities.x,
this.velocities.y,this.velocities.z))}return this};b.prototype.toString=function(){return"[SoundModule Listener]"};g.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "fftsize":if(void 0===b)return this.analyser.fftSize;var c=parseInt(b);switch(c){case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:this.analyser.fftSize=c}break;case "frequencybincount":return this.analyser.frequencyBinCount;
case "mindecibels":case "maxdecibels":if(void 0===b)return this.analyser[h.replace("decibels","Decibels")];c=parseFloat(b);isNaN(c)||(this.analyser[h.replace("decibels","Decibels")]=c,this.analyser.minDecibels>=this.analyser.maxDecibels&&(this.analyser.minDecibels=-100,this.analyser.maxDecibels=-30));break;case "smoothingtimeconstant":if(void 0===b)return this.analyser.smoothingTimeConstant;c=parseFloat(b);0<=c&&1>=c&&(this.analyser.smoothingTimeConstant=c)}return this};g.prototype.start=function(a,
b){var h=this;switch(String(a).replace(/-/g,"").toLowerCase()){case "timealll":if(b instanceof AudioBuffer&&0<b.numberOfChannels){var c=new Float32Array(b.length);c.set(b.getChannelData(0));this.timeAllL.start(c)}break;case "timeallr":b instanceof AudioBuffer&&1<b.numberOfChannels&&(c=new Float32Array(b.length),c.set(b.getChannelData(1)),this.timeAllR.start(c));break;case "time":c=new Uint8Array(this.analyser.fftSize);this.analyser.getByteTimeDomainData(c);this.time.start(c);this.time.timerid="auto"===
this.time.interval?requestAnimationFrame(function(){h.start(a)}):v.setTimeout(function(){h.start(a)},this.time.interval);break;case "fft":"uint"===this.fft.type?(c=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.getByteFrequencyData(c),this.fft.start(c)):(c=new Float32Array(this.analyser.frequencyBinCount),this.analyser.getFloatFrequencyData(c),this.fft.start(c,this.analyser.minDecibels,this.analyser.maxDecibels)),this.fft.timerid="auto"===this.fft.interval?requestAnimationFrame(function(){h.start(a)}):
v.setTimeout(function(){h.start(a)},this.fft.interval)}return this};g.prototype.stop=function(a){switch(String(a).replace(/-/g,"").toLowerCase()){case "time":"auto"===this.time.interval?v.cancelAnimationFrame(this.time.timerid):v.clearTimeout(this.time.timerid);this.time.timerid=null;break;case "fft":"auto"===this.fft.interval?v.cancelAnimationFrame(this.fft.timerid):v.clearTimeout(this.fft.timerid),this.fft.timerid=null}return this};g.prototype.domain=function(a){a=String(a).replace(/-/g,"").toLowerCase();
switch(a){case "timealll":case "timeallr":return this["timeAll"+a.slice(-1).toUpperCase()];case "time":case "fft":return this[a]}};g.prototype.toString=function(){return"[SoundModule Analyser]"};d.prototype.setup=function(a){a=parseInt(a);if(0<a){this.numTrack=a;this.trackLs=Array(this.numTrack);this.trackRs=Array(this.numTrack);for(var b=0;b<a;b++)this.trackLs[b]=[];for(b=0;b<a;b++)this.trackRs[b]=[]}else this.numTrack=1,this.trackLs=Array(this.numTrack),this.trackRs=Array(this.numTrack),this.trackLs[0]=
[],this.trackRs[0]=[];return this};d.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "gainl":case "gainr":if(void 0===b)return this["gain"+h.slice(-1).toUpperCase()];var c=parseFloat(b);0<=c&&1>=c&&(this["gain"+h.slice(-1).toUpperCase()]=c)}return this};d.prototype.ready=function(a){this.isTrack(a)&&(this.activeTrack=a);return this};d.prototype.start=function(){if(-1!==
this.activeTrack&&this.paused){var a=this;this.paused=!1;this.processor.onaudioprocess=function(b){if(-1!==a.activeTrack){var h=b.inputBuffer.getChannelData(0);b=b.inputBuffer.getChannelData(1);for(var c=0;c<this.bufferSize;c++)a.trackLs[a.activeTrack].push(a.gainL*h[c]),a.trackRs[a.activeTrack].push(a.gainR*b[c])}else this.disconnect(0),this.onaudioprocess=null}}return this};d.prototype.stop=function(){this.activeTrack=-1;this.paused=!0;this.processor.disconnect(0);this.processor.onaudioprocess=
null;return this};d.prototype.isTrack=function(a){a=parseInt(a);return 0<=a&&a<this.numTrack?!0:!1};d.prototype.getActiveTrack=function(){return this.activeTrack};d.prototype.mix=function(){-1!==this.activeTrack&&this.stop();var a=function(a){for(var k="L"===a?this.trackLs:this.trackRs,c=[],b=0,f=0,e=0;;){for(var g=0,d=k.length;g<d;g++)void 0!==k[g][e]&&(b+=k[g][e],f++);if(0<f)c[e]=b/f,f=b=0,e++;else{"L"===a&&(this.mixLs=c.slice(0,c.length));"R"===a&&(this.mixRs=c.slice(0,c.length));break}}};a.call(this,
"L");a.call(this,"R");return this};d.prototype.clear=function(a){-1!==this.activeTrack&&this.stop();if("all"===String(a).toLowerCase()){a=0;for(var b=this.trackLs.length;a<b;a++)this.trackLs[a].length=0;a=0;for(b=this.trackRs.length;a<b;a++)this.trackRs[a].length=0}else this.isTrack(a)&&(this.trackLs[a].length=0,this.trackRs[a].length=0);return this};d.prototype.create=function(a,b,h,c){-1!==this.activeTrack&&this.stop();var f=[],e=[];"all"===String(a).toLowerCase()?(this.mix(),f=this.mixLs,e=this.mixRs):
this.isTrack(a)&&(f=this.trackLs[a-1],e=this.trackRs[a-1]);if(0!==f.length||0!==e.length){a=1===b?1:2;b=8===h?8:16;h=[];var g=Math.min(f.length,e.length);switch(b){case 8:for(var d=0;d<g;d++){var l=0,l=0===d%a?(f[d]+1)/2*(Math.pow(2,8)-1):(e[d-1]+1)/2*(Math.pow(2,8)-1);l>Math.pow(2,8)-1&&(l=Math.pow(2,8)-1);l<Math.pow(2,0)-1&&(l=Math.pow(2,0)-1);h.push(Math.floor(l))}break;case 16:for(d=0;d<g;d++)l=0===d%a?Math.floor(f[d]*Math.pow(2,15)):Math.floor(e[d-1]*Math.pow(2,15)),l>Math.pow(2,15)-1&&(l=Math.pow(2,
15)-1),l<-Math.pow(2,15)-1&&(l=-Math.pow(2,15)-1),0>l&&(l+=Math.pow(2,16)),h.push(l)}l=36+b/8*a*g;f=8+(28+(8+b/8*a*g));d=.5*this.SAMPLE_RATE;e=b/8*this.SAMPLE_RATE*a*.5;g*=b/8*a;switch(String(c).toLowerCase()){case "base64":c="RIFF"+String.fromCharCode(l>>0&255,l>>8&255,l>>16&255,l>>24&255);c+="WAVE";c+="fmt "+String.fromCharCode(16,0,0,0);c+=String.fromCharCode(1,0);c+=String.fromCharCode(a,0);c+=String.fromCharCode(d>>0&255,d>>8&255,d>>16&255,d>>24&255);c+=String.fromCharCode(e>>0&255,e>>8&255,
e>>16&255,e>>24&255);c+=String.fromCharCode(b/8*a,0);c+=String.fromCharCode(b,0);c+="data";c+=String.fromCharCode(g>>0&255,g>>8&255,g>>16&255,g>>24&255);d=0;for(a=h.length;d<a;d++)c+=String.fromCharCode(h[d]>>0&255,h[d]>>8&255);return"data:audio/wav;base64,"+v.btoa(c);default:c=[82,73,70,70];c[4]=l>>0&255;c[5]=l>>8&255;c[6]=l>>16&255;c[7]=l>>24&255;c[8]=87;c[9]=65;c[10]=86;c[11]=69;c[12]=102;c[13]=109;c[14]=116;c[15]=32;c[16]=16;c[17]=0;c[18]=0;c[19]=0;c[20]=1;c[21]=0;c[22]=a;c[23]=0;c[24]=d>>0&255;
c[25]=d>>8&255;c[26]=d>>16&255;c[27]=d>>24&255;c[28]=e>>0&255;c[29]=e>>8&255;c[30]=e>>16&255;c[31]=e>>24&255;c[32]=b/8*a;c[33]=0;c[34]=b;c[35]=0;c[36]=100;c[37]=97;c[38]=116;c[39]=97;c[40]=g>>0&255;c[41]=g>>8&255;c[42]=g>>16&255;c[43]=g>>24&255;d=0;for(a=h.length;d<a;d++)c[f-g+2*d]=h[d]>>0&255,c[f-g+2*d+1]=h[d]>>8&255;v.URL=v.URL||v.webkitURL;c=new Blob([new Uint8Array(c)],{type:"audio/wav"});return v.URL.createObjectURL(c)}}};d.prototype.toString=function(){return"[SoundModule Recorder]"};l.prototype.setup=
function(a,b,h,c,d,e,g){if(!navigator.onLine)throw this.isActive=!1,this.paused=!0,this.connect(),this.websocket=null,Error("Now Offline !!");if("[object Object]"===Object.prototype.toString.call(a)){var f=a;"tls"in f&&(a=f.tls);"host"in f&&(b=f.host);"port"in f&&(h=f.port);"path"in f&&(c=f.path);"open"in f&&(d=f.open);"close"in f&&(e=f.close);"error"in f&&(g=f.error)}a=a?"wss://":"ws://";"/"!==c.charAt(0)&&(c="/"+c);h=parseInt(h);if(!(isNaN(h)||0>h||65535<h)){this.websocket=new WebSocket(a+b+":"+
h+c);this.websocket.binaryType="arraybuffer";var l=this;this.websocket.onopen=function(a){"[object Function]"===Object.prototype.toString.call(d)&&d(a,l.websocket)};this.websocket.onclose=function(a){l.isActive=!1;l.paused=!0;l.connect();"[object Function]"===Object.prototype.toString.call(e)&&e(a,l.websocket)};this.websocket.onerror=function(a){l.isActive=!1;l.paused=!0;l.connect();"[object Function]"===Object.prototype.toString.call(g)&&g(a,l.websocket)};this.websocket.onmessage=function(a){if(!l.isActive)l.analyser.stop("time"),
l.analyser.stop("fft");else if(a.data instanceof ArrayBuffer){var c=Math.floor(a.data.byteLength/Float32Array.BYTES_PER_ELEMENT/2),k=c*Float32Array.BYTES_PER_ELEMENT,b=new Float32Array(a.data,0,c),h=new Float32Array(a.data,k,c);l.analyser.start("time");l.analyser.start("fft");l.receiver.onaudioprocess=function(a){var c=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);b instanceof Float32Array&&c.set(b);h instanceof Float32Array&&a.set(h);h=b=null;l.isActive&&null!==l.websocket||
(l.analyser.stop("time"),l.analyser.stop("fft"))}}};return this}};l.prototype.connect=function(){this.receiver.disconnect(0);this.sender.disconnect(0);this.receiver.onaudioprocess=null;this.sender.onaudioprocess=null;this.isActive?(this.receiver.connect(this.analyser.input),this.analyser.output.connect(this.context.destination)):this.paused=!0;return this};l.prototype.start=function(){if(this.isActive&&this.isConnected()&&this.paused){this.paused=!1;var a=this;this.sender.onaudioprocess=function(b){if(a.isActive&&
a.isConnected()){var h=b.inputBuffer.getChannelData(0);b=b.inputBuffer.getChannelData(1);for(var c=new Float32Array(2*this.bufferSize),d=0;d<this.bufferSize;d++)c[d]=h[d],c[c.length/2+d]=b[d];0===a.websocket.bufferedAmount&&a.websocket.send(c)}}}return this};l.prototype.close=function(){this.websocket instanceof WebSocket&&(this.isActive=!1,this.paused=!0,this.connect(),this.websocket.close(),this.websocket=null);return this};l.prototype.isConnected=function(){return this.websocket instanceof WebSocket&&
this.websocket.readyState===WebSocket.OPEN?!0:!1};l.prototype.state=function(a,b,h){if(void 0===a)return this.isActive;"[object Function]"===Object.prototype.toString.call(h)&&h();var c=this,d=v.setInterval(function(){c.websocket instanceof WebSocket&&0!==c.websocket.bufferedAmount||("toggle"===String(a).toLowerCase()?c.isActive=!c.isActive:c.isActive=Boolean(a),c.connect(),"[object Function]"===Object.prototype.toString.call(b)&&b(),v.clearInterval(d))},10);return this};l.prototype.toString=function(){return"[SoundModule Session]"};
f.prototype.param=function(a,b){};f.prototype.connect=function(){};f.prototype.start=function(a){if(this.isActive&&this.isStop){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;this.lfo.start(a);this.isStop=!1}return this};f.prototype.stop=function(a,b){if(this.isActive&&!this.isStop){var h=parseFloat(a),c=parseFloat(b);if(isNaN(h)||h<this.context.currentTime)h=this.context.currentTime;if(isNaN(c)||0>c)c=0;var d=this.lfo.type,f=this.lfo.frequency.value;this.lfo.stop(h+
c);this.lfo=this.context.createOscillator();this.lfo.start=this.lfo.start||this.lfo.noteOn;this.lfo.stop=this.lfo.stop||this.lfo.noteOff;this.lfo.type=d;this.lfo.frequency.value=f;this.rate=this.lfo.frequency;this.isStop=!0}return this};f.prototype.state=function(a){if(void 0===a)return this.isActive;"toggle"===String(a).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(a);this.connect();this.start(this.context.currentTime);return this};f.prototype.toString=function(){return"[SoundModule Effector]"};
m.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else if(h=String(a).replace(/-/g,"").toLowerCase(),h in this.compressor){if(void 0===b)return this.compressor[h].value;var c=parseFloat(b),d={threshold:-100,knee:0,ratio:1,attack:0,release:0},f={threshold:0,knee:40,ratio:20,attack:1,release:1},f=this.compressor[h].maxValue||f[h];c>=(this.compressor[h].minValue||d[h])&&c<=f&&(this.compressor[h].value=c)}return this};m.prototype.connect=
function(){this.input.disconnect(0);this.compressor.disconnect(0);this.isActive?(this.input.connect(this.compressor),this.compressor.connect(this.output)):this.input.connect(this.output);return this};m.prototype.toString=function(){return"[SoundModule Compressor]"};s.createCurve=function(a,b){if(0<a&&1>a){for(var h=new Float32Array(b),c=2*a/(1-a),d=0;d<b;d++){var f=2*(d-0)/(b-0)+-1;h[d]=(1+c)*f/(1+c*Math.abs(f))}return h}return null};s.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,
a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "curve":if(void 0===b)return this.distortion.curve;h=null;switch(String(b).toLowerCase()){case "clean":this.type="clean";h=s.createCurve(0,this.numberOfSamples);break;case "crunch":this.type="crunch";h=s.createCurve(.5,this.numberOfSamples);break;case "overdrive":this.type="overdrive";h=s.createCurve(.7,this.numberOfSamples);break;case "distortion":this.type="distortion";h=s.createCurve(.8,this.numberOfSamples);break;case "fuzz":this.type=
"fuzz";h=s.createCurve(.9,this.numberOfSamples);break;default:b instanceof Float32Array&&(h=b)}this.distortion.curve=h;break;case "samples":if(void 0===b)return this.numberOfSamples;var c=parseInt(b);0<=c&&(this.numberOfSamples=c,this.param("curve",this.type));break;case "drive":if(void 0===b)return this.drive.gain.value;var c=parseFloat(b),d=this.drive.gain.minValue||0,f=this.drive.gain.maxValue||1;c>=d&&c<=f&&(this.drive.gain.value=c);break;case "color":case "tone":if(void 0===b)return this[h].frequency.value;
c=parseFloat(b);d=this[h].frequency.minValue||10;f=this[h].frequency.maxValue||this.context.sampleRate/2;c>=d&&c<=f&&(this[h].frequency.value=c)}return this};s.prototype.connect=function(){this.input.disconnect(0);this.distortion.disconnect(0);this.drive.disconnect(0);this.color.disconnect(0);this.tone.disconnect(0);this.isActive?(this.input.connect(this.color),this.color.connect(this.distortion),this.distortion.connect(this.drive),this.drive.connect(this.tone),this.tone.connect(this.output)):this.input.connect(this.output)};
s.prototype.toString=function(){return"[SoundModule Distortion]"};n.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "frequency":case "cutoff":if(void 0===b)return this.lowpass.frequency.value;h=parseFloat(b);var c=this.lowpass.frequency.minValue||10,d=this.lowpass.frequency.maxValue||this.context.sampleRate/2;h>=c&&h<=d&&(this.lowpass.frequency.value=h,this.depth.gain.value=
this.lowpass.frequency.value*this.depthRate);break;case "depth":if(void 0===b)return this.depthRate;h=parseFloat(b);0<=h&&1>=h&&(this.depth.gain.value=this.lowpass.frequency.value*h,this.depthRate=h);break;case "rate":if(void 0===b)return this.rate.value;h=parseFloat(b);c=this.rate.minValue||0;d=this.rate.maxValue||1E5;h>=c&&h<=d&&(this.rate.value=h);break;case "resonance":if(void 0===b)return this.lowpass.Q.value;h=parseFloat(b);c=this.lowpass.Q.minValue||1E-4;d=this.lowpass.Q.maxValue||1E3;h>=c&&
h<=d&&(this.lowpass.Q.value=h)}return this};n.prototype.stop=function(a,b){f.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.lowpass.frequency));return this};n.prototype.connect=function(){this.input.disconnect(0);this.lowpass.disconnect(0);this.isActive?(this.input.connect(this.lowpass),this.lowpass.connect(this.output)):this.input.connect(this.output)};n.prototype.toString=function(){return"[SoundModule Wah]"};q.prototype.param=function(a,b){if("[object Object]"===
Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "bass":case "middle":case "treble":case "presence":if(void 0===b)return this[h].gain.value;var c=parseFloat(b),d=this[h].gain.maxValue||40;c>=(this[h].gain.minValue||-40)&&c<=d&&(this[h].gain.value=c)}return this};q.prototype.connect=function(){this.input.disconnect(0);this.bass.disconnect(0);this.middle.disconnect(0);this.treble.disconnect(0);this.presence.disconnect(0);
this.isActive?(this.input.connect(this.bass),this.bass.connect(this.middle),this.middle.connect(this.treble),this.treble.connect(this.presence),this.presence.connect(this.output)):this.input.connect(this.output)};q.prototype.toString=function(){return"[SoundModule Equalizer]"};B.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "type":if(void 0===b)return this.filter.type;
var c=String(b).toLowerCase();h={lowpass:this.filter.LOWPASS,highpass:this.filter.HIGHPASS,bandpass:this.filter.BANDPASS,lowshelf:this.filter.LOWSHELF,highshelf:this.filter.HIGHSHELF,peaking:this.filter.PEAKING,notch:this.filter.NOTCH,allpass:this.filter.ALLPASS};c in h&&(this.filter.type="[object String]"===Object.prototype.toString.call(this.filter.type)?c:h[c]);break;case "frequency":case "cutoff":if(void 0===b)return this.filter.frequency.value;c=parseFloat(b);h=this.filter.frequency.minValue||
10;var d=this.filter.frequency.maxValue||this.context.sampleRate/2;c>=h&&c<=d&&(this.maxFrequency=c,this.filter.frequency.value=c);break;case "gain":if(void 0===b)return this.filter.gain.value;c=parseFloat(b);h=this.filter.gain.minValue||-40;d=this.filter.gain.maxValue||40;c>=h&&c<=d&&(this.filter.gain.value=c);break;case "q":if(void 0===b)return this.filter.Q.value;c=parseFloat(b);h=this.filter.Q.minValue||1E-4;d=this.filter.Q.maxValue||1E3;c>=h&&c<=d&&(this.filter.Q.value=c);break;case "attack":case "decay":case "sustain":case "release":if(void 0===
b)return this[h];c=parseFloat(b);0<=c&&(this[h]=c)}return this};B.prototype.connect=function(){this.input.disconnect(0);this.filter.disconnect(0);this.isActive?(this.input.connect(this.filter),this.filter.connect(this.output)):this.input.connect(this.output)};B.prototype.start=function(a){this.filter.frequency.value=this.maxFrequency;if(this.isActive){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;var b=a+this.attack,h=this.decay,c=this.sustain*this.filter.frequency.value;
this.filter.frequency.cancelScheduledValues(a);this.filter.frequency.setValueAtTime(this.filter.frequency.defaultValue,a);this.filter.frequency.linearRampToValueAtTime(this.maxFrequency,b);this.filter.frequency.setTargetAtTime(c,b,h)}return this};B.prototype.stop=function(a){if(this.isActive){a=parseFloat(a)-this.release;if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;var b=this.release;this.filter.frequency.cancelScheduledValues(a);this.filter.frequency.setValueAtTime(this.filter.frequency.value,
a);this.filter.frequency.setTargetAtTime(this.filter.frequency.defaultValue,a,b);this.filter.frequency.setValueAtTime(this.maxFrequency,a+b)}return this};B.prototype.state=function(a){if(void 0===a)return this.isActive;"toggle"===String(a).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(a);this.connect();return this};B.prototype.toString=function(){return"[SoundModule Filter]"};D.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,
a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "depth":if(void 0===b)return this.depth.gain.value;h=parseFloat(b);var c=this.depth.gain.minValue||0,d=this.depth.gain.maxValue||1;h>=c&&h<=d&&(this.depth.gain.value=h);break;case "rate":if(void 0===b)return this.rate.value;h=parseFloat(b);c=this.rate.minValue||0;d=this.rate.maxValue||1E5;h>=c&&h<=d&&(this.rate.value=h)}return this};D.prototype.connect=function(){this.input.disconnect(0);this.amplitudeL.disconnect(0);this.amplitudeR.disconnect(0);
this.splitter.disconnect(0);this.merger.disconnect(0);this.isActive?(this.input.connect(this.splitter),this.splitter.connect(this.amplitudeL,0,0),this.splitter.connect(this.amplitudeR,1,0),this.amplitudeL.connect(this.merger,0,0),this.amplitudeR.connect(this.merger,0,1),this.merger.connect(this.output)):this.input.connect(this.output)};D.prototype.start=function(a){if(this.isActive&&this.isStop){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;this.lfo.start(a);this.isStop=
!1;var b=this;this.processor.onaudioprocess=function(a){var c=a.inputBuffer.getChannelData(0),k=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);if(b.isActive&&0!==b.depth.gain.value&&0!==b.rate.value)for(var d=0;d<this.bufferSize;d++)k[d]=c[d],a[d]=-c[d];else for(d=0;d<this.bufferSize;d++)k[d]=0,a[d]=0}}return this};D.prototype.stop=function(a,b){f.prototype.stop.call(this,a,b);this.isActive&&(this.processor.disconnect(0),this.processor.onaudioprocess=null,this.lfo.connect(this.depth),
this.depth.connect(this.processor),this.processor.connect(this.lfoSplitter),this.lfoSplitter.connect(this.amplitudeL.gain,0),this.lfoSplitter.connect(this.amplitudeR.gain,1));return this};D.prototype.toString=function(){return"[SoundModule Autopanner]"};E.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "depth":if(void 0===b)return this.depth.gain.value;h=parseFloat(b);
var c=this.depth.gain.minValue||0,d=this.depth.gain.maxValue||1;h>=c&&h<=d&&(this.depth.gain.value=h);break;case "rate":if(void 0===b)return this.rate.value;h=parseFloat(b);c=this.rate.minValue||0;d=this.rate.maxValue||1E5;h>=c&&h<=d&&(this.rate.value=h);break;case "wave":if(void 0===b)return this.lfo.type;h=String(b).toLowerCase();this.lfo.SINE=this.lfo.SINE||0;this.lfo.SQUARE=this.lfo.SQUARE||1;this.lfo.SAWTOOTH=this.lfo.SAWTOOTH||2;this.lfo.TRIANGLE=this.lfo.TRIANGLE||3;c={sine:this.lfo.SINE,square:this.lfo.SQUARE,
sawtooth:this.lfo.SAWTOOTH,triangle:this.lfo.TRIANGLE};h in c&&(this.lfo.type="[object String]"===Object.prototype.toString.call(this.lfo.type)?h:c[h])}return this};E.prototype.connect=function(){this.input.disconnect(0);this.amplitude.disconnect(0);this.isActive?(this.input.connect(this.amplitude),this.amplitude.connect(this.output)):this.input.connect(this.output)};E.prototype.stop=function(a,b){f.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain));
return this};E.prototype.toString=function(){return"[SoundModule Tremolo]"};z.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "depth":if(void 0===b)return this.depth.gain.value;h=parseFloat(b);var c=this.depth.gain.minValue||0,d=this.depth.gain.maxValue||1;h>=c&&h<=d&&(this.depth.gain.value=h);break;case "rate":if(void 0===b)return this.rate.value;h=parseFloat(b);
c=this.rate.minValue||0;d=this.rate.maxValue||1E5;h>=c&&h<=d&&(this.rate.value=h)}return this};z.prototype.connect=function(){this.input.disconnect(0);this.amplitude.disconnect(0);this.isActive?(this.input.connect(this.amplitude),this.amplitude.connect(this.output)):this.input.connect(this.output)};z.prototype.stop=function(a,b){f.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain));return this};z.prototype.toString=function(){return"[SoundModule Ringmodulator]"};
r.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "stage":if(void 0===b)return this.numberOfStages;var c=parseInt(b),d,f=this.MAXIMUM_STAGES;0<=c&&c<=f&&(this.numberOfStages=c,this.connect());break;case "frequency":case "cutoff":if(void 0===b)return this.filters[0].frequency.value;c=parseFloat(b);d=this.filters[0].frequency.minValue||10;f=this.filters[0].frequency.maxValue||
this.context.sampleRate/2;if(c>=d&&c<=f){for(h=0;h<this.MAXIMUM_STAGES;h++)this.filters[h].frequency.value=c;this.depth.gain.value=this.filters[0].frequency.value*this.depthRate}break;case "resonance":if(void 0===b)return this.filters[0].Q.value;c=parseFloat(b);d=this.filters[0].Q.minValue||1E-4;f=this.filters[0].Q.maxValue||1E3;if(c>=d&&c<=f)for(h=0;h<this.MAXIMUM_STAGES;h++)this.filters[0].Q.value=c;break;case "depth":if(void 0===b)return this.depthRate;c=parseFloat(b);f=this.filters[0].frequency.value;
0<=c&&c<=f&&(this.depth.gain.value=this.filters[0].frequency.value*c,this.depthRate=c);break;case "rate":if(void 0===b)return this.rate.value;c=parseFloat(b);d=this.rate.minValue||0;f=this.rate.maxValue||1E5;c>=d&&c<=f&&(this.rate.value=c);break;case "mix":case "feedback":if(void 0===b)return this[h].gain.value;c=parseFloat(b);d=this[h].gain.minValue||0;f=this[h].gain.maxValue||1;c>=d&&c<=f&&(this[h].gain.value=c)}return this};r.prototype.connect=function(){this.input.disconnect(0);for(var a=0;a<
this.MAXIMUM_STAGES;a++)this.filters[a].disconnect(0);this.mix.disconnect(0);this.feedback.disconnect(0);this.input.connect(this.output);if(this.isActive&&0<this.numberOfStages)for(this.input.connect(this.filters[0]),a=0;a<this.numberOfStages;a++)a<this.numberOfStages-1?this.filters[a].connect(this.filters[a+1]):(this.filters[a].connect(this.mix),this.mix.connect(this.output),this.filters[a].connect(this.feedback),this.feedback.connect(this.filters[0]))};r.prototype.stop=function(a,b){f.prototype.stop.call(this,
a,b);if(this.isActive){this.lfo.connect(this.depth);for(var h=0;h<this.MAXIMUM_STAGES;h++)this.depth.connect(this.filters[h].frequency)}return this};r.prototype.toString=function(){return"[SoundModule Phaser]"};w.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var h in a)this.param(h,a[h]);else switch(h=String(a).replace(/-/g,"").toLowerCase(),h){case "delaytime":case "time":if(void 0===b)return this.delay.delayTime.value;var c=parseFloat(b),d=this.delay.delayTime.minValue||
0,f=this.delay.delayTime.maxValue||1;c>=d&&c<=f&&(this.delay.delayTime.value=c,this.depth.gain.value=this.delay.delayTime.value*this.depthRate);break;case "depth":if(void 0===b)return this.depthRate;c=parseFloat(b);0<=c&&1>=c&&(this.depth.gain.value=this.delay.delayTime.value*c,this.depthRate=c);break;case "rate":if(void 0===b)return this.rate.value;c=parseFloat(b);d=this.rate.minValue||0;f=this.rate.maxValue||1E5;c>=d&&c<=f&&(this.rate.value=c);break;case "mix":case "feedback":if(void 0===b)return this[h].gain.value;
c=parseFloat(b);d=this[h].gain.minValue||0;f=this[h].gain.maxValue||1;c>=d&&c<=f&&(this[h].gain.value=c);break;case "tone":if(void 0===b)return this.tone.frequency.value;c=parseFloat(b);d=this.tone.frequency.minValue||10;f=this.tone.frequency.maxValue||this.context.sampleRate/2;c>=d&&c<=f&&(this.tone.frequency.value=c)}return this};w.prototype.connect=function(){this.input.disconnect(0);this.delay.disconnect(0);this.mix.disconnect(0);this.tone.disconnect(0);this.feedback.disconnect(0);this.input.connect(this.output);
this.isActive&&(this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.mix),this.mix.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay))};w.prototype.stop=function(a,b){f.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.delay.delayTime));return this};w.prototype.toString=function(){return"[SoundModule Flanger]"};y.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,
a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "delaytime":case "time":if(void 0===b)return this.delay.delayTime.value;var c=parseFloat(b),f=this.delay.delayTime.minValue||0,e=this.delay.delayTime.maxValue||1;c>=f&&c<=e&&(this.delay.delayTime.value=c,this.depth.gain.value=this.delay.delayTime.value*this.depthRate);break;case "depth":if(void 0===b)return this.depthRate;c=parseFloat(b);0<=c&&1>=c&&(this.depth.gain.value=this.delay.delayTime.value*c,this.depthRate=c);break;case "rate":if(void 0===
b)return this.rate.value;c=parseFloat(b);f=this.rate.minValue||0;e=this.rate.maxValue||1E5;c>=f&&c<=e&&(this.rate.value=c);break;case "mix":case "feedback":if(void 0===b)return this[d].gain.value;c=parseFloat(b);f=this[d].gain.minValue||0;e=this[d].gain.maxValue||1;c>=f&&c<=e&&(this[d].gain.value=c);break;case "tone":if(void 0===b)return this.tone.frequency.value;c=parseFloat(b);f=this.tone.frequency.minValue||10;e=this.tone.frequency.maxValue||this.context.sampleRate/2;c>=f&&c<=e&&(this.tone.frequency.value=
c)}return this};y.prototype.connect=function(){this.input.disconnect(0);this.delay.disconnect(0);this.mix.disconnect(0);this.tone.disconnect(0);this.feedback.disconnect(0);this.input.connect(this.output);this.isActive&&(this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.mix),this.mix.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay))};y.prototype.stop=function(a,b){f.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),
this.depth.connect(this.delay.delayTime));return this};y.prototype.toString=function(){return"[SoundModule Chorus]"};J.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "delaytime":case "time":if(void 0===b)return this.delay.delayTime.value;var c=parseFloat(b),f=this.delay.delayTime.minValue||0,e=this.delay.delayTime.maxValue||this.MAX_DELAY_TIME;c>=f&&c<=e&&(this.delay.delayTime.value=
c);break;case "dry":case "wet":case "feedback":if(void 0===b)return this[d].gain.value;c=parseFloat(b);f=this[d].gain.minValue||0;e=this[d].gain.maxValue||1;c>=f&&c<=e&&(this[d].gain.value=c);break;case "tone":if(void 0===b)return this.tone.frequency.value;c=parseFloat(b);f=this.tone.frequency.minValue||10;e=this.tone.frequency.maxValue||this.context.sampleRate/2;c>=f&&c<=e&&(this.tone.frequency.value=c)}return this};J.prototype.connect=function(){this.input.disconnect(0);this.delay.disconnect(0);
this.dry.disconnect(0);this.wet.disconnect(0);this.tone.disconnect(0);this.feedback.disconnect(0);this.isActive?(this.input.connect(this.dry),this.dry.connect(this.output),this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.wet),this.wet.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay)):this.input.connect(this.output)};J.prototype.toString=function(){return"[SoundModule Delay]"};u.prototype.param=function(a,b){if("[object Object]"===
Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "type":if(void 0===b)return this.convolver.buffer;var c=parseInt(b),f=0,e=this.rirs.length-1;null===b?(this.convolver.buffer=null,this.input.disconnect(0),this.input.connect(this.output)):c>=f&&c<=e&&(this.convolver.buffer=this.rirs[c],this.connect());break;case "dry":case "wet":if(void 0===b)return this[d].gain.value;c=parseFloat(b);f=this[d].gain.minValue||0;e=this[d].gain.maxValue||
1;c>=f&&c<=e&&(this[d].gain.value=c);break;case "tone":if(void 0===b)return this.tone.frequency.value;c=parseFloat(b);f=this.tone.frequency.minValue||10;e=this.tone.frequency.maxValue||this.context.sampleRate/2;c>=f&&c<=e&&(this.tone.frequency.value=c);break;case "rirs":return this.rirs}return this};u.prototype.connect=function(){this.input.disconnect(0);this.convolver.disconnect(0);this.dry.disconnect(0);this.wet.disconnect(0);this.tone.disconnect(0);this.isActive?(this.input.connect(this.dry),this.dry.connect(this.output),
this.input.connect(this.tone),this.tone.connect(this.convolver),this.convolver.connect(this.wet),this.wet.connect(this.output)):this.input.connect(this.output)};u.prototype.start=function(a,b){if(a instanceof AudioBuffer||null===a)this.convolver.buffer=a,this.rirs.push(a);else if(a instanceof ArrayBuffer){var d=this;"[object Function]"!==Object.prototype.toString.call(b)&&(b=function(){});this.decodeAudioData(a,function(a){d.convolver.buffer=a;d.rirs.push(a)},b)}return this};u.prototype.preset=function(a,
b,d,c,f){if("[object Object]"===Object.prototype.toString.call(a)){var e=a;"rirs"in e&&(a=e.rirs);"timeout"in e&&(b=e.timeout);"success"in e&&(d=e.success);"error"in e&&(c=e.error);"progress"in e&&(f=e.progress)}Array.isArray(a)||(a=[a]);this.rirs=Array(a.length);var g=!1,l=parseInt(b),m=this;b=function(a,b){var e=new XMLHttpRequest;void 0===G||G?e.responseType="arraybuffer":e.overrideMimeType("text/plain; charset=x-user-defined");e.timeout=0<l?l:6E4;e.ontimeout=function(a){g||"[object Function]"!==
Object.prototype.toString.call(c)||c(a,"timeout");g=!0};e.onprogresss=function(a){g?e.abort():"[object Function]"===Object.prototype.toString.call(f)&&f(a)};e.onerror=function(a){g||"[object Function]"!==Object.prototype.toString.call(c)||c(a,"error");g=!0};e.onload=function(f){if(200===e.status){var k=null,g=function(a){a instanceof ArrayBuffer&&m.context.decodeAudioData(a,function(a){m.rirs[b]=a;a=0;for(var c=m.rirs.length;a<c;a++)if(void 0===m.rirs[a])return;"[object Function]"===Object.prototype.toString.call(d)&&
d.call(m,f,m.rirs)},function(){"[object Function]"===Object.prototype.toString.call(c)&&c(null,"decode")})};if(void 0===G||G)k=e.response,g.call(m,k);else{for(var l=e.responseText,n=[],s=0,q=l.length;s<q;s++)n.push(l.charCodeAt(s)&255);var l="audio/"+a.slice(-3),n=new Blob([new Uint8Array(n)],{type:l}),p=new FileReader;p.readAsArrayBuffer(n);p.onerror=function(a){if("[object Function]"===Object.prototype.toString.call(c)){var b="";switch(p.error.code){case p.error.NOT_FOUND_ERR:b="NOT_FOUND_ERR";
break;case p.error.SECURITY_ERR:b="SECURITY_ERR";break;case p.error.ABORT_ERR:b="ABORT_ERR";break;case p.error.NOT_READABLE_ERR:b="NOT_READABLE_ERR";break;case p.error.ENCODING_ERR:b="ENCODING_ERR";break;default:b="ERR"}c(a,b)}};p.onload=function(){k=p.result;g.call(m,k)}}}};e.open("GET",a,!0);e.send(null)};for(var e=0,n=a.length;e<n;e++)"[object String]"===Object.prototype.toString.call(a[e])?b.call(this,a[e],e):a[e]instanceof AudioBuffer&&(this.rirs[e]=a[e]);return this};u.prototype.state=function(a){if(void 0===
a)return this.isActive;"toggle"===String(a).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(a);this.connect();return this};u.prototype.toString=function(){return"[SoundModule Reverb]"};C.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "x":case "y":case "z":if(void 0===b)return this.positions[d];var c=parseFloat(b);isNaN(c)||(this.positions[d]=c,this.panner.setPosition(this.positions.x,
this.positions.y,this.positions.z));break;case "ox":case "oy":case "oz":if(void 0===b)return this.orientations[d.charAt(1)];c=parseFloat(b);isNaN(c)||(this.orientations[d.charAt(1)]=c,this.panner.setOrientation(this.orientations.x,this.orientations.y,this.orientations.z));break;case "vx":case "vy":case "vz":if(void 0===b)return this.velocities[d.charAt(1)];c=parseFloat(b);isNaN(c)||(this.velocities[d.charAt(1)]=c,this.panner.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z));break;
case "refdistance":if(void 0===b)return this.panner.refDistance;c=parseFloat(b);isNaN(c)||(this.panner.refDistance=c);break;case "maxdistance":if(void 0===b)return this.panner.maxDistance;c=parseFloat(b);isNaN(c)||(this.panner.maxDistance=c);break;case "rollofffactor":if(void 0===b)return this.panner.rolloffFactor;c=parseFloat(b);isNaN(c)||(this.panner.rolloffFactor=c);break;case "coneinnerangle":if(void 0===b)return this.panner.coneInnerAngle;c=parseFloat(b);isNaN(c)||(this.panner.coneInnerAngle=
c);break;case "coneouterangle":if(void 0===b)return this.panner.coneOuterAngle;c=parseFloat(b);isNaN(c)||(this.panner.coneOuterAngle=c);break;case "coneoutergain":if(void 0===b)return this.panner.coneOuterGain;c=parseFloat(b);isNaN(c)||(this.panner.coneOuterGain=c);break;case "panningmodel":if(void 0===b)return this.panner.panningModel;c=/HRTF/i.test(b)?String(b).toUpperCase():String(b).toLowerCase();d={equalpower:this.panner.EQUALPOWER,HRTF:this.panner.HRTF};c in d&&(this.panner.panningModel="[object String]"===
Object.prototype.toString.call(this.panner.panningModel)?c:d[c]);break;case "distancemodel":if(void 0===b)return this.panner.distanceModel;c=String(b).replace(/-/g,"").toLowerCase();d={linear:this.panner.LINEAR_DISTANCE,inverse:this.panner.INVERSE_DISTANCE,exponential:this.panner.EXPONENTIAL_DISTANCE};c in d&&(this.panner.distanceModel="[object String]"===Object.prototype.toString.call(this.panner.distanceModel)?c:d[c])}return this};C.prototype.connect=function(){this.input.disconnect(0);this.panner.disconnect(0);
this.isActive?(this.input.connect(this.panner),this.panner.connect(this.output)):this.input.connect(this.output)};C.prototype.toString=function(){return"[SoundModule Panner]"};A.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "attack":case "decay":case "sustain":case "release":if(void 0===b)return this[d];var c=parseFloat(b);0<=c&&(this[d]=c)}return this};A.prototype.isStop=
function(){for(var a=0,b=0,d=this.activeIndexes.length;b<d;b++){var c=this.activeIndexes[b];if(void 0!==c){if(.001<this.generators[c].gain.value)return!1;a++;if(a===this.activeCounter)return!0}}};A.prototype.ready=function(a,b,d){a=0<=parseInt(a)?parseInt(a):0;b.connect(this.generators[a]);this.generators[a].connect(d);this.activeIndexes[a]=a;this.activeCounter++;return this};A.prototype.start=function(a){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;for(var b=
a+this.attack,d=this.decay,c=this.sustain,f=0,e=this.activeIndexes.length;f<e;f++){var g=this.activeIndexes[f];void 0!==g&&(this.generators[g].gain.cancelScheduledValues(a),this.generators[g].gain.setValueAtTime(0,a),this.generators[g].gain.linearRampToValueAtTime(1,b),this.generators[g].gain.setTargetAtTime(c,b,d))}return this};A.prototype.stop=function(a){a=parseFloat(a)-this.release;if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;for(var b=this.release,d=0,c=this.activeIndexes.length;d<
c;d++){var f=this.activeIndexes[d];void 0!==f&&(this.generators[f].gain.cancelScheduledValues(a),this.generators[f].gain.setValueAtTime(this.generators[f].gain.value,a),this.generators[f].gain.setTargetAtTime(0,a,b))}return this};A.prototype.clear=function(){this.activeIndexes=[];this.activeCounter=0;return this};A.prototype.toString=function(){return"[OscillatorModule EnvelopeGenerator]"};this.listener=new b(a);this.analyser=new g(a);this.recorder=new d(a,this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT);
this.session=new l(a,this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT,this.analyser);this.eg=new A(a);this.compressor=new m(a,this.BUFFER_SIZE);this.distortion=new s(a,this.BUFFER_SIZE);this.wah=new n(a,this.BUFFER_SIZE);this.equalizer=new q(a,this.BUFFER_SIZE);this.filter=new B(a,this.BUFFER_SIZE);this.tremolo=new E(a,this.BUFFER_SIZE);this.ringmodulator=new z(a,this.BUFFER_SIZE);this.autopanner=new D(a,this.BUFFER_SIZE);this.phaser=new r(a,this.BUFFER_SIZE);this.flanger=new w(a,this.BUFFER_SIZE);
this.chorus=new y(a,this.BUFFER_SIZE);this.delay=new J(a,this.BUFFER_SIZE);this.reverb=new u(a,this.BUFFER_SIZE);this.panner=new C(a,this.BUFFER_SIZE);this.nodes=[this.panner,this.compressor,this.distortion,this.wah,this.equalizer,this.filter,this.autopanner,this.tremolo,this.ringmodulator,this.phaser,this.flanger,this.chorus,this.delay,this.reverb]}function C(a){function e(a){this.context=a;this.frequencies={start:-1,end:0};this.time=this.rate=0;this.type="linear"}w.call(this,a);this.sources=[];
this.times={start:0,stop:0};this.isAnalyser=!1;this.glide=new e(a);e.prototype.param=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "time":if(void 0===e)return this.time;d=parseFloat(e);0<=d&&(this.time=d);break;case "type":if(void 0===e)return this.type;d=String(e).toLowerCase();if("linear"===d||"exponential"===d)this.type=d}return this};e.prototype.ready=function(a){this.frequencies.end=
a;a=-1===this.frequencies.start?0:this.frequencies.end-this.frequencies.start;-1===this.frequencies.start||0===this.time||0===a?this.frequencies.start=this.frequencies.end:this.rate=a/this.time;return this};e.prototype.start=function(a,e){var d=parseFloat(e);if(isNaN(d)||d<this.context.currentTime)d=this.context.currentTime;var l=d+this.time;a.frequency.cancelScheduledValues(d);a.frequency.setValueAtTime(this.frequencies.start,d);a.frequency[this.type+"RampToValueAtTime"](this.frequencies.end,l);
return this};e.prototype.stop=function(){this.frequencies.start=this.frequencies.end;return this};e.prototype.toString=function(){return"[OscillatorModule Glide]"}}function F(a){w.call(this,a);this.sources=[];this.resources=[];this.buffers=[];this.volumes=[];this.isStops=[];this.settings=[];this.times={start:0,stop:0};this.isStop=!0;this.isAnalyser=!1}function y(a){function e(){this.depth=0}w.call(this,a);this.source=a.createBufferSource();this.buffer=null;this.currentTime=0;this.paused=!0;this.callbacks=
{decode:function(){},ready:function(){},start:function(){},stop:function(){},update:function(){},ended:function(){},error:function(){}};this.vocalcanceler=new e;e.prototype.param=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "depth":if(void 0===e)return this.depth;d=parseFloat(e);0<=d&&1>=d&&(this.depth=d)}return this};e.prototype.start=function(a,e){return a-this.depth*e}}function u(a){y.call(this,
a);this.media=this.source=null;this.ext="";this.duration=0;this.playbackRate=1;this.muted=this.loop=this.controls=!1;this.callbacks={loadstart:function(){}}}function I(a){w.call(this,a);this.sources=[];this.isAnalyser=!1}function H(a){this.context=a;this.source=null;this.sequences=[];this.timerids=[];this.prev=[];this.callbacks={start:function(){},stop:function(){},ended:function(){},error:function(){}}}var r,M=v.AudioContext||v.webkitAudioContext?!0:!1,G=v.webkitAudioContext?!0:!1;K.prototype.state=
function(a){};var P=function(a,e,b,g,d){if("[object Object]"===Object.prototype.toString.call(a)){var l=a;"file"in l&&(a=l.file);"type"in l&&(e=l.type);"success"in l&&(b=l.success);"error"in l&&(g=l.error);"progress"in l&&(d=l.progress)}if(a instanceof Blob){var f=new FileReader;f.onprogress=function(a){"[object Function]"===Object.prototype.toString.call(d)&&d(a)};f.onerror=function(a){if("[object Function]"===Object.prototype.toString.call(g)){var b="";switch(f.error.code){case f.error.NOT_FOUND_ERR:b=
"NOT_FOUND_ERR";break;case f.error.SECURITY_ERR:b="SECURITY_ERR";break;case f.error.ABORT_ERR:b="ABORT_ERR";break;case f.error.NOT_READABLE_ERR:b="NOT_READABLE_ERR";break;case f.error.ENCODING_ERR:b="ENCODING_ERR";break;default:b="ERR"}g(a,b)}};f.onload=function(a){if("[object Function]"===Object.prototype.toString.call(b)){var d=f.result;"[object String]"===Object.prototype.toString.call(d)&&-1===d.indexOf("data:")&&-1===d.indexOf("blob:")&&(d=d.replace(/<(\/?script.*?)>/gi,"&lt;$1&gt;"));b(a,d)}};
/arraybuffer/i.test(e)?f.readAsArrayBuffer(a):/dataurl/i.test(e)?f.readAsDataURL(a):/text/i.test(e)&&f.readAsText(a,"UTF-8")}else"[object Function]"===Object.prototype.toString.call(g)&&g(null,"FILE_IS_NOT_BLOB")},Q=function(a,e,b,g,d){if("[object Object]"===Object.prototype.toString.call(a)){var l=a;"event"in l&&(a=l.event);"type"in l&&(e=l.type);"success"in l&&(b=l.success);"error"in l&&(g=l.error);"progress"in l&&(d=l.progress)}if(a instanceof Event){l=null;if("drop"===a.type)a.stopImmediatePropagation(),
a.preventDefault(),l=a.dataTransfer.files[0];else if("change"===a.type&&"files"in a.target)l=a.target.files[0];else return;if(l instanceof File){if(/text/i.test(e)&&-1===l.type.indexOf("text"))throw Error("Please upload text file !!");if(/arraybuffer|dataurl/i.test(e)&&-1===l.type.indexOf("audio"))throw Error("Please upload audio file !!");this.read({file:l,type:e,success:b,error:g,progress:d});return l}throw Error("Please upload file !!");}},R=function(a,e,b,g,d){if("[object Object]"===Object.prototype.toString.call(a)){var l=
a;"url"in l&&(a=l.url);"timeout"in l&&(e=l.timeout);"success"in l&&(b=l.success);"error"in l&&(g=l.error);"progress"in l&&(d=l.progress)}var f=new XMLHttpRequest;void 0===G||G?f.responseType="arraybuffer":f.overrideMimeType("text/plain; charset=x-user-defined");e=parseInt(e);f.timeout=0<e?e:6E4;f.ontimeout=function(a){"[object Function]"===Object.prototype.toString.call(g)&&g(a,"timeout")};f.onprogress=function(a){"[object Function]"===Object.prototype.toString.call(d)&&d(a)};f.onerror=function(a){"[object Function]"===
Object.prototype.toString.call(g)&&g(a,"error")};f.onload=function(d){if(200===f.status){var e=null;if(void 0===G||G)e=f.response,e instanceof ArrayBuffer&&"[object Function]"===Object.prototype.toString.call(b)&&b(d,e);else{for(var l=f.responseText,q=[],r=0,D=l.length;r<D;r++)q.push(l.charCodeAt(r)&255);var l="audio/"+a.slice(-3),q=new Blob([new Uint8Array(q)],{type:l}),E=new FileReader;E.readAsArrayBuffer(q);E.onerror=function(a){if("[object Function]"===Object.prototype.toString.call(g)){var b=
"";switch(E.error.code){case E.error.NOT_FOUND_ERR:b="NOT_FOUND_ERR";break;case E.error.SECURITY_ERR:b="SECURITY_ERR";break;case E.error.ABORT_ERR:b="ABORT_ERR";break;case E.error.NOT_READABLE_ERR:b="NOT_READABLE_ERR";break;case E.error.ENCODING_ERR:b="ENCODING_ERR";break;default:b="ERR"}g(a,b)}};E.onload=function(){e=E.result;e instanceof ArrayBuffer&&"[object Function]"===Object.prototype.toString.call(b)&&b(d,e)}}}};f.open("GET",a,!0);f.send(null)},S=function(a,e,b,g){a instanceof AudioContext&&
e instanceof ArrayBuffer&&("[object Function]"!==Object.prototype.toString.call(b)&&(b=function(){}),"[object Function]"!==Object.prototype.toString.call(g)&&(g=function(){}),a.decodeAudioData(e,b,g))},T=function(a){var e=Math.pow(2,1/12);Array.isArray(a)||(a=[a]);for(var b=Array(a.length),g=0,d=a.length;g<d;g++){var l=parseInt(a[g]);b[g]=0<=l?27.5*Math.pow(e,l):0}return b},U=function(a){a=parseFloat(a);if(0<=a)return{minutes:Math.floor(a/60),seconds:Math.floor(a%60)}},V=function(a){v.X===r&&(v.X=
void 0);a&&v.XSound===r&&(v.XSound=void 0);return r};A.prototype.setup=function(a,e,b,g){if("[object Object]"===Object.prototype.toString.call(a)){var d=a;"id"in d&&(a=d.id);"type"in d&&(e=d.type);"formats"in d&&(b=d.formats);"callbacks"in d&&(g=d.callbacks)}d=String(a);e="video"!==String(e).toLowerCase()?"audio":"video";this.media=null!==a&&""!==d?document.getElementById(d):document.createElement(e);if(this.media instanceof HTMLMediaElement){Array.isArray(b)||(b=[b]);a=0;for(d=b.length;a<d;a++){var l=
e+"/"+String(b[a]).toLowerCase();if(/^(?:maybe|probably)/.test(this.media.canPlayType(l))){this.ext=b[a];break}}if(""===this.ext)throw Error("Media format that can be played does not exist !!");if("[object Object]"===Object.prototype.toString.call(g))for(var f in g)this.callbacks[f.toLowerCase()]="[object Function]"===Object.prototype.toString.call(g[f])?g[f]:function(){};var m=this;for(f in this.callbacks)switch(f){case "loadedmetadata":this.media.addEventListener("loadedmetadata",function(a){m.duration=
this.duration;m.callbacks.loadedmetadata(a,this)},!1);break;default:this.media.addEventListener(f,function(a){m.callbacks[a.type.toLowerCase()](a,this)},!1)}return this}this.media=null};A.prototype.param=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var b in a)this.param(b,a[b]);else switch(b=String(a).replace(/-/g,"").toLowerCase(),b){case "mastervolume":if(void 0===e)return this.media instanceof HTMLMediaElement?this.media.volume:this.volume;var g=parseFloat(e);0<=g&&
1>=g&&(this.media instanceof HTMLMediaElement&&(this.media.volume=g),this.volume=g);break;case "playbackrate":if(void 0===e)return this.media instanceof HTMLMediaElement?this.media.playbackRate:this.playbackRate;g=parseFloat(e);.5<=g&&(this.media instanceof HTMLMediaElement&&(this.media.playbackRate=g),this.playbackRate=g);break;case "currenttime":if(void 0===e)return this.media instanceof HTMLMediaElement?this.media.currentTime:0;g=parseFloat(e);if(this.media instanceof HTMLMediaElement)b=this.duration;
else return;0<=g&&g<=b&&(this.media.currentTime=g);break;case "loop":case "muted":case "controls":if(void 0===e)return this.media instanceof HTMLMediaElement?this.media[b]:this[b];this.media instanceof HTMLMediaElement&&(this.media[b]=Boolean(e));this[b]=Boolean(e);break;case "width":case "height":if(void 0===e)return this.media instanceof HTMLVideoElement?this.media[b]:0;g=parseInt(e);0<=g&&this.media instanceof HTMLVideoElement&&(this.media[b]=g);break;case "duration":return this.duration;case "channels":return}return this};
A.prototype.ready=function(a){a=String(a);try{-1!==a.indexOf("data:")||-1!==a.indexOf("blob:")?this.media.src=a:this.media.src=a+"."+this.ext}catch(e){throw Error("The designated resource cannot be loaded !!");}return this};A.prototype.start=function(a){this.media instanceof HTMLMediaElement&&this.media.paused&&(this.media.play(),a=parseFloat(a),this.media.currentTime=0<=a&&a<=this.duration?a:0,this.media.playbackRate=this.playbackRate,this.media.controls=this.controls,this.media.loop=this.loop,this.media.muted=
this.muted);return this};A.prototype.stop=function(){this.media instanceof HTMLMediaElement&&!this.media.paused&&this.media.pause();return this};A.prototype.toggle=function(a){this.media instanceof HTMLMediaElement&&(this.media.paused?this.start(a):this.stop());return this};A.prototype.get=function(){return this.media};A.prototype.isMedia=function(){return this.media instanceof HTMLMediaElement?!0:!1};A.prototype.isSource=function(){return this.isMedia()};A.prototype.isPaused=function(){return this.media instanceof
HTMLMediaElement?this.media.paused:!0};A.prototype.fullscreen=function(){if(this.media instanceof HTMLVideoElement)if(this.media.webkitRequestFullscreen)this.media.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else if(this.media.mozRequestFullScreen)this.media.mozRequestFullScreen();else if(this.media.requestFullscreen)this.media.requestFullscreen();else throw Error("Cannot change to full screen !!");return this};A.prototype.exitFullscreeen=function(){if(document.webkitExitFullscreen)document.webkitExitFullscreen();
else if(document.mozCancelFullscreen)document.mozCancelFullscreen();else if(document.exitFullscreen)document.exitFullscreen();else throw Error("Cannot exit from full screen !!");return this};A.prototype.toString=function(){return"[MediaFallbackModule]"};if(M){v.AudioContext=v.AudioContext||v.webkitAudioContext;audiocontext=new AudioContext;audiocontext.createScriptProcessor=audiocontext.createScriptProcessor||audiocontext.createJavaScriptNode;audiocontext.createGain=audiocontext.createGain||audiocontext.createGainNode;
audiocontext.createDelay=audiocontext.createDelay||audiocontext.createDelayNode;audiocontext.createPeriodicWave=audiocontext.createPeriodicWave||audiocontext.createWaveTable;w.prototype.setup=function(){};w.prototype.param=function(a,e){switch(String(a).replace(/-/g,"").toLowerCase()){case "mastervolume":if(void 0===e)return this.masterVolume.gain.value;var b=parseFloat(e),g=this.masterVolume.gain.maxValue||1;b>=(this.masterVolume.gain.minValue||0)&&b<=g&&(this.masterVolume.gain.value=b)}};w.prototype.ready=
function(){};w.prototype.start=function(){};w.prototype.stop=function(){};w.prototype.get=function(){};w.prototype.resize=function(a){w.call(this,audiocontext,a);return this};w.prototype.connect=function(a,e){Array.isArray(e)&&(this.nodes=e);a.disconnect(0);0<this.nodes.length?a.connect(this.nodes[0].input):a.connect(this.masterVolume);for(var b=0,g=this.nodes.length;b<g;b++)this.nodes[b].output.disconnect(0),b<this.nodes.length-1?this.nodes[b].output.connect(this.nodes[b+1].input):this.nodes[b].output.connect(this.masterVolume);
this.masterVolume.connect(this.analyser.input);this.analyser.output.connect(this.context.destination);this.masterVolume.connect(this.recorder.processor);this.recorder.processor.connect(this.context.destination);this.masterVolume.connect(this.session.sender);this.session.sender.connect(this.context.destination);return this};w.prototype.module=function(a){a=String(a).replace(/-/g,"").toLowerCase();switch(a){case "listener":case "analyser":case "recorder":case "session":case "compressor":case "distortion":case "wah":case "equalizer":case "filter":case "tremolo":case "ringmodulator":case "autopanner":case "phaser":case "flanger":case "chorus":case "delay":case "reverb":case "panner":return this[a];
case "eg":if(a in this)return this[a];case "glide":if(a in this)return this[a];case "vocalcanceler":if(a in this)return this[a];default:for(var e=0,b=this.plugins.length;e<b;e++)if(a===this.plugins[e].name)return this.plugins[e].plugin}};w.prototype.install=function(a,e){"[object Function]"===Object.prototype.toString.call(e)&&(e.prototype=new this.Effector(audiocontext,this.BUFFER_SIZE),this.plugins.push({name:String(a).toLowerCase(),plugin:new e(audiocontext)}));return this};w.prototype.toString=
function(){return"[SoundModule]"};C.prototype=Object.create(w.prototype);C.prototype.constructor=C;C.prototype.setup=function(a){function e(a,b){this.isActive=b;this.context=a;this.source=a.createOscillator();this.source.start=this.source.start||this.source.noteOn;this.source.stop=this.source.stop||this.source.noteOff;this.volume=a.createGain();this.isStop=!0;this.fine=this.octave=0}e.prototype=Object.create(K.prototype);e.prototype.constructor=e;e.prototype.param=function(a,b){if("[object Object]"===
Object.prototype.toString.call(a))for(var f in a)this.param(f,a[f]);else switch(f=String(a).replace(/-/g,"").toLowerCase(),f){case "type":if(void 0===b)return this.source.type;f=String(b).toLowerCase();this.source.SINE=this.source.SINE||0;this.source.SQUARE=this.source.SQUARE||1;this.source.SAWTOOTH=this.source.SAWTOOTH||2;this.source.TRIANGLE=this.source.TRIANGLE||3;var e={sine:this.source.SINE,square:this.source.SQUARE,sawtooth:this.source.SAWTOOTH,triangle:this.source.TRIANGLE};f in e&&(this.source.type=
"[object String]"===Object.prototype.toString.call(this.source.type)?f:e[f]);break;case "octave":if(void 0===b)return this.octave;f=this.octave=parseFloat(b);var e=(this.source.detune.minValue||-4800)/1200,g=(this.source.detune.maxValue||4800)/1200;f>=e&&f<=g&&(this.source.detune.value=this.fine+1200*f);break;case "fine":if(void 0===b)return this.fine;f=this.fine=parseFloat(b);-1200<=f&&1200>=f&&(this.source.detune.value=f+1200*this.octave);break;case "volume":case "gain":if(void 0===b)return this.volume.gain.value;
f=parseFloat(b);e=this.volume.gain.minValue||0;g=this.volume.gain.maxValue||1;f>=e&&f<=g&&(this.volume.gain.value=f)}return this};e.prototype.start=function(a,b){if(this.isActive){var e=this.source.type,g=this.source.frequency.value,s=this.source.detune.value;this.isStop||(this.source.stop(this.context.currentTime),this.source.disconnect(0));this.source=this.context.createOscillator();this.source.start=this.source.start||this.source.noteOn;this.source.stop=this.source.stop||this.source.noteOff;this.source.type=
e;this.source.frequency.value=g;this.source.detune.value=s;this.volume.connect(a);this.source.start(b);this.isStop=!1}else this.isStop||(this.source.stop(this.context.currentTime),this.isStop=!0),this.source.disconnect(0);return this};e.prototype.stop=function(a){this.isStop||(this.source.stop(a),this.source.disconnect(0),this.isStop=!0);return this};e.prototype.state=function(a){if(void 0===a)return this.isActive;"toggle"===String(a).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(a);
return this};e.prototype.toString=function(){return"[OscillatorModule Oscillator]"};Array.isArray(a)||(a=[a]);for(var b=0,g=a.length;b<g;b++)this.sources[b]=new e(this.context,Boolean(a[b])),this.eg.generators[b]=this.context.createGain(),this.eg.generators[b].gain.setTargetAtTime=this.eg.generators[b].gain.setTargetAtTime||this.eg.generators[b].gain.setTargetValueAtTime;return this};C.prototype.param=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var b in a)this.param(b,
a[b]);else{b=String(a).replace(/-/g,"").toLowerCase();var g=w.prototype.param.call(this,b,e)}return void 0===g?this:g};C.prototype.ready=function(a,e){var b=parseFloat(a),g=parseFloat(e);0<b&&(this.times.start=b);g>b&&(this.times.stop=g);return this};C.prototype.start=function(a,e,b){var g=this.context.currentTime+this.times.start;Array.isArray(a)||(a=[a]);for(var d=0,l=a.length;d<l;d++){var f=parseFloat(a[d]);a[d]=0<=f?f:0}this.eg.clear();this.processor.disconnect(0);this.processor.onaudioprocess=
null;this.connect(this.processor,e);d=0;for(l=a.length;d<l&&!(d>=this.sources.length);d++)e=this.sources[d],f=a[d],e.start(this.processor,g),this.eg.ready(d,e.source,e.volume),this.glide.ready(f).start(e.source,g);this.eg.start(g);this.chorus.start(g);this.flanger.start(g);this.phaser.start(g);this.autopanner.start(g);this.tremolo.start(g);this.ringmodulator.start(g);this.wah.start(g);this.filter.start(g);d=0;for(l=this.plugins.length;d<l;d++)this.plugins[d].plugin.start(g);this.isAnalyser||(this.analyser.start("time"),
this.analyser.start("fft"),this.isAnalyser=!0);"[object Function]"===Object.prototype.toString.call(b)?this.processor.onaudioprocess=b:this.processor.onaudioprocess=function(a){var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),e=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);e.set(b);a.set(d)};return this};C.prototype.stop=function(a){var e=this.context.currentTime+this.times.stop;this.eg.stop(e);this.glide.stop();this.filter.stop(e);for(var b=0,g=this.plugins.length;b<
g;b++)this.plugins[b].plugin.stop(e,this.eg.release);var d=this;void 0===G||G||v.setTimeout(function(){for(var a=d.context.currentTime,b=0,e=d.sources.length;b<e;b++)d.sources[b].stop(a);d.chorus.stop(a);d.flanger.stop(a);d.phaser.stop(a);d.autopanner.stop(a);d.tremolo.stop(a);d.ringmodulator.stop(a);d.wah.stop(a);d.analyser.stop("time");d.analyser.stop("fft");d.isAnalyser=!1;d.processor.disconnect(0);d.processor.onaudioprocess=null},1E3*(this.times.stop+this.eg.release));"[object Function]"===Object.prototype.toString.call(a)?
this.processor.onaudioprocess=a:this.processor.onaudioprocess=function(a){var b=a.inputBuffer.getChannelData(0),e=a.inputBuffer.getChannelData(1),g=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);g.set(b);a.set(e);if(d.eg.isStop()){b=d.context.currentTime;e=0;for(g=d.sources.length;e<g;e++)d.sources[e].stop(b);d.chorus.stop(b);d.flanger.stop(b);d.phaser.stop(b);d.autopanner.stop(b);d.tremolo.stop(b);d.ringmodulator.stop(b);d.wah.stop(b);d.analyser.stop("time");d.analyser.stop("fft");
d.isAnalyser=!1;this.disconnect(0);this.onaudioprocess=null}};return this};C.prototype.get=function(a){a=parseInt(a);if(0<=a&&a<this.sources.length)return this.sources[a].source;a=Array(this.sources.length);for(var e=0,b=this.sources.length;e<b;e++)a[e]=this.sources[e].source;return a};C.prototype.length=function(){return this.sources.length};C.prototype.toString=function(){return"[OscillatorModule]"};F.prototype=Object.create(w.prototype);F.prototype.constructor=F;F.prototype.setup=function(a,e,
b,g,d,l){if("[object Object]"===Object.prototype.toString.call(a)){var f=a;"resources"in f&&(a=f.resources);"settings"in f&&(e=f.settings);"timeout"in f&&(b=f.timeout);"success"in f&&(g=f.success);"error"in f&&(d=f.error);"progress"in f&&(l=f.progress)}Array.isArray(a)||(a=[a]);this.resources=a;Array.isArray(e)||(e=[e]);this.buffers.length=a.length;a=0;for(f=e.length;a<f;a++){if("buffer"in e[a])if(f=parseInt(e[a].buffer),0<=f&&f<this.buffers.length)e[a].buffer=f;else return;else return;e[a].rate=
"rate"in e[a]&&0<=e[a].rate?parseFloat(e[a].rate):1;e[a].loop="loop"in e[a]?Boolean(e[a].loop):!1;e[a].start="start"in e[a]&&0<=e[a].start?parseFloat(e[a].start):0;e[a].end="end"in e[a]&&0<=e[a].end?parseFloat(e[a].end):0;e[a].volume="volume"in e[a]&&0<=e[a].volume&&1>=e[a].volume?parseFloat(e[a].volume):1;a=0;for(f=e.length;a<f;a++)this.isStops[a]=!0,this.volumes[a]=this.context.createGain(),this.eg.generators[a]=this.context.createGain(),this.eg.generators[a].gain.setTargetAtTime=this.eg.generators[a].gain.setTargetAtTime||
this.eg.generators[a].gain.setTargetValueAtTime;this.settings=e}var m=!1,s=parseInt(b),n=this;e=function(a,b){var e=new XMLHttpRequest;void 0===G||G?e.responseType="arraybuffer":e.overrideMimeType("text/plain; charset=x-user-defined");e.timeout=0<s?s:6E4;e.ontimeout=function(a){m||"[object Function]"!==Object.prototype.toString.call(d)||d(a,"timeout");m=!0};e.onprogress=function(a){m?e.abort():"[object Function]"===Object.prototype.toString.call(l)&&l(a)};e.onerror=function(a){m||"[object Function]"!==
Object.prototype.toString.call(d)||d(a,"error");m=!0};e.onload=function(f){if(200===e.status){var l=null,m=function(a){a instanceof ArrayBuffer&&n.context.decodeAudioData(a,function(a){n.buffers[b]=a;a=0;for(var d=n.buffers.length;a<d;a++)if(void 0===n.buffers[a])return;"[object Function]"===Object.prototype.toString.call(g)&&g.call(n,f,n.buffers)},function(){"[object Function]"===Object.prototype.toString.call(d)&&d(null,"decode")})};if(void 0===G||G)l=e.response,m.call(n,l);else{for(var s=e.responseText,
r=[],v=0,w=s.length;v<w;v++)r.push(s.charCodeAt(v)&255);var s="audio/"+a.slice(-3),r=new Blob([new Uint8Array(r)],{type:s}),u=new FileReader;u.readAsArrayBuffer(r);u.onerror=function(a){if("[object Function]"===Object.prototype.toString.call(d)){var b="";switch(u.error.code){case u.error.NOT_FOUND_ERR:b="NOT_FOUND_ERR";break;case u.error.SECURITY_ERR:b="SECURITY_ERR";break;case u.error.ABORT_ERR:b="ABORT_ERR";break;case u.error.NOT_READABLE_ERR:b="NOT_READABLE_ERR";break;case u.error.ENCODING_ERR:b=
"ENCODING_ERR";break;default:b="ERR"}d(a,b)}};u.onload=function(){l=u.result;m.call(n,l)}}}};e.open("GET",a,!0);e.send(null)};a=0;for(f=this.resources.length;a<f;a++)"[object String]"===Object.prototype.toString.call(this.resources[a])?e.call(this,this.resources[a],a):this.resources[a]instanceof AudioBuffer&&(this.buffers[a]=this.resources[a]);return this};F.prototype.param=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var b in a)this.param(b,a[b]);else{b=String(a).replace(/-/g,
"").toLowerCase();var g=w.prototype.param.call(this,b,e)}return void 0===g?this:g};F.prototype.ready=function(a,e){var b=parseFloat(a),g=parseFloat(e);0<b&&(this.times.start=b);g>b&&(this.times.stop=g);return this};F.prototype.start=function(a,e,b){if(0<=a&&a<this.settings.length){var g=parseInt(a),d=this.settings[g].buffer,l=this.settings[g].rate,f=this.settings[g].loop,m=this.settings[g].start,s=this.settings[g].end,n=this.settings[g].volume;if(void 0!==this.buffers[d]){void 0!==this.sources[g]&&
(this.sources[g].stop(this.context.currentTime),this.sources[g].disconnect(0),delete this.sources[g]);a=this.context.createBufferSource();a.start=a.start||a.noteGrainOn;a.stop=a.stop||a.noteOff;a.buffer=this.buffers[d];a.playbackRate.value=l;a.loop=f;a.loopStart=m;a.loopEnd=s;this.volumes[g].gain.value=n;this.eg.ready(g,a,this.volumes[g]);this.volumes[g].connect(this.processor);this.connect(this.processor,e);e=this.context.currentTime+this.times.start;a.start(e);this.sources[g]=a;this.eg.start(e);
this.chorus.start(e);this.flanger.start(e);this.phaser.start(e);this.autopanner.start(e);this.tremolo.start(e);this.ringmodulator.start(e);this.wah.start(e);this.filter.start(e);d=0;for(l=this.plugins.length;d<l;d++)this.plugins[d].plugin.start(e);this.isAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.isAnalyser=!0);this.isStops[g]=!1;var q=this;a.onended=function(){q.isStops[g]=!0};"[object Function]"===Object.prototype.toString.call(b)?this.processor.onaudioprocess=b:this.processor.onaudioprocess=
function(a){q.isStop=q.isStops.every(function(a,b,d){return a});if(q.isStop){var b=q.context.currentTime;q.chorus.stop(b);q.flanger.stop(b);q.phaser.stop(b);q.autopanner.stop(b);q.tremolo.stop(b);q.ringmodulator.stop(b);q.wah.stop(b);q.eg.clear();q.analyser.stop("time");q.analyser.stop("fft");q.isAnalyser=!1;this.disconnect(0);this.onaudioprocess=null}else{var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),e=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);
e.set(b);a.set(d)}};return this}}};F.prototype.stop=function(a){if(0<=a&&a<this.settings.length&&(a=parseInt(a),void 0!==this.buffers[this.settings[a].buffer]&&void 0!==this.sources[a])){a=this.context.currentTime+this.times.stop;this.eg.stop(a);this.filter.stop(a);for(var e=0,b=this.plugins.length;e<b;e++)this.plugins[e].plugin.stop(a,this.eg.release);return this}};F.prototype.get=function(a){a=parseInt(a);return 0<=a&&a<this.buffers.length?this.buffers[a]:this.buffers};F.prototype.toString=function(){return"[OneshotModule]"};
y.prototype=Object.create(w.prototype);y.prototype.constructor=y;y.prototype.setup=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var b in a)this.setup(b,a[b]);else b=String(a).replace(/-/g,"").toLowerCase(),b in this.callbacks&&"[object Function]"===Object.prototype.toString.call(e)&&(this.callbacks[b]=e);return this};y.prototype.param=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var b in a)this.param(b,a[b]);else{b=String(a).replace(/-/g,
"").toLowerCase();var g=w.prototype.param.call(this,b,e);if(void 0!==g)return g;switch(b){case "playbackrate":if(void 0===e)return this.source.playbackRate.value;b=parseFloat(e);var g=this.source.playbackRate.minValue||0,d=this.source.playbackRate.maxValue||1024;b>=g&&b<=d&&(this.source.playbackRate.value=b);break;case "loop":case "looping":if(void 0===e)return this.source.loop;this.source.loop=Boolean(e);break;case "currenttime":if(void 0===e)return this.currentTime;b=parseFloat(e);if(this.buffer instanceof
AudioBuffer)d=this.buffer.duration;else{this.currentTime=0;break}0<=b&&b<=d&&(this.paused?(this.stop(),this.currentTime=b):(this.stop(),this.start(b)));break;case "duration":return this.buffer instanceof AudioBuffer?this.buffer.duration:0;case "samplerate":return this.buffer instanceof AudioBuffer?this.buffer.sampleRate:this.SAMPLE_RATE;case "channels":return this.buffer instanceof AudioBuffer?this.buffer.numberOfChannels:0}}return this};y.prototype.ready=function(a){a instanceof ArrayBuffer&&(this.context.decodeAudioData(a,
function(a){this.buffer=a;this.analyser.start("time-all-L",a);this.analyser.start("time-all-R",a);this.callbacks.ready(a)}.bind(this),this.callbacks.error.bind(this)),this.callbacks.decode(a));return this};y.prototype.start=function(a,e,b){if(this.buffer instanceof AudioBuffer&&this.paused){var g=this.context.currentTime;a=parseFloat(a);this.currentTime=0<=a&&a<=this.buffer.duration?a:0;var d=this.source.playbackRate.value,l=this.source.loop;this.source=this.context.createBufferSource();this.source.start=
this.source.start||this.source.noteGrainOn;this.source.stop=this.source.stop||this.source.noteOff;this.source.buffer=this.buffer;this.source.playbackRate.value=d;this.source.loop=l;void 0===G||G?(this.source.connect(this.processor),this.connect(this.processor,e)):this.connect(this.source,e);this.source.start(g,a,this.buffer.duration-a);this.analyser.start("time");this.analyser.start("fft");this.paused=!1;this.chorus.start(g);this.flanger.start(g);this.phaser.start(g);this.autopanner.start(g);this.tremolo.start(g);
this.ringmodulator.start(g);this.wah.start(g);e=0;for(a=this.plugins.length;e<a;e++)this.plugins[e].plugin.start(g);this.callbacks.start(this.source,this.currentTime);var f=this;"[object Function]"===Object.prototype.toString.call(b)?this.processor.onaudioprocess=b:this.processor.onaudioprocess=function(a){var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),e=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);if(f.currentTime<Math.floor(f.source.buffer.duration)){for(var g=
0;g<this.bufferSize;g++)e[g]=f.vocalcanceler.start(b[g],d[g]),a[g]=f.vocalcanceler.start(d[g],b[g]),f.currentTime+=1*f.source.playbackRate.value/f.source.buffer.sampleRate,0===Math.floor(f.currentTime*f.source.buffer.sampleRate)%(1*f.source.buffer.sampleRate)&&f.callbacks.update(f.source,f.currentTime);f.analyser.timeAllL.update(f.currentTime);f.analyser.timeAllR.update(f.currentTime)}else f.source.loop?f.currentTime=0:f.end.call(f)}}return this};y.prototype.stop=function(){if(this.buffer instanceof
AudioBuffer&&!this.paused){var a=this.context.currentTime;this.source.stop(a);this.chorus.stop(a);this.flanger.stop(a);this.phaser.stop(a);this.autopanner.stop(a);this.tremolo.stop(a);this.ringmodulator.stop(a);this.wah.stop(a);for(var e=0,b=this.plugins.length;e<b;e++)this.plugins[e].plugin.stop(a);this.analyser.stop("time");this.analyser.stop("fft");this.processor.disconnect(0);this.processor.onaudioprocess=null;this.paused=!0;this.callbacks.stop(this.source,this.currentTime)}return this};y.prototype.get=
function(){return this.source};y.prototype.toggle=function(a,e,b){this.paused?this.start(a,e,b):this.stop();return this};y.prototype.end=function(){this.stop();this.currentTime=0;this.callbacks.ended(this.source,this.currentTime);return this};y.prototype.isBuffer=function(){return this.buffer instanceof AudioBuffer?!0:!1};y.prototype.isSource=function(){return this.source instanceof AudioBufferSourceNode&&this.source.buffer instanceof AudioBuffer?!0:!1};y.prototype.isPaused=function(){return this.paused};
y.prototype.toString=function(){return"[AudioModule]"};u.prototype=Object.create(y.prototype);u.prototype.constructor=u;u.prototype.setup=function(a,e,b,g){if("[object Object]"===Object.prototype.toString.call(a)){var d=a;"id"in d&&(a=d.id);"type"in d&&(e=d.type);"formats"in d&&(b=d.formats);"callbacks"in d&&(g=d.callbacks)}d=String(a);e="video"!==String(e).toLowerCase()?"audio":"video";this.media=null!==a&&""!==d?document.getElementById(d):document.createElement(e);if(this.media instanceof HTMLMediaElement){Array.isArray(b)||
(b=[b]);a=0;for(d=b.length;a<d;a++){var l=e+"/"+String(b[a]).toLowerCase();if(/^(?:maybe|probably)/.test(this.media.canPlayType(l))){this.ext=b[a];break}}if(""===this.ext)throw Error("Media format that can be played does not exist !!");if("[object Object]"===Object.prototype.toString.call(g))for(var f in g)this.callbacks[f.toLowerCase()]="[object Function]"===Object.prototype.toString.call(g[f])?g[f]:function(){};var m=this;for(f in this.callbacks)switch(f){case "loadstart":this.media.addEventListener("loadstart",
function(a){m.source instanceof MediaElementAudioSourceNode||(m.source=m.context.createMediaElementSource(this));m.callbacks.loadstart(a,this)},!1);break;case "loadedmetadata":this.media.addEventListener("loadedmetadata",function(a){m.duration=this.duration;m.callbacks.loadedmetadata(a,this)},!1);break;case "ended":this.media.addEventListener("ended",function(a){var b=m.context.currentTime;this.pause();m.chorus.stop(b);m.flanger.stop(b);m.phaser.stop(b);m.autopanner.stop(b);m.tremolo.stop(b);m.ringmodulator.stop(b);
m.wah.stop(b);for(var d=0,e=m.plugins.length;d<e;d++)m.plugins[d].plugin.isActive&&m.plugins[d].plugin.stop(b);m.analyser.stop("time");m.analyser.stop("fft");m.processor.disconnect(0);m.processor.onaudioprocess=null;m.callbacks.ended(a,this)},!1);break;default:this.media.addEventListener(f,function(a){m.callbacks[a.type.toLowerCase()](a,this)},!1)}return this}this.media=null};u.prototype.param=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var b in a)this.param(b,a[b]);
else{b=String(a).replace(/-/g,"").toLowerCase();var g=w.prototype.param.call(this,b,e);if(void 0!==g)return g;switch(b){case "playbackrate":if(void 0===e)return this.media instanceof HTMLMediaElement?this.media.playbackRate:this.playbackRate;g=parseFloat(e);.5<=g&&(this.media instanceof HTMLMediaElement&&(this.media.playbackRate=g),this.playbackRate=g);break;case "currenttime":if(void 0===e)return this.media instanceof HTMLMediaElement?this.media.currentTime:0;g=parseFloat(e);if(this.media instanceof
HTMLMediaElement)b=this.duration;else return;0<=g&&g<=b&&(this.media.currentTime=g);break;case "loop":case "muted":case "controls":if(void 0===e)return this.media instanceof HTMLMediaElement?this.media[b]:this[b];this.media instanceof HTMLMediaElement&&(this.media[b]=Boolean(e));this[b]=Boolean(e);break;case "width":case "height":if(void 0===e)return this.media instanceof HTMLVideoElement?this.media[b]:0;g=parseInt(e);0<=g&&this.media instanceof HTMLVideoElement&&(this.media[b]=g);break;case "duration":return this.duration;
case "channels":return this.source instanceof MediaElementAudioSourceNode?this.source.channelCount:0}}return this};u.prototype.ready=function(a){a=String(a);try{-1!==a.indexOf("data:")||-1!==a.indexOf("blob:")?this.media.src=a:this.media.src=a+"."+this.ext}catch(e){throw Error("The designated resource cannot be loaded !!");}return this};u.prototype.start=function(a,e,b){if(this.source instanceof MediaElementAudioSourceNode&&this.media.paused){var g=this.context.currentTime;this.source.connect(this.processor);
this.connect(this.processor,e);this.media.play();a=parseFloat(a);this.media.currentTime=0<=a&&a<=this.duration?a:0;this.media.playbackRate=this.playbackRate;this.media.controls=this.controls;this.media.loop=this.loop;this.media.muted=this.muted;this.chorus.start(g);this.flanger.start(g);this.phaser.start(g);this.autopanner.start(g);this.tremolo.start(g);this.ringmodulator.start(g);this.wah.start(g);a=0;for(e=this.plugins.length;a<e;a++)this.plugins[a].plugin.start(g);this.analyser.start("time");this.analyser.start("fft");
var d=this;"[object Function]"===Object.prototype.toString.call(b)?this.processor.onaudioprocess=b:this.processor.onaudioprocess=function(a){var b=a.inputBuffer.getChannelData(0),e=a.inputBuffer.getChannelData(1),g=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);for(var n=0;n<this.bufferSize;n++)g[n]=d.vocalcanceler.start(b[n],e[n]),a[n]=d.vocalcanceler.start(e[n],b[n])}}return this};u.prototype.stop=function(){if(this.source instanceof MediaElementAudioSourceNode&&!this.media.paused){var a=
this.context.currentTime;this.media.pause();this.chorus.stop(a);this.flanger.stop(a);this.phaser.stop(a);this.autopanner.stop(a);this.tremolo.stop(a);this.ringmodulator.stop(a);this.wah.stop(a);for(var e=0,b=this.plugins.length;e<b;e++)this.plugins[e].plugin.stop(a);this.analyser.stop("time");this.analyser.stop("fft");this.processor.disconnect(0);this.processor.onaudioprocess=null}return this};u.prototype.get=function(){return this.media};u.prototype.toggle=function(a,e,b){this.media instanceof HTMLMediaElement&&
(this.media.paused?this.start(a,e,b):this.stop());return this};u.prototype.isMedia=function(){return this.media instanceof HTMLMediaElement?!0:!1};u.prototype.isSource=function(){return this.source instanceof MediaElementAudioSourceNode?!0:!1};u.prototype.isPaused=function(){return this.media instanceof HTMLMediaElement?this.media.paused:!0};u.prototype.fullscreen=function(){if(this.media instanceof HTMLVideoElement)if(this.media.webkitRequestFullscreen)this.media.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
else if(this.media.mozRequestFullScreen)this.media.mozRequestFullScreen();else if(this.media.requestFullscreen)this.media.requestFullscreen();else throw Error("Cannot change to full screen !!");return this};u.prototype.exitFullscreeen=function(){if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullscreen)document.mozCancelFullscreen();else if(document.exitFullscreen)document.exitFullscreen();else throw Error("Cannot exit from full screen !!");return this};
u.prototype.toString=function(){return"[MediaModule]"};I.prototype=Object.create(w.prototype);I.prototype.constructor=I;I.prototype.mix=function(a){Array.isArray(a)||(a=[a]);this.sources=a;for(var e=0,b=this.sources.length;e<b;e++){var g=this.sources[e];if(!(g instanceof C||g instanceof F||g instanceof y||g instanceof u))return;var d=this.context.currentTime;this.chorus.stop(d);this.flanger.stop(d);this.phaser.stop(d);this.autopanner.stop(d);this.tremolo.stop(d);this.ringmodulator.stop(d);this.wah.stop(d);
this.filter.stop(d);for(var l=0,f=this.plugins.length;l<f;l++)this.plugins[e].plugin.stop(d);g.analyser.stop("time");g.analyser.stop("fft");g.isAnalyser=!1;g.recorder.stop();g.session.close();g.processor.disconnect(0);g.processor.connect(this.processor)}this.connect(this.processor);g=this.context.currentTime;this.chorus.start(g);this.flanger.start(g);this.phaser.start(g);this.autopanner.start(g);this.tremolo.start(g);this.ringmodulator.start(g);this.wah.start(g);this.filter.start(g);e=0;for(b=this.plugins.length;e<
b;e++)this.plugins[e].plugin.start(g);this.isAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.isAnalyser=!0);var m=this;this.processor.onaudioprocess=function(b){var d=b.inputBuffer.getChannelData(0),e=b.inputBuffer.getChannelData(1),f=b.outputBuffer.getChannelData(0),g=b.outputBuffer.getChannelData(1),l=!1;b=0;for(var r=m.sources.length;10>b;b++)r=a[b],r instanceof C&&r.eg.isStop()?l=!0:r instanceof F&&r.isStop?l=!0:r instanceof y&&r.paused?l=!0:r instanceof u&&r.media.paused&&
(l=!0);if(l){d=m.context.currentTime;m.chorus.stop(d);m.flanger.stop(d);m.phaser.stop(d);m.autopanner.stop(d);m.tremolo.stop(d);m.ringmodulator.stop(d);m.wah.stop(d);m.filter.stop(d);b=0;for(r=m.plugins.length;b<r;b++)m.plugins[b].plugin.stop(d);m.analyser.stop("time");m.analyser.stop("fft");m.isAnalyser=!1;this.disconnect(0);this.onaudioprocess=null}else f.set(d),g.set(e)};return this};I.prototype.get=function(a){a=parseInt(a);return 0<=a&&a<this.sources.length?this.sources[a]:this.sources};I.prototype.toString=
function(){return"[SoundModule Mixer]"};H.prototype.setup=function(a,e){if("[object Object]"===Object.prototype.toString.call(a))for(var b in a)this.setup(b,a[b]);else b=String(a).toLowerCase(),b in this.callbacks&&"[object Function]"===Object.prototype.toString.call(e)&&(this.callbacks[b]=e);return this};H.prototype.ready=function(a,e){null!==this.source&&this.stop();this.sequences=[];this.timerids=[];this.prev=[];if(Array.isArray(a)){for(var b=0,g=a.length;b<g;b++)if(!(a[b]instanceof OscillatorNode))return;
this.source=a}else if(a instanceof OscillatorNode)this.source=[a];else if(a instanceof C||a instanceof F)this.source=a;else return;for(Array.isArray(e)||(e=[e]);0<e.length;){var d=[],l=String(e.shift()).match(/\s*(?:T\d+)\s*|\s*(?:O\d+)\s*|\s*(?:(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*\s*/gi);if(null===l){this.callbacks.error("MML","");return}for(var f=0,m=function(a,
b){var d=0;switch(b){case "C":d=3;break;case "D":d=5;break;case "E":d=7;break;case "F":d=8;break;case "G":d=10;break;case "A":d=12;break;case "B":d=14;break;case "R":return"R"}d=12*(a-1)+d;return 0<=d?d:-1},r=function(a){var b=Math.pow(2,1/12);return 0<=a?27.5*Math.pow(b,a):-1};0<l.length;){var n=l.shift().trim();if(/T\d+/i.test(n)){var q=parseInt(n.slice(1));if(0<q)q=60/q;else{this.callbacks.error("TEMPO",n);return}}else if(/O\d+/i.test(n)){var v=parseInt(n.slice(1));if(0>v){this.callbacks.error("OCTAVE",
n);return}}else if(/(?:(?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*/i.test(n)){if(void 0===q){this.callbacks.error("TEMPO",n);return}if(void 0===v){this.callbacks.error("OCTAVE",n);return}for(var u=n.match(/((?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*/i)[1],w=[],b=0,g=u.length;b<g;b++){var z=u.charAt(b),z=m.call(this,v,z.toUpperCase());
switch(u.charAt(b+1)){case "#":case "+":z++;b++;break;case "-":z--,b++}z>=w[0]&&(z-=12);if(0>z){this.callbacks.error("NOTE",n);return}w.push(z)}u=[];b=0;for(g=w.length;b<g;b++){z="R"!==w[b]?r.call(this,w[b],n):0;if(-1===z){this.callbacks.error("NOTE",n);return}u.push(z)}g=n.split("&");for(b=0;0<g.length;)switch(z=g.shift().match(/(?:[CDEFGABR][#+-]?)+((?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*)/i)[1],parseInt(z)){case 1:case 2:case 4:case 8:case 16:case 32:case 64:case 128:case 256:var y=
4/parseInt(z),b=b+(-1!==z.indexOf(".")?1.5*y*q:y*q);break;case 6:b+=2*q/3;break;case 12:b+=q/3;break;case 18:b+=2*q/9;break;case 24:b+=.5*q/3;break;case 36:b+=q/9;break;case 48:b+=.25*q/3;break;case 72:b+=.5*q/9;break;case 96:b+=.125*q/3;break;case 144:b+=.25*q/9;break;case 192:b+=.0625*q/3;break;default:this.callbacks.error("NOTE",n)}n=f;g=n+b;f+=b;d.push({indexes:w,frequencies:u,start:n,duration:b,stop:g})}}0<d.length&&(d.reverse(),this.sequences.push(d),this.timerids.push(null))}return this.sequences};
H.prototype.start=function(a,e,b){var g=parseInt(a);if(0<=g&&g<this.sequences.length){if(!Array.isArray(this.sequences[g]))return this;if(0===this.sequences[g].length)return this.stop(b),this.callbacks.ended(),this;var d=this.sequences[g].pop();if(Array.isArray(this.source)){a=0;for(var l=this.source.length;a<l;a++){var f=this.source[a],m=f.type,r=f.detune.value,f=this.context.createOscillator();f.start=f.start||f.noteOn;f.stop=f.stop||f.noteOff;f.type=m;f.frequency.value=d.frequencies[a];f.detune.value=
r;if(Array.isArray(e))for(f.connect(e[0]),a=0,l=e.length;a<l;a++)if(m=e[a],a<l-1){r=e[a+1];if(!(m instanceof AudioNode&&r instanceof AudioNode))return;m.connect(r)}else m.connect(this.context.destination);else f.connect(this.context.destination);f.start(this.context.currentTime);f.stop(this.context.currentTime+d.duration);this.source[a]=f}a=0;for(l=d.indexes.length;a<l;a++)"R"!==d.indexes[a]&&this.callbacks.start(d,a)}else if(this.source instanceof C)for(this.source.start(d.frequencies,e,b),a=0,l=
d.indexes.length;a<l;a++)"R"!==d.indexes[a]&&this.callbacks.start(d,a);else if(this.source instanceof F)for(a=0,l=d.indexes.length;a<l;a++)"R"!==d.indexes[a]&&(this.source.start(d.indexes[a],e,b),this.callbacks.start(d,a));var n=this;this.timerids[g]=v.setTimeout(function(){if(Array.isArray(n.source))for(var a=0,f=d.indexes.length;a<f;a++)"R"!==d.indexes[a]&&n.callbacks.stop(d,a);else if(n.source instanceof C)for(n.source.stop(d.frequencies,b),a=0,f=d.indexes.length;a<f;a++)"R"!==d.indexes[a]&&n.callbacks.stop(d,
a);else if(n.source instanceof F)for(a=0,f=d.indexes.length;a<f;a++)"R"!==d.indexes[a]&&(n.source.stop(d.indexes[a],b),n.callbacks.stop(d,a));n.prev=d;n.start(g,e,b);d=null},1E3*d.duration)}return this};H.prototype.stop=function(a){var e=this.prev;if(0===e.length)return this;if(Array.isArray(this.source))for(var b=0,g=e.indexes.length;b<g;b++)"R"!==e.indexes[b]&&this.callbacks.stop(e,b);else if(this.source instanceof C)for(this.source.stop(e.frequencies,a),b=0,g=e.indexes.length;b<g;b++)"R"!==e.indexes[b]&&
this.callbacks.stop(e,b);else if(this.source instanceof F)for(b=0,g=e.indexes.length;b<g;b++)"R"!==e.indexes[b]&&(this.source.stop(e.indexes[b],a),this.callbacks.stop(e,b));b=0;for(g=this.timerids.length;b<g;b++)v.clearTimeout(this.timerids[b]),this.timerids[b]=null;return this};H.prototype.get=function(a){a=parseInt(a);return 0<=a&&a<this.sequences.length?this.sequences[a]:this.sequences};H.prototype.toggle=function(a,e,b){this.isPaused()?this.start(a,e,b):this.stop();return this};H.prototype.isSequences=
function(){return Array.isArray(this.sequences[0])?!0:!1};H.prototype.isPaused=function(){for(var a=0,e=this.timerids.length;a<e;a++){var b=this.timerids[a];if(null!==b&&void 0!==b)return!1}return!0};H.prototype.download=function(a){return"data:text/plain;base64,"+v.btoa(function(a){for(var b="",g=0,d=a.length;g<d;g++)var l=a.charCodeAt(g),b=255<l?b+("&#"+l+";"):b+a.charAt(g);return b}(String(a)))};H.prototype.toString=function(){return"[MML]"};var L=new w(audiocontext),N=new C(audiocontext),W=new F(audiocontext),
X=new y(audiocontext),O=new u(audiocontext),Y=new I(audiocontext),Z=new A,$=new H(audiocontext);r=function(a,e){switch(String(a).replace(/-/g,"").toLowerCase()){case "oscillator":if(void 0===e)return N;var b=parseInt(e);if(0<=b&&b<N.sources.length)return N.sources[b];break;case "oneshot":return W;case "audio":return X;case "media":return O;case "fallback":return Z;case "mixer":return Y;case "mml":return $}};r.IS_XSOUND=M;r.FULL_MODE=G;r.SAMPLE_RATE=L.SAMPLE_RATE;r.BUFFER_SIZE=L.BUFFER_SIZE;r.NUM_INPUT=
L.NUM_INPUT;r.NUM_OUTPUT=L.NUM_OUTPUT;r.read=P;r.file=Q;r.ajax=R;r.decode=S;r.toFrequencies=T;r.convertTime=U;r.noConflict=V;r.clone=function(){var a=new C(audiocontext),e=new F(audiocontext),b=new y(audiocontext),g=new u(audiocontext),d=new A,l=new I(audiocontext),f=new H(audiocontext);return function(m,r){switch(String(m).replace(/-/g,"").toLowerCase()){case "oscillator":if(void 0===r)return a;var n=parseInt(r);if(0<=n&&n<a.sources.length)return a.sources[n];break;case "oneshot":return e;case "audio":return b;
case "media":return g;case "fallback":return d;case "mixer":return l;case "mml":return f}}};r.free=function(a){(a instanceof w||a instanceof H||a instanceof A)&&delete a};r.get=function(){return audiocontext};r.getCurrentTime=function(){return audiocontext.currentTime}}else{var O=new A;r=function(){return O};r.IS_XSOUND=M;r.SAMPLE_RATE=null;r.BUFFER_SIZE=null;r.NUM_INPUT=null;r.NUM_OUTPUT=null;r.read=P;r.file=Q;r.ajax=R;r.decode=S;r.toFrequencies=T;r.convertTime=U;r.noConflict=V;r.get=function(){return null};
r.getCurrentTime=function(){return 0};r.clone=function(){var a=new A;return function(){return a}}}r.toString=function(){return"[XSound]"};v.XSound=r;v.X=r})(window);