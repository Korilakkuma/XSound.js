/** 
 * xsound.min.js
 * @fileoverview Web Audio API Library
 *
 * Copyright 2012, 2013@Tomohiro IKEDA
 * Released under the MIT license
 */
(function(v){function B(){this.media=null;this.ex="";this.duration=0;this.playbackRate=this.volume=1;this.muted=this.loop=this.controls=!1;this.callbacks={}}function N(a){this.isActive=Boolean(a)}function s(a,b){function d(m){this.listener=m.listener;this.dopplerFactor=1;this.speedOfSound=343.3;this.positions={x:0,y:0,z:0};this.fronts={x:0,y:0,z:-1};this.ups={x:0,y:1,z:0};this.velocities={x:0,y:0,z:0};this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z);this.listener.setOrientation(this.fronts.x,
this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z);this.listener.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z)}function f(m){function a(m){this.SAMPLE_RATE=m;this.drawType="";this.svgParent=this.svg=this.context=this.canvas=null;this.interval=1E3;this.timerid=null;this.styles={shape:"line",grad:[{offset:0,color:"rgba(0, 128, 255, 1.0)"},{offset:1,color:"rgba(0, 0, 255, 1.0)"}],wave:"rgba(0, 0, 255, 1.0)",grid:"rgba(255, 0, 0, 1.0)",text:"rgba(255, 255, 255, 1.0)",font:"13px Arial",
width:1.5,cap:"round",join:"miter",top:15,right:15,bottom:15,left:15}}function c(m){a.call(this,m);this.isActive=Boolean(!1);this.savedImage=null;this.length=0;this.currentTime="rgba(255, 255, 255, 1.0)";this.plotinterval=0.0625;this.textinterval=60}function e(m){a.call(this,m);this.isActive=Boolean(!1);this.textinterval=0.005}function b(m){a.call(this,m);this.isActive=Boolean(!1);this.type="uint";this.size=256;this.textinterval=1E3}this.analyser=m.createAnalyser();this.input=m.createGain();this.output=
m.createGain();this.input.connect(this.analyser);this.analyser.connect(this.output);a.prototype=implement(N.prototype);a.prototype.constructor=a;c.prototype=w(a.prototype);e.prototype=w(a.prototype);b.prototype=w(a.prototype);c.prototype.constructor=c;e.prototype.constructor=e;b.prototype.constructor=b;this.timeAllL=new c(m.sampleRate);this.timeAllR=new c(m.sampleRate);this.time=new e(m.sampleRate);this.fft=new b(m.sampleRate);this.analyser.fftSize=2048;this.analyser.minDecibels=-100;this.analyser.maxDecibels=
-30;this.analyser.smoothingTimeConstant=0.8;a.prototype.setup=function(m,a,c){switch(String(m).toLowerCase()){case "canvas":this.drawType="canvas";this.canvas=document.getElementById(String(a));this.canvas instanceof HTMLCanvasElement?this.context=this.canvas.getContext("2d"):g(this+" setup() : The designated canvas ID does not exists !!");break;case "svg":this.drawType="svg";this.svg=document.getElementById(String(a));this.svg instanceof SVGElement?(this.svgParent=document.getElementById(String(c)),
this.svgParent instanceof HTMLElement||g(this+" setup() : The designated parent node ID does not exists !!")):g(this+" setup() : The designated SVG ID does not exists !!");break;default:g(this+' setup() : The 1st argument is either "canvas" or "svg" !!')}return this};a.prototype.param=function(m,a){var c=String(m).replace(/-/g,"").toLowerCase();switch(c){case "interval":if(void 0===a)return this.interval;var e=parseFloat(a);0<=e?this.interval=e:g(this+' param() : The range of "'+m+'" is greater than or equal 0 !!');
break;case "shape":if(void 0===a)return this.styles.shape;e=String(a).toLowerCase();"line"===e||"rect"===e?this.styles.shape="gradient"!==this.styles.wave?e:"rect":g(this+' param() : The type of "'+m+'" is either "line" or "rect" !!');break;case "grad":if(void 0===a)return this.styles.grad;Array.isArray(a)||(a=[a]);for(var c=!1,e=0,b=a.length;e<b;e++){var t=a[e];if("offset"in t&&"color"in t){if(t=parseFloat(t.offset),isNaN(t)||0>t||1<t){c=!0;break}}else{c=!0;break}}c?g(this+' param() : The type of "'+
m+'" is object\'s array that has 2 properties ("offset", "color") !! The range of "offset" is between 0 and 1 !!'):this.styles.grad=a;break;case "wave":case "grid":case "text":case "font":case "cap":case "join":if(void 0===a)return this.styles[c];"string"!==typeof a?g(this+' param() : The type of "'+m+'" is string type !!'):("wave"===c&&"gradient"===a&&(this.styles.shape="rect"),this.styles[c]="font"===c?a:a.toLowerCase());break;case "width":case "top":case "right":case "bottom":case "left":if(void 0===
a)return this.styles[c];e="width"===c?parseFloat(a):parseInt(a);0<=e?this.styles[c]=e:g(this+' param() : The range of "'+m+'" is greater than or equal 0 !!')}};a.prototype.start=function(m,a,c){switch(this.drawType){case "canvas":this.drawToCanvas(m,a,c);break;case "svg":this.drawToSVG(m,a,c)}return this};a.prototype.download=function(){switch(this.drawType){case "canvas":return this.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");case "svg":return this.svgParent.innerHTML;
default:return this}};a.prototype.drawToCanvas=function(m){};a.prototype.drawToSVG=function(m){};a.prototype.toString=function(){return"SoundModule Draw"};c.prototype.param=function(m,c){if("[object Object]"===Object.prototype.toString.call(m))for(var e in m)this.param(e,m[e]);else{e=String(m).replace(/-/g,"").toLowerCase();var b=a.prototype.param.call(this,e,c);if(void 0!==b)return b;switch(e){case "currenttime":if(void 0===c)return this.currentTime;"string"!==typeof c?g(this+' param() : The type of "'+
m+'" is string type !!'):this.currentTime=c.toLowerCase();break;case "plotinterval":case "textinterval":if(void 0===c)return this[e];b=parseFloat(c);0<b?this[e]=b:g(this+' param() : The range of "'+m+'" is greater than 0 !!');break;default:e in this.styles||g(this+' param() : The designated property ("'+m+'") does not exist in accessible properties !!')}}return this};c.prototype.drawToCanvas=function(m){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var a=this.context,c=
this.canvas.width,e=this.canvas.height,b=c-(this.styles.left+this.styles.right),t=e-(this.styles.top+this.styles.bottom),d=Math.floor(t/2)+this.styles.top,k=0,f=0,h="",h=Math.floor(this.plotinterval*this.SAMPLE_RATE),g=Math.floor(this.textinterval*this.SAMPLE_RATE);a.clearRect(0,0,c,e);switch(this.styles.shape){case "line":a.strokeStyle=this.styles.wave;a.lineWidth=this.styles.width;a.lineCap=this.styles.cap;a.lineJoin=this.styles.join;a.beginPath();for(var C=0,u=m.length;C<u;C++)0===C%h&&(k=Math.floor(C/
u*b)+this.styles.left,f=Math.floor(t/2*(1-m[C]))+this.styles.top,0===C?a.moveTo(k,f):a.lineTo(k,f));a.stroke();break;case "rect":for("gradient"!==this.styles.wave&&(a.fillStyle=this.styles.wave),C=0,u=m.length;C<u;C++)if(0===C%h){k=Math.floor(C/u*b)+this.styles.left;f=-1*Math.floor(t/2*m[C]);if("gradient"===this.styles.wave){for(var l=t/2+this.styles.top,l=a.createLinearGradient(0,l,0,l+f),n=0,p=this.styles.grad.length;n<p;n++){var q=this.styles.grad[n];l.addColorStop(q.offset,q.color)}a.fillStyle=
l}a.fillRect(k,d,this.styles.width,f)}}if("none"!==this.styles.grid||"none"!==this.styles.text){C=0;for(u=m.length;C<u;C++)0===C%g&&(k=Math.floor(C/u*b)+this.styles.left,h=Math.floor(C/this.SAMPLE_RATE)+" s","none"!==this.styles.grid&&(a.fillStyle=this.styles.grid,a.fillRect(k,this.styles.top,1,t)),"none"!==this.styles.text&&(a.fillStyle=this.styles.text,a.font=this.styles.font,a.fillText(h,k-a.measureText(h).width/2,e)));d=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];C=0;for(u=d.length;C<u;C++)h=d[C],
k=Math.floor(c-a.measureText(h).width),f=Math.floor((1-parseFloat(h.trim()))*(t/2))+this.styles.top,"none"!==this.styles.grid&&(a.fillStyle=this.styles.grid,a.fillRect(this.styles.left,f,b,1)),f-=parseInt(a.font.match(/\s*(\d+)px.*/)[1]/4),"none"!==this.styles.text&&(a.fillStyle=this.styles.text,a.font=this.styles.font,a.fillText(h,k,f))}this.savedImage=a.getImageData(0,0,c,e);this.length=m.length;a.fillStyle=this.currentTime;a.fillRect(this.styles.left,this.styles.top,1,t);return this};c.prototype.drawToSVG=
function(m){if(!(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return this;var a=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>",c=this.svg.getAttribute("width"),e=this.svg.getAttribute("height"),b=c-(this.styles.left+this.styles.right),t=e-(this.styles.top+this.styles.bottom),d=Math.floor(t/2)+this.styles.top,k=0,f=0,h="",h=Math.floor(this.plotinterval*this.SAMPLE_RATE),u=Math.floor(this.textinterval*this.SAMPLE_RATE),g="";switch(this.styles.shape){case "line":g+=
"stroke : "+this.styles.wave+"; ";g=g+"fill : none; "+("stroke-width : "+this.styles.width+"; ");g+="stroke-linecap : "+this.styles.cap+"; ";g+="stroke-linejoin : "+this.styles.join+";";break;case "rect":if("gradient"===this.styles.wave){var l;l='<defs><linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var n=0,p=this.styles.grad.length;n<p;n++){var q=this.styles.grad[n];l+='<stop offset="'+q.offset+'" stop-color="'+q.color+'" />'}l+="</linearGradient>";l+="</defs>";g+=
"stroke : none; ";g+="fill : url(#svg-linear-gradient); "}else g+="stroke : none; ",g+="fill : "+this.styles.wave+"; ";g+="stroke-width : 0;"}var q="stroke : none; "+("fill : "+this.styles.grid+"; "),q=q+"stroke-width : 0;",p=this.styles.font.match(/\s*(\d+)px (.*)/),n=p[2],x=p[1],r;r="stroke : none; "+("fill : "+this.styles.text+"; ");r+="font-family : "+n+"; ";r+="font-size : "+x+";";var D;D="stroke : none; "+("fill : "+this.currentTime+"; ");D+="stroke-width : 0;";this.svgParent.innerHTML=a;a=
this.svgParent.innerHTML.replace("</svg>","");"gradient"===this.styles.wave&&(a+=l);switch(this.styles.shape){case "line":a+='<path style="'+g+'" d="';n=0;for(p=m.length;n<p;n++)0===n%h&&(k=Math.floor(n/p*b)+this.styles.left,f=Math.floor(t/2*(1-m[n]))+this.styles.top,0===n?a+="M"+k+" "+f:(a+=" ",a+="L"+k+" "+f));a+='" />';break;case "rect":for(n=0,p=m.length;n<p;n++)0===n%h&&(k=Math.floor(n/p*b)+this.styles.left,f=Math.floor(t/2*m[n]),a+=0>f?'<rect style="'+g+'" x="'+k+'" y="'+d+'" width="'+this.styles.width+
'" height="'+-f+'" />':'<rect style="'+g+'" x="'+k+'" y="'+d+'" width="'+this.styles.width+'" height="'+f+'" transform="translate('+this.styles.width+" 0) rotate(180 "+k+" "+d+')" />')}if("none"!==this.styles.grid||"none"!==this.styles.text){d=document.createElement("canvas").getContext("2d");n=0;for(p=m.length;n<p;n++)0===n%u&&(k=Math.floor(n/p*b)+this.styles.left,h=Math.floor(n/this.SAMPLE_RATE)+" s","none"!==this.styles.grid&&(a+='<rect style="'+q+'" x="'+k+'" y="'+this.styles.top+'" width="1" height="'+
t+'" />'),k-=Math.floor(d.measureText(h).width/2),"none"!==this.styles.text&&(a+='<text style="'+r+'" x="'+k+'" y="'+e+'">'+h+"</text>"));e=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];n=0;for(p=e.length;n<p;n++)h=e[n],k=c-Math.floor(1.5*d.measureText(h).width),f=Math.floor((1-parseFloat(h.trim()))*(t/2))+this.styles.top,"none"!==this.styles.grid&&(a+='<rect style="'+q+'" x="'+this.styles.left+'" y="'+f+'" width="'+b+'" height="1" />'),f-=Math.floor(parseInt(x)/4),"none"!==this.styles.text&&(a+='<text style="'+
r+'" x="'+k+'" y="'+f+'">'+h+"</text>")}a+='<rect class="svg-current-time" style="'+D+'" x="'+this.styles.left+'" y="'+this.styles.top+'" width="1" height="'+t+'" />';a+="</svg>";this.savedImage=this.svgParent.innerHTML=a;this.length=m.length;return this};c.prototype.update=function(a){switch(this.drawType){case "canvas":if(this.canvas instanceof HTMLCanvasElement&&this.isActive)break;else return;case "svg":if(!(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return}a=
parseFloat(a);if(isNaN(a)||0>a)g(this+" update() : The 1st argument is number type greater than 0 !!");else{var m=0,c=0,e=0,b=0,e=0;switch(this.drawType){case "canvas":if(this.savedImage instanceof ImageData){var t=this.context,m=this.canvas.width,c=this.canvas.height,e=m-(this.styles.left+this.styles.right),b=c-(this.styles.top+this.styles.bottom),e=Math.floor(a*this.SAMPLE_RATE/this.length*e)+this.styles.left;t.clearRect(0,0,m,c);t.putImageData(this.savedImage,0,0);t.fillStyle=this.currentTime;
t.fillRect(e,this.styles.top,1,b)}break;case "svg":c=this.svgParent.getElementsByClassName("svg-current-time")[0],c instanceof SVGElement&&(m=this.svg.getAttribute("width"),this.svg.getAttribute("height"),e=m-(this.styles.left+this.styles.right),e=Math.floor(a*this.SAMPLE_RATE/this.length*e),c.setAttribute("transform","translate("+e+" 0)"))}return this}};c.prototype.drag=function(a){var m=null,c=!0;switch(this.drawType){case "canvas":if(this.canvas instanceof HTMLCanvasElement&&this.isActive){m=this.canvas;
c=!0;break}else return;case "svg":if(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive)m=this.svgParent,c=!1;else return}var e="",t="",b="";/iPhone|iPad|iPod|Android/.test(navigator.userAgent)?(e="touchstart",t="touchmove",b="touchend"):(e="mousedown",t="mousemove",b="mouseup");var d=function(m){var c=0,e=0;switch(this.drawType){case "canvas":c=this.canvas.offsetLeft;e=this.canvas.width;break;case "svg":c=this.svgParent.offsetLeft,e=this.svg.getAttribute("width")}m-=
c+this.styles.left;e-=this.styles.left+this.styles.right;0>m&&(m=0);m>e&&(m=e);e=m/e*this.length/this.SAMPLE_RATE;this.update(e);"[object Function]"===Object.prototype.toString.call(a)&&a(e)},k=function(a){if(a.pageX)return a.pageX;if(a.touches[0])return a.touches[0].pageX},f=!1,h=this;m.addEventListener(e,function(a){null!==h.savedImage&&(d.call(h,k(a)),f=!0)},c);m.addEventListener(t,function(a){a.preventDefault();f&&null!==h.savedImage&&d.call(h,k(a))},c);v.addEventListener(b,function(a){f=!1},
!0);return this};c.prototype.toString=function(){return"SoundModule Analyser TimeAll"};e.prototype.param=function(m,c){if("[object Object]"===Object.prototype.toString.call(m))for(var e in m)this.param(e,m[e]);else{e=String(m).replace(/-/g,"").toLowerCase();var b=a.prototype.param.call(this,e,c);if(void 0!==b)return b;switch(e){case "textinterval":if(void 0===c)return this.textinterval;e=parseFloat(c);0<e?this.textinterval=e:g(this+' param() : The range of "'+m+'" is greater than 0 !!');break;default:"interval"===
e||e in this.styles||g(this+' param() : The designated property ("'+m+'") does not exist in accessible properties !!')}}return this};e.prototype.drawToCanvas=function(a){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var m=this.context,c=this.canvas.width,e=this.canvas.height,b=c-(this.styles.left+this.styles.right),t=e-(this.styles.top+this.styles.bottom),d=Math.floor(t/2)+this.styles.top,k=0,f=0,h="",g=Math.floor(this.textinterval*this.SAMPLE_RATE);m.clearRect(0,0,c,e);
switch(this.styles.shape){case "line":m.strokeStyle=this.styles.wave;m.lineWidth=this.styles.width;m.lineCap=this.styles.cap;m.lineJoin=this.styles.join;m.beginPath();for(var u=0,l=a.length;u<l;u++)k=Math.floor(u/l*b)+this.styles.left,f=Math.floor((1-a[u]/255)*t)+this.styles.top,0===u?m.moveTo(k,f):m.lineTo(k,f);m.stroke();break;case "rect":for("gradient"!==this.styles.wave&&(m.fillStyle=this.styles.wave),u=0,l=a.length;u<l;u++){k=Math.floor(u/l*b)+this.styles.left;f=Math.floor((0.5-a[u]/255)*t);
if("gradient"===this.styles.wave){for(var h=t/2+this.styles.top,h=m.createLinearGradient(0,h,0,h+f),n=0,p=this.styles.grad.length;n<p;n++){var q=this.styles.grad[n];h.addColorStop(q.offset,q.color)}m.fillStyle=h}m.fillRect(k,d,this.styles.width,f)}}if("none"!==this.styles.grid||"none"!==this.styles.text){u=0;for(l=a.length;u<l;u++)0===u%g&&(k=Math.floor(u/l*b)+this.styles.left,h=Math.floor(u/this.SAMPLE_RATE*1E3)+" ms","none"!==this.styles.grid&&(m.fillStyle=this.styles.grid,m.fillRect(k,this.styles.top,
1,t)),"none"!==this.styles.text&&(m.fillStyle=this.styles.text,m.font=this.styles.font,m.fillText(h,k-m.measureText(h).width/2,e)));a=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];u=0;for(l=a.length;u<l;u++)h=a[u],k=Math.floor(c-m.measureText(h).width),f=Math.floor((1-parseFloat(h.trim()))*(t/2))+this.styles.top,"none"!==this.styles.grid&&(m.fillStyle=this.styles.grid,m.fillRect(this.styles.left,f,b,1)),f-=parseInt(m.font.match(/\s*(\d+)px.*/)[1]/4),"none"!==this.styles.text&&(m.fillStyle=this.styles.text,
m.font=this.styles.font,m.fillText(h,k,f))}return this};e.prototype.drawToSVG=function(m){if(!(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return this;var a=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>",c=this.svg.getAttribute("width"),e=this.svg.getAttribute("height"),t=c-(this.styles.left+this.styles.right),b=e-(this.styles.top+this.styles.bottom),d=Math.floor(b/2)+this.styles.top,k=0,f=0,h="",u=Math.floor(this.textinterval*this.SAMPLE_RATE),
h="";switch(this.styles.shape){case "line":h+="stroke : "+this.styles.wave+"; ";h=h+"fill : none; "+("stroke-width : "+this.styles.width+"; ");h+="stroke-linecap : "+this.styles.cap+"; ";h+="stroke-linejoin : "+this.styles.join+";";break;case "rect":if("gradient"===this.styles.wave){var g;g='<defs><linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var l=0,n=this.styles.grad.length;l<n;l++){var p=this.styles.grad[l];g+='<stop offset="'+p.offset+'" stop-color="'+p.color+
'" />'}g+="</linearGradient>";g+="</defs>";h+="stroke : none; ";h+="fill : url(#svg-linear-gradient); "}else h+="stroke : none; ",h+="fill : "+this.styles.wave+"; ";h+="stroke-width : 0;"}var p="stroke : none; "+("fill : "+this.styles.grid+"; "),p=p+"stroke-width : 0;",n=this.styles.font.match(/\s*(\d+)px (.*)/),l=n[2],q=n[1],r;r="stroke : none; "+("fill : "+this.styles.text+"; ");r+="font-family : "+l+"; ";r+="font-size : "+q+";";this.svgParent.innerHTML=a;a=this.svgParent.innerHTML.replace("</svg>",
"");"gradient"===this.styles.wave&&(a+=g);switch(this.styles.shape){case "line":a+='<path style="'+h+'" d="';l=0;for(n=m.length;l<n;l++)k=Math.floor(l/n*t)+this.styles.left,f=Math.floor((1-m[l]/255)*b)+this.styles.top,0===l?a+="M"+k+" "+f:(a+=" ",a+="L"+k+" "+f);a+='" />';break;case "rect":for(l=0,n=m.length;l<n;l++)k=Math.floor(l/n*t)+this.styles.left,f=Math.floor((m[l]/255-0.5)*b),a+=0>f?'<rect style="'+h+'" x="'+k+'" y="'+d+'" width="'+this.styles.width+'" height="'+-f+'" />':'<rect style="'+h+
'" x="'+k+'" y="'+d+'" width="'+this.styles.width+'" height="'+f+'" transform="translate('+this.styles.width+" 0) rotate(180 "+k+" "+d+')" />'}if("none"!==this.styles.grid||"none"!==this.styles.text){d=document.createElement("canvas").getContext("2d");l=0;for(n=m.length;l<n;l++)0===l%u&&(k=Math.floor(l/n*t)+this.styles.left,h=Math.floor(l/this.SAMPLE_RATE*1E3)+" ms","none"!==this.styles.grid&&(a+='<rect style="'+p+'" x="'+k+'" y="'+this.styles.top+'" width="1" height="'+b+'" />'),k-=Math.floor(d.measureText(h).width/
2),"none"!==this.styles.text&&(a+='<text style="'+r+'" x="'+k+'" y="'+e+'">'+h+"</text>"));m=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];l=0;for(n=m.length;l<n;l++)h=m[l],k=c-Math.floor(1.5*d.measureText(h).width),f=Math.floor((1-parseFloat(h.trim()))*(b/2))+this.styles.top,"none"!==this.styles.grid&&(a+='<rect style="'+p+'" x="'+this.styles.left+'" y="'+f+'" width="'+t+'" height="1" />'),f-=Math.floor(parseInt(q)/4),"none"!==this.styles.text&&(a+='<text style="'+r+'" x="'+k+'" y="'+f+'">'+h+"</text>")}this.svgParent.innerHTML=
a+"</svg>";return this};e.prototype.toString=function(){return"SoundModule Analyser Time"};b.prototype.param=function(m,c){if("[object Object]"===Object.prototype.toString.call(m))for(var e in m)this.param(e,m[e]);else{e=String(m).replace(/-/g,"").toLowerCase();var b=a.prototype.param.call(this,e,c);if(void 0!==b)return b;switch(e){case "type":if(void 0===c)return this.type;e=String(c).toLowerCase();"uint"===e||"float"===e?this.type=e:g(this+' param() : The value of "'+m+'" is either "uint" or "float" !!');
break;case "size":if(void 0===c)return this.size;e=parseFloat(c);0<=e&&1024>=e?this.size=e:g(this+' param() : The range of "'+m+'" is between 0 and 1024 !!');break;case "textinterval":if(void 0===c)return this.textinterval;e=parseFloat(c);0<e?this.textinterval=e:g(this+' param() : The range of "'+m+'" is greater than 0 !!');break;default:"interval"===e||e in this.styles||g(this+' param() : The designated property ("'+m+'") does not exist in accessible properties !!')}}return this};b.prototype.drawToCanvas=
function(m,a,c){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var e=parseFloat(a),b=parseFloat(c),t=b-e;c=this.context;a=this.canvas.width;var k=this.canvas.height,d=a-(this.styles.left+this.styles.right),h=k-(this.styles.top+this.styles.bottom),f=0,l=0,g="",u=this.size>m.length?m.length:this.size,n=Math.floor(this.textinterval/(this.SAMPLE_RATE/(2*m.length)));c.clearRect(0,0,a,k);switch(this.type){case "float":c.strokeStyle="gradient"!==this.styles.wave?this.styles.wave:
"rgba(0, 0, 255, 1.0)";c.lineWidth=this.styles.width;c.lineCap=this.styles.cap;c.lineJoin=this.styles.join;c.beginPath();for(var p=0;p<u;p++)f=Math.floor(p/u*d)+this.styles.left,l=Math.abs(m[p]-b)*(h/t)+this.styles.top,0===p?c.moveTo(f,l):c.lineTo(f,l);c.stroke();break;default:switch(this.styles.shape){case "line":c.strokeStyle=this.styles.wave;c.lineWidth=this.styles.width;c.lineCap=this.styles.cap;c.lineJoin=this.styles.join;c.beginPath();for(p=0;p<u;p++)f=Math.floor(p/u*d)+this.styles.left,l=Math.floor((1-
m[p]/255)*h)+this.styles.top,0===p?c.moveTo(f,l):c.lineTo(f,l);c.stroke();break;case "rect":for("gradient"!==this.styles.wave&&(c.fillStyle=this.styles.wave),p=0;p<u;p++){f=Math.floor(p/u*d)+this.styles.left;l=-1*Math.floor(m[p]/255*h);if("gradient"===this.styles.wave){for(var g=h+this.styles.top,g=c.createLinearGradient(0,g,0,g+l),q=0,r=this.styles.grad.length;q<r;q++){var x=this.styles.grad[q];g.addColorStop(x.offset,x.color)}c.fillStyle=g}c.fillRect(f,h+this.styles.top,this.styles.width,l)}}}if("none"!==
this.styles.grid||"none"!==this.styles.text){for(p=m=0;p<u;p++)0===p%n&&(f=Math.floor(p/u*d)+this.styles.left,m=Math.floor(p/n*this.textinterval),g=1E3>m?m+" Hz":String(m/1E3).slice(0,3)+" kHz","none"!==this.styles.grid&&(c.fillStyle=this.styles.grid,c.fillRect(f,this.styles.top,1,h)),"none"!==this.styles.text&&(c.fillStyle=this.styles.text,c.font=this.styles.font,c.fillText(g,f-c.measureText(g).width/2,k)));switch(this.type){case "float":for(p=e;p<=b;p+=10)g=p+"dB",f=a-Math.floor(c.measureText(g).width),
l=Math.floor(-1*(p-b)/t*h)+this.styles.top,"none"!==this.styles.grid&&(c.fillStyle=this.styles.grid,c.fillRect(this.styles.left,l,d,1)),l-=parseInt(c.font.match(/\s*(\d+)px.*/)[1]/4),"none"!==this.styles.text&&(c.fillStyle=this.styles.text,c.font=this.styles.font,c.fillText(g,f,l));break;default:for(m=["0.00","0.25","0.50","0.75","1.00"],p=0,e=m.length;p<e;p++)g=m[p],f=a-Math.floor(c.measureText(g).width),l=(1-parseFloat(g))*h+this.styles.top,"none"!==this.styles.grid&&(c.fillStyle=this.styles.grid,
c.fillRect(this.styles.left,l,d,1)),l-=parseInt(c.font.match(/\s*(\d+)px.*/)[1]/4),"none"!==this.styles.text&&(c.fillStyle=this.styles.text,c.font=this.styles.font,c.fillText(g,f,l))}}return this};b.prototype.drawToSVG=function(m,a,c){if(!(this.svg instanceof SVGElement&&this.svgParent instanceof HTMLElement&&this.isActive))return this;a=parseFloat(a);var e=parseFloat(c),b=e-a;c=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>";var t=this.svg.getAttribute("width"),d=this.svg.getAttribute("height"),
k=t-(this.styles.left+this.styles.right),f=d-(this.styles.top+this.styles.bottom),h=0,l=0,g="",u=this.size>m.length?m.length:this.size,n=Math.floor(this.textinterval/(this.SAMPLE_RATE/(2*m.length))),g="";switch(this.styles.shape){case "line":g+="stroke : "+this.styles.wave+"; ";g=g+"fill : none; "+("stroke-width : "+this.styles.width+"; ");g+="stroke-linecap : "+this.styles.cap+"; ";g+="stroke-linejoin : "+this.styles.join+";";break;case "rect":if("uint"===this.type&&"gradient"===this.styles.wave){var p;
p='<defs><linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var q=0,r=this.styles.grad.length;q<r;q++){var x=this.styles.grad[q];p+='<stop offset="'+x.offset+'" stop-color="'+x.color+'" />'}p+="</linearGradient>";p+="</defs>";g+="stroke : none; ";g+="fill : url(#svg-linear-gradient); ";g+="stroke-width : 0;"}else"uint"===this.type&&"gradient"!==this.styles.wave?(g+="stroke : none; ",g+="fill : "+this.styles.wave+"; ",g+="stroke-width : 0;"):"uint"!==this.type&&(g+="stroke : rgba(0, 0, 255, 1.0); ",
g+="fill : none; ",g+="stroke-width : "+this.styles.width+"; ",g+="stroke-linecap : "+this.styles.cap+"; ",g+="stroke-linejoin : "+this.styles.join+";")}var x="stroke : none; "+("fill : "+this.styles.grid+"; "),x=x+"stroke-width : 0;",D=this.styles.font.match(/\s*(\d+)px (.*)/),q=D[2],D=D[1],y;y="stroke : none; "+("fill : "+this.styles.text+"; ");y+="font-family : "+q+"; ";y+="font-size : "+D+";";this.svgParent.innerHTML=c;c=this.svgParent.innerHTML.replace("</svg>","");"uint"===this.type&&"gradient"===
this.styles.wave&&(c+=p);switch(this.type){case "float":c+='<path style="'+g+'" d="';for(q=0;q<u;q++)h=Math.floor(q/u*k)+this.styles.left,l=Math.floor(f/b*(m[q]-e)*-1)+this.styles.top,0===q?c+="M"+h+" "+l:(c+=" ",c+="L"+h+" "+l);c+='" />';break;default:switch(this.styles.shape){case "line":c+='<path style="'+g+'" d="';for(q=0;q<u;q++)h=Math.floor(q/u*k)+this.styles.left,l=Math.floor((1-m[q]/255)*f)+this.styles.top,0===q?c+="M"+h+" "+l:(c+=" ",c+="L"+h+" "+l);c+='" />';break;case "rect":for(q=0;q<
u;q++)h=Math.floor(q/u*k)+this.styles.left,l=Math.floor(m[q]/255*f),c+='<rect style="'+g+'" x="'+h+'" y="'+(this.styles.top+f)+'" width="'+this.styles.width+'" height="'+l+'" transform="translate('+this.styles.width+" 0) rotate(180 "+h+" "+(this.styles.top+f)+')" />'}}if("none"!==this.styles.grid||"none"!==this.styles.text){m=document.createElement("canvas").getContext("2d");for(q=p=0;q<u;q++)0===q%n&&(h=Math.floor(q/u*k)+this.styles.left,p=Math.floor(q/n*this.textinterval),g=1E3>p?p+" Hz":String(p/
1E3).slice(0,3)+" kHz","none"!==this.styles.grid&&(c+='<rect style="'+x+'" x="'+h+'" y="'+this.styles.top+'" width="1" height="'+f+'" />'),h-=Math.floor(m.measureText(g).width/2),"none"!==this.styles.text&&(c+='<text style="'+y+'" x="'+h+'" y="'+d+'">'+g+"</text>"));switch(this.type){case "float":for(q=a;q<=e;q+=10)g=q+"dB",h=t-Math.floor(1.5*m.measureText(g).width),l=Math.floor(-1*(q-e)/b*f)+this.styles.top,"none"!==this.styles.grid&&(c+='<rect style="'+x+'" x="'+this.styles.left+'" y="'+l+'" width="'+
k+'" height="1" />'),l-=Math.floor(parseInt(D)/4),"none"!==this.styles.text&&(c+='<text style="'+y+'" x="'+h+'" y="'+l+'">'+g+"</text>");break;default:for(a=["0.00","0.25","0.50","0.75","1.00"],q=0,r=a.length;q<r;q++)g=a[q],h=t-Math.floor(1.5*m.measureText(g).width),l=(1-parseFloat(g))*f+this.styles.top,"none"!==this.styles.grid&&(c+='<rect style="'+x+'" x="'+this.styles.left+'" y="'+l+'" width="'+k+'" height="1" />'),l-=Math.floor(parseInt(D)/4),"none"!==this.styles.text&&(c+='<text style="'+y+'" x="'+
h+'" y="'+l+'">'+g+"</text>")}}this.svgParent.innerHTML=c+"</svg>";return this};b.prototype.toString=function(){return"SoundModule Analyser FFT"}}function k(m,a,c,e){this.SAMPLE_RATE=m.sampleRate;this.context=m;this.processor=m.createScriptProcessor(a,c,e);this.mixLs=[];this.mixRs=[];this.trackLs=[];this.trackRs=[];this.numtrack=0;this.activeTrack=-1;this.paused=!0;this.gainR=this.gainL=1}function l(m,a,c,e,b){this.isActive=Boolean(!1);this.context=m;this.analyser=b;this.sender=m.createScriptProcessor(2048>
a?a:2048,c,e);this.receiver=m.createScriptProcessor(2048>a?a:2048,c,e);this.websocket=null;this.paused=!0}function h(m,a){this.isActive=Boolean(!0);this.context=m;this.input=m.createGain();this.output=m.createGain();this.lfo=m.createOscillator();this.depth=m.createGain();this.rate=this.lfo.frequency;this.processor=m.createScriptProcessor(a,1,2);this.lfo.start=this.lfo.start||this.lfo.noteOn;this.lfo.stop=this.lfo.stop||this.lfo.noteOff;this.values={};this.isStart=!1}function n(m,a){h.call(this,m,
a);this.compressor=m.createDynamicsCompressor();this.input.connect(this.compressor);this.compressor.connect(this.output);this.compressor.threshold.value=-24;this.compressor.knee.value=30;this.compressor.ratio.value=12;this.compressor.attack.value=0.003;this.compressor.release.value=0.25}function p(m,a){h.call(this,m,a);this.distortion=m.createWaveShaper();this.clean=m.createGain();this.drive=m.createGain();this.size=256;this.createCurve=function(a,m){if(0<a&&1>a){for(var b=new Float32Array(m),t=2*
a/(1-a),h=0;h<m;h++){var k=2*(h-0)/(m-0)+-1;b[h]=(1+t)*k/(1+t*Math.abs(k))}this.distortion.curve=b}else this.distortion.curve=null};this.input.connect(this.clean);this.clean.connect(this.output);this.input.connect(this.distortion);this.distortion.connect(this.drive);this.drive.connect(this.output);this.clean.gain.value=1;this.drive.gain.value=0}function D(a,b){h.call(this,a,b);this.lowpass=a.createBiquadFilter();this.mix=a.createGain();this.lowpass.LOWPASS=this.lowpass.LOWPASS||0;this.input.connect(this.output);
this.input.connect(this.lowpass);this.lowpass.connect(this.mix);this.mix.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.lowpass.frequency);this.lowpass.type="[object String]"===Object.prototype.toString.call(this.lowpass.type)?"lowpass":this.lowpass.LOWPASS;this.lowpass.frequency.value=500;this.lowpass.gain.value=0;this.lowpass.Q.value=1;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0}function x(a,b){h.call(this,a,b);this.bass=a.createBiquadFilter();this.middle=
a.createBiquadFilter();this.treble=a.createBiquadFilter();this.presence=a.createBiquadFilter();this.bass.LOWSHELF=this.bass.LOWSHELF||3;this.middle.PEAKING=this.middle.PEAKING||5;this.treble.HIGHSHELF=this.treble.HIGHSHELF||4;this.presence.HIGHSHELF=this.presence.HIGHSHELF||4;this.input.connect(this.bass);this.bass.connect(this.middle);this.middle.connect(this.treble);this.treble.connect(this.presence);this.presence.connect(this.output);this.bass.type="[object String]"===Object.prototype.toString.call(this.bass.type)?
"lowshelf":this.bass.LOWSHELF;this.middle.type="[object String]"===Object.prototype.toString.call(this.middle.type)?"peaking":this.middle.PEAKING;this.treble.type="[object String]"===Object.prototype.toString.call(this.treble.type)?"highshelf":this.treble.HIGHSHELF;this.presence.type="[object String]"===Object.prototype.toString.call(this.presence.type)?"highshelf":this.presence.HIGHSHELF;this.bass.frequency.value=500;this.middle.frequency.value=1E3;this.treble.frequency.value=2E3;this.presence.frequency.value=
4E3;this.middle.Q.value=Math.SQRT1_2;this.bass.gain.value=0;this.middle.gain.value=0;this.treble.gain.value=0;this.presence.gain.value=0}function r(a,b){h.call(this,a,b);this.filter=a.createBiquadFilter();this.filter.LOWPASS=this.filter.LOWPASS||0;this.filter.HIGHPASS=this.filter.HIGHPASS||1;this.filter.BANDPASS=this.filter.BANDPASS||2;this.filter.LOWSHELF=this.filter.LOWSHELF||3;this.filter.HIGHSHELF=this.filter.HIGHSHELF||4;this.filter.PEAKING=this.filter.PEAKING||5;this.filter.NOTCH=this.filter.NOTCH||
6;this.filter.ALLPASS=this.filter.ALLPASS||7;this.input.connect(this.filter);this.filter.connect(this.output);this.filter.frequency.setTargetAtTime=this.filter.frequency.setTargetAtTime||this.filter.frequency.setTargetValueAtTime;this.filter.type="[object String]"===Object.prototype.toString.call(this.filter.type)?"lowpass":this.filter.LOWPASS;this.filter.frequency.value=350;this.filter.Q.value=1;this.filter.gain.value=0;this.maxFrequency=this.filter.frequency.value;this.attack=0.01;this.decay=0.3;
this.sustain=0.5;this.release=1}function q(a,b){h.call(this,a,b);this.amplitude=a.createGain();this.input.connect(this.amplitude);this.amplitude.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain);this.amplitude.gain.value=1;this.depth.gain.value=0;this.rate.value=0}function I(a,b){h.call(this,a,b);this.amplitude=a.createGain();this.input.connect(this.amplitude);this.amplitude.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain);
this.amplitude.gain.value=1;this.depth.gain.value=0;this.rate.value=0}function y(a,b){h.call(this,a,b);this.amplitudeL=a.createGain();this.amplitudeR=a.createGain();this.splitter=a.createChannelSplitter(2);this.merger=a.createChannelMerger(2);this.input.connect(this.splitter);this.splitter.connect(this.amplitudeL,0,0);this.splitter.connect(this.amplitudeR,1,0);this.amplitudeL.connect(this.merger,0,0);this.amplitudeR.connect(this.merger,0,1);this.merger.connect(this.output);this.lfoSplitter=a.createChannelSplitter(2);
this.lfo.connect(this.depth);this.depth.connect(this.processor);this.processor.connect(this.lfoSplitter);this.lfoSplitter.connect(this.amplitudeL.gain,0);this.lfoSplitter.connect(this.amplitudeR.gain,1);this.amplitudeL.gain.value=1;this.amplitudeR.gain.value=1;this.depth.gain.value=0;this.rate.value=0}function s(a,b){h.call(this,a,b);this.NUM_FILTER=12;this.filters=Array(this.NUM_FILTER);for(var c=0;c<this.NUM_FILTER;c++)this.filters[c]=a.createBiquadFilter(),this.filters[c].ALLPASS=this.filters[c].ALLPASS||
7,this.filters[c].type="[object String]"===Object.prototype.toString.call(this.filters[c].type)?"allpass":this.filters[c].ALLPASS,this.filters[c].frequency.value=350,this.filters[c].Q.value=Math.SQRT1_2,this.filters[c].gain.value=0;this.mix=a.createGain();this.input.connect(this.output);this.input.connect(this.filters[0]);for(c=0;c<this.NUM_FILTER;c++)c<this.NUM_FILTER-1?this.filters[c].connect(this.filters[c+1]):(this.filters[c].connect(this.mix),this.mix.connect(this.output));this.lfo.connect(this.depth);
for(var c=0,e=this.filters.length;c<e;c++)this.depth.connect(this.filters[c].frequency);this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0}function J(a,b){h.call(this,a,b);this.delay=a.createDelay();this.mix=a.createGain();this.feedback=a.createGain();this.input.connect(this.output);this.input.connect(this.delay);this.delay.connect(this.feedback);this.feedback.connect(this.delay);this.delay.connect(this.mix);this.mix.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime);
this.delay.delayTime.value=0.005;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0;this.feedback.gain.value=0}function z(a,b){h.call(this,a,b);this.delay=a.createDelay();this.mix=a.createGain();this.feedback=a.createGain();this.input.connect(this.output);this.input.connect(this.delay);this.delay.connect(this.feedback);this.feedback.connect(this.delay);this.delay.connect(this.mix);this.mix.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime);this.delay.delayTime.value=
0.02;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0;this.feedback.gain.value=0}function L(a,b){h.call(this,a,b);this.MAX_DELAY_TIME=5;this.delay=a.createDelay(this.MAX_DELAY_TIME);this.dry=a.createGain();this.wet=a.createGain();this.feedback=a.createGain();this.input.connect(this.dry);this.dry.connect(this.output);this.input.connect(this.delay);this.delay.connect(this.feedback);this.feedback.connect(this.delay);this.delay.connect(this.wet);this.wet.connect(this.output);this.delay.delayTime.value=
0;this.dry.gain.value=1;this.wet.gain.value=0;this.feedback.gain.value=0}function A(a,b){h.call(this,a,b);this.dry=a.createGain();this.wet=a.createGain();this.convolver=a.createConvolver();this.decodeAudioData=function(c,e,b){a.decodeAudioData(c,e,b)};this.input.connect(this.dry);this.dry.connect(this.output);this.input.connect(this.convolver);this.convolver.connect(this.wet);this.wet.connect(this.output);this.dry.gain.value=1;this.wet.gain.value=0}function M(a,b){h.call(this,a,b);this.panner=a.createPanner();
this.panner.EQUALPOWER=this.panner.EQUALPOWER||0;this.panner.HRTF=this.panner.HRTF||1;this.panner.LINEAR_DISTANCE=this.panner.LINEAR_DISTANCE||0;this.panner.INVERSE_DISTANCE=this.panner.INVERSE_DISTANCE||1;this.panner.EXPONENTIAL_DISTANCE=this.panner.EXPONENTIAL_DISTANCE||2;this.input.connect(this.panner);this.panner.connect(this.output);this.positions={x:0,y:0,z:0};this.orientations={x:1,y:0,z:0};this.velocities={x:0,y:0,z:0};this.panner.refDistance=1;this.panner.maxDistance=1E4;this.panner.rolloffFactor=
1;this.panner.coneInnerAngle=360;this.panner.coneOuterAngle=360;this.panner.coneOuterGain=0;this.panner.panningModel="[object String]"===Object.prototype.toString.call(this.panner.panningModel)?"HRTF":1;this.panner.distanceModel="[object String]"===Object.prototype.toString.call(this.panner.distanceModel)?"inverse":1;this.panner.setPosition(this.positions.x,this.positions.y,this.positions.z);this.panner.setOrientation(this.orientations.x,this.orientations.y,this.orientations.z);this.panner.setVelocity(this.velocities.x,
this.velocities.y,this.velocities.z)}function B(a){this.context=a;this.generators=[];this.activeIndexes=[];this.activeCounter=0;this.attack=0.01;this.decay=0.3;this.sustain=0.5;this.release=1}this.context=a;this.SAMPLE_RATE=a.sampleRate;this.NUM_OUTPUT=this.NUM_INPUT=2;if(void 0!==b)switch(parseInt(b)){case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:this.BUFFER_SIZE=parseInt(b);break;default:g(this+" constructor() : The 2nd argument is one of 256, 512, 1024, 2048, 4096, 8192, 16384 !!");
return}else/(Win(dows )?NT 6\.2)/.test(navigator.userAgent)?this.BUFFER_SIZE=1024:/(Win(dows )?NT 6\.1)/.test(navigator.userAgent)?this.BUFFER_SIZE=1024:/(Win(dows )?NT 6\.0)/.test(navigator.userAgent)?this.BUFFER_SIZE=2048:/Win(dows )?(NT 5\.1|XP)/.test(navigator.userAgent)?this.BUFFER_SIZE=4096:/Mac|PPC/.test(navigator.userAgent)?this.BUFFER_SIZE=1024:/Linux/.test(navigator.userAgent)?this.BUFFER_SIZE=8192:/iPhone|iPad|iPod/.test(navigator.userAgent)?this.BUFFER_SIZE=2048:this.BUFFER_SIZE=16384;
this.masterVolume=a.createGain();this.processor=a.createScriptProcessor(this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT);l.prototype=implement(N.prototype);h.prototype=implement(N.prototype);l.prototype.constructor=l;h.prototype.constructor=h;n.prototype=w(h.prototype);p.prototype=w(h.prototype);D.prototype=w(h.prototype);x.prototype=w(h.prototype);r.prototype=w(h.prototype);q.prototype=w(h.prototype);I.prototype=w(h.prototype);y.prototype=w(h.prototype);s.prototype=w(h.prototype);J.prototype=w(h.prototype);
z.prototype=w(h.prototype);L.prototype=w(h.prototype);A.prototype=w(h.prototype);M.prototype=w(h.prototype);n.prototype.constructor=n;p.prototype.constructor=p;D.prototype.constructor=D;x.prototype.constructor=x;r.prototype.constructor=r;q.prototype.constructor=q;I.prototype.constructor=I;y.prototype.constructor=y;s.prototype.constructor=s;J.prototype.constructor=J;z.prototype.constructor=z;L.prototype.constructor=L;A.prototype.constructor=A;M.prototype.constructor=M;this.listener=new d(a);this.analyser=
new f(a);this.recorder=new k(a,this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT);this.session=new l(a,this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT,this.analyser);this.eg=new B(a);this.compressor=new n(a,this.BUFFER_SIZE);this.distortion=new p(a,this.BUFFER_SIZE);this.wah=new D(a,this.BUFFER_SIZE);this.equalizer=new x(a,this.BUFFER_SIZE);this.filter=new r(a,this.BUFFER_SIZE);this.tremolo=new q(a,this.BUFFER_SIZE);this.ringmodulator=new I(a,this.BUFFER_SIZE);this.autopanner=new y(a,this.BUFFER_SIZE);
this.phaser=new s(a,this.BUFFER_SIZE);this.flanger=new J(a,this.BUFFER_SIZE);this.chorus=new z(a,this.BUFFER_SIZE);this.delay=new L(a,this.BUFFER_SIZE);this.reverb=new A(a,this.BUFFER_SIZE);this.panner=new M(a,this.BUFFER_SIZE);this.nodes=[this.compressor,this.distortion,this.wah,this.equalizer,this.filter,this.tremolo,this.ringmodulator,this.autopanner,this.flanger,this.phaser,this.chorus,this.delay,this.reverb];this.Effector=h;this.plugins=[];d.prototype.param=function(a,b){if("[object Object]"===
Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "dopplerfactor":if(void 0===b)return this.listener.dopplerFactor;var e=parseFloat(b);0<=e?this.listener.dopplerFactor=e:g(this+' param() : The range of "'+a+'" is greater than or equal 0 !!');break;case "speedofsound":if(void 0===b)return this.listener.speedOfSound;e=parseFloat(b);0<=e?this.listener.speedOfSound=e:g(this+' param() : The range of "'+a+'" is greater than or equal 0 !!');
break;case "x":case "y":case "z":if(void 0===b)return this.positions[c];e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):(this.positions[c]=e,this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case "fx":case "fy":case "fz":if(void 0===b)return this.fronts[c.charAt(1)];e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):(this.fronts[c.charAt(1)]=e,this.listener.setOrientation(this.fronts.x,this.fronts.y,
this.fronts.z,this.ups.x,this.ups.y,this.ups.z));break;case "ux":case "uy":case "uz":if(void 0===b)return this.ups[c.charAt(1)];e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):(this.ups[c.charAt(1)]=e,this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z));break;case "vx":case "vy":case "vz":if(void 0===b)return this.velocities[c.charAt(1)];e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):
(this.velocities[c.charAt(1)]=e,this.listener.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z));break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};d.prototype.toString=function(){return"SoundModule Listener"};f.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "fftsize":if(void 0===
b)return this.analyser.fftSize;var e=parseInt(b);switch(e){case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:this.analyser.fftSize=e;break;default:g(this+' param() : The value of "'+a+'" is one of 32, 64, 128, 256, 512, 1024, 2048 !!')}break;case "frequencybincount":return this.analyser.frequencyBinCount;case "mindecibels":case "maxdecibels":if(void 0===b)return this.analyser[c.replace("decibels","Decibels")];e=parseFloat(b);if(isNaN(e))g(this+' param() : The type of "'+a+'" is number type !!');
else if(this.analyser[c.replace("decibels","Decibels")]=e,this.analyser.minDecibels>=this.analyser.maxDecibels){c=this.analyser.minDecibels;var h=this.analyser.maxDecibels;g(this+' param() : The designated dB (min : "'+c+'" / max : "'+h+'") is invalid !!');this.analyser.minDecibels=-100;this.analyser.maxDecibels=-30}break;case "smoothingtimeconstant":if(void 0===b)return this.analyser.smoothingTimeConstant;e=parseFloat(b);c=0;h=1;e>=c&&e<=h?this.analyser.smoothingTimeConstant=e:g(this+' param() : The range of "'+
a+'" is between '+c+" and "+h+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};f.prototype.start=function(a,b){switch(String(a).replace(/-/g,"").toLowerCase()){case "timealll":if(b instanceof AudioBuffer){if(0<b.numberOfChannels){var c=new Float32Array(b.length);c.set(b.getChannelData(0));this.timeAllL.start(c)}}else g(this+" start() : The 2nd argument is the instance of AudioBuffer !!");break;case "timeallr":b instanceof
AudioBuffer?1<b.numberOfChannels&&(c=new Float32Array(b.length),c.set(b.getChannelData(1)),this.timeAllR.start(c)):g(this+" start() : The 2nd argument is the instance of AudioBuffer !!");break;case "time":c=new Uint8Array(this.analyser.fftSize);this.analyser.getByteTimeDomainData(c);this.time.start(c);this.time.timerid=v.setTimeout(function(){this.start(a)}.bind(this),this.time.interval);break;case "fft":"uint"===this.fft.type?(c=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.getByteFrequencyData(c),
this.fft.start(c)):(c=new Float32Array(this.analyser.frequencyBinCount),this.analyser.getFloatFrequencyData(c),this.fft.start(c,this.analyser.minDecibels,this.analyser.maxDecibels));this.fft.timerid=v.setTimeout(function(){this.start(a)}.bind(this),this.fft.interval);break;default:g(this+' start() : The 1st argument is one of "timeAllL", "timeAllR", "time", "fft" !!')}return this};f.prototype.stop=function(a){switch(String(a).replace(/-/g,"").toLowerCase()){case "timealll":case "timeallr":break;case "time":v.clearTimeout(this.time.timerid);
this.time.timerid=null;break;case "fft":v.clearTimeout(this.fft.timerid);this.fft.timerid=null;break;default:g(this+' stop() : The 1st argument is one of "timeAllL", "timeAllR", "time", "fft" !!')}return this};f.prototype.domain=function(a){a=String(a).replace(/-/g,"").toLowerCase();switch(a){case "timealll":case "timeallr":return this["timeAll"+a.slice(-1).toUpperCase()];case "time":case "fft":return this[a];default:g(this+' domain() : The 1st argument is one of "timeAllL", "timeAllR", "time", "fft" !!')}};
f.prototype.toString=function(){return"SoundModule Analyser"};k.prototype.setup=function(a){a=parseInt(a);if(0<a){this.numTrack=a;this.trackLs=Array(this.numTrack);this.trackRs=Array(this.numTrack);for(var b=0;b<a;b++)this.trackLs[b]=[];for(b=0;b<a;b++)this.trackRs[b]=[]}else this.numTrack=1,this.trackLs=Array(this.numTrack),this.trackRs=Array(this.numTrack),this.trackLs[0]=[],this.trackRs[0]=[];return this};k.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,
a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "gainl":case "gainr":if(void 0===b)return this["gain"+c.slice(-1).toUpperCase()];var e=parseFloat(b);0<=e&&1>=e?this["gain"+c.slice(-1).toUpperCase()]=e:g(this+' param() : The range of "'+a+'" is between 0 and 1 !!');break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};k.prototype.ready=function(a){this.isTrack(a)&&(this.activeTrack=a);return this};k.prototype.start=
function(){if(-1!==this.activeTrack&&this.paused){var a=this;this.paused=!1;this.processor.onaudioprocess=function(b){if(-1!==a.activeTrack){var c=b.inputBuffer.getChannelData(0);b=b.inputBuffer.getChannelData(1);for(var e=0;e<this.bufferSize;e++)a.trackLs[a.activeTrack].push(a.gainL*c[e]),a.trackRs[a.activeTrack].push(a.gainR*b[e])}else this.disconnect(0),this.onaudioprocess=function(){}}}return this};k.prototype.stop=function(){this.activeTrack=-1;this.paused=!0;this.processor.disconnect(0);this.processor.onaudioprocess=
function(){};return this};k.prototype.isTrack=function(a){a=parseInt(a);return 0<=a&&a<this.numTrack?!0:!1};k.prototype.getActiveTrack=function(){return this.activeTrack};k.prototype.mix=function(){-1!==this.activeTrack&&this.stop();var a=function(a){for(var c="L"===a?this.trackLs:this.trackRs,m=[],b=0,h=0,k=0;;){for(var d=0,f=c.length;d<f;d++)void 0!==c[d][k]&&(b+=c[d][k],h++);if(0<h)m[k]=b/h,h=b=0,k++;else{"L"===a&&(this.mixLs=m.slice(0,m.length));"R"===a&&(this.mixRs=m.slice(0,m.length));break}}};
a.call(this,"L");a.call(this,"R");return this};k.prototype.clear=function(a){-1!==this.activeTrack&&this.stop();if("all"===String(a).toLowerCase()){a=0;for(var b=this.trackLs.length;a<b;a++)this.trackLs[a].length=0;a=0;for(b=this.trackRs.length;a<b;a++)this.trackRs[a].length=0}else this.isTrack(a)&&(this.trackLs[a].length=0,this.trackRs[a].length=0);return this};k.prototype.create=function(a,b,c,e){-1!==this.activeTrack&&this.stop();var h=[],k=[];"all"===String(a).toLowerCase()?(this.mix(),h=this.mixLs,
k=this.mixRs):this.isTrack(a)&&(h=this.trackLs[a-1],k=this.trackRs[a-1]);if(0!==h.length||0!==k.length){a=1===b?1:2;b=8===c?8:16;c=[];var d=Math.min(h.length,k.length);switch(b){case 8:for(var f=0;f<d;f++){var g=0,g=0===f%a?(h[f]+1)/2*(Math.pow(2,8)-1):(k[f-1]+1)/2*(Math.pow(2,8)-1);g>Math.pow(2,8)-1&&(g=Math.pow(2,8)-1);g<Math.pow(2,0)-1&&(g=Math.pow(2,0)-1);c.push(Math.floor(g))}break;case 16:for(f=0;f<d;f++)g=0===f%a?Math.floor(h[f]*Math.pow(2,15)):Math.floor(k[f-1]*Math.pow(2,15)),g>Math.pow(2,
15)-1&&(g=Math.pow(2,15)-1),g<-Math.pow(2,15)-1&&(g=-Math.pow(2,15)-1),0>g&&(g+=Math.pow(2,16)),c.push(g)}g=36+b/8*a*d;h=8+(28+(8+b/8*a*d));f=0.5*this.SAMPLE_RATE;k=b/8*this.SAMPLE_RATE*a*0.5;d*=b/8*a;switch(String(e).toLowerCase()){case "base64":e="RIFF"+String.fromCharCode(g>>0&255,g>>8&255,g>>16&255,g>>24&255);e+="WAVE";e+="fmt "+String.fromCharCode(16,0,0,0);e+=String.fromCharCode(1,0);e+=String.fromCharCode(a,0);e+=String.fromCharCode(f>>0&255,f>>8&255,f>>16&255,f>>24&255);e+=String.fromCharCode(k>>
0&255,k>>8&255,k>>16&255,k>>24&255);e+=String.fromCharCode(b/8*a,0);e+=String.fromCharCode(b,0);e+="data";e+=String.fromCharCode(d>>0&255,d>>8&255,d>>16&255,d>>24&255);f=0;for(a=c.length;f<a;f++)e+=String.fromCharCode(c[f]>>0&255,c[f]>>8&255);return"data:audio/wav;base64,"+v.btoa(e);default:e=[82,73,70,70];e[4]=g>>0&255;e[5]=g>>8&255;e[6]=g>>16&255;e[7]=g>>24&255;e[8]=87;e[9]=65;e[10]=86;e[11]=69;e[12]=102;e[13]=109;e[14]=116;e[15]=32;e[16]=16;e[17]=0;e[18]=0;e[19]=0;e[20]=1;e[21]=0;e[22]=a;e[23]=
0;e[24]=f>>0&255;e[25]=f>>8&255;e[26]=f>>16&255;e[27]=f>>24&255;e[28]=k>>0&255;e[29]=k>>8&255;e[30]=k>>16&255;e[31]=k>>24&255;e[32]=b/8*a;e[33]=0;e[34]=b;e[35]=0;e[36]=100;e[37]=97;e[38]=116;e[39]=97;e[40]=d>>0&255;e[41]=d>>8&255;e[42]=d>>16&255;e[43]=d>>24&255;f=0;for(a=c.length;f<a;f++)e[h-d+2*f]=c[f]>>0&255,e[h-d+2*f+1]=c[f]>>8&255;v.URL=v.URL||v.webkitURL;e=new Blob([new Uint8Array(e)],{type:"audio/wav"});return v.URL.createObjectURL(e)}}};k.prototype.toString=function(){return"SoundModule Recorder"};
l.prototype.setup=function(a,b,c,e,f,h,k){if(navigator.onLine){if("[object Object]"===Object.prototype.toString.call(a)){var d=a;"tls"in d&&(a=d.tls);"host"in d&&(b=d.host);"port"in d&&(c=d.port);"path"in d&&(e=d.path);"open"in d&&(f=d.open);"close"in d&&(h=d.close);"error"in d&&(k=d.error)}a=a?"wss://":"ws://";"/"!==e.charAt(0)&&(e="/"+e);c=parseInt(c);if(isNaN(c)||0>c||65535<c){g(this+" setup() : The 3rd argument is number type for port number (0 - 65535)");return}this.websocket=new WebSocket(a+
b+":"+c+e);this.websocket.binaryType="arraybuffer";var l=this;this.websocket.onopen=function(a){"[object Function]"===Object.prototype.toString.call(f)&&f(a,l.websocket)};this.websocket.onclose=function(a){"[object Function]"===Object.prototype.toString.call(h)&&h(a,l.websocket)};this.websocket.onerror=function(a){"[object Function]"===Object.prototype.toString.call(k)&&k(a,l.websocket)};this.websocket.onmessage=function(a){if(l.isActive){if(a.data instanceof ArrayBuffer){var c=Math.floor(a.data.byteLength/
Float32Array.BYTES_PER_ELEMENT/2),m=c*Float32Array.BYTES_PER_ELEMENT,b=new Float32Array(a.data,0,c),e=new Float32Array(a.data,m,c);l.receiver.connect(l.analyser.input);l.analyser.output.connect(l.context.destination);l.analyser.start("time");l.analyser.start("fft");l.receiver.onaudioprocess=function(a){var c=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);c.set(b);a.set(e);l.isActive&&null!==l.websocket||(l.analyser.stop("time"),l.analyser.stop("fft"),this.disconnect(0),this.onaudioprocess=
function(){})}}}else l.analyser.stop("time"),l.analyser.stop("fft"),l.receiver.disconnect(0),l.receiver.onaudioprocess=function(){}}}else throw this.websocket=null,this.isActive=!1,Error("Now offline !!");return this};l.prototype.start=function(){if(this.isActive&&this.isConnected()&&this.paused){this.paused=!1;var a=new Float32Array(2*this.sender.bufferSize),b=this;this.sender.onaudioprocess=function(c){if(b.isActive&&b.isConnected()){var e=c.inputBuffer.getChannelData(0);c=c.inputBuffer.getChannelData(1);
for(var d=0;d<this.bufferSize;d++)a[d]=e[d],a[a.length/2+d]=c[d];b.websocket.send(a)}else b.paused=!0,b.sender.disconnect(0),b.sender.onaudioprocess=function(){}}}return this};l.prototype.close=function(){this.websocket instanceof WebSocket&&(this.websocket.close(),this.websocket=null);return this};l.prototype.isConnected=function(){return this.websocket instanceof WebSocket&&this.websocket.readyState===WebSocket.OPEN?!0:!1};l.prototype.toString=function(){return"SoundModule Session"};h.prototype.param=
function(a,b){return this};h.prototype.start=function(a){if(this.isActive&&!this.isStart){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;this.lfo.start(a);this.isStart=!0}return this};h.prototype.stop=function(a,b){if(this.isActive&&this.isStart){var c=parseFloat(a),e=parseFloat(b);if(isNaN(c)||c<this.context.currentTime)c=this.context.currentTime;if(isNaN(e)||0>e)e=0;var d=this.lfo.type,f=this.lfo.frequency.value;this.lfo.stop(c+e);this.lfo=this.context.createOscillator();
this.lfo.type=d;this.lfo.frequency.value=f;this.rate=this.lfo.frequency;this.lfo.start=this.lfo.start||this.lfo.noteOn;this.lfo.stop=this.lfo.stop||this.lfo.noteOff;this.isStart=!1}return this};h.prototype.toString=function(){return"SoundModule Effector"};n.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else if(c=String(a).replace(/-/g,"").toLowerCase(),c in this.compressor){if(void 0===b)return this.compressor[c].value;var e=
parseFloat(b),d={threshold:-100,knee:0,ratio:1,attack:0,release:0},f={threshold:0,knee:40,ratio:20,attack:1,release:1},d=this.compressor[c].minValue||d[c],f=this.compressor[c].maxValue||f[c];e>=d&&e<=f?this.compressor[c].value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!")}else g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!');return this};n.prototype.toString=function(){return"SoundModule Compressor"};p.prototype.param=function(a,
b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "drive":if(void 0===b)return this.drive.gain.value;c=parseFloat(b);var e=this.drive.gain.minValue||0,d=this.drive.gain.maxValue||1;c>=e&&c<=d?(this.drive.gain.value=c,this.clean.gain.value=1-this.drive.gain.value):g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;case "size":if(void 0===b)return this.size;c=parseInt(b);
0<=c?this.size=c:g(this+' param() : The range of "'+a+'" is greater than or equal 0 !!');break;case "curve":if(void 0===b)return this.distortion.curve;switch(String(b).toLowerCase()){case "clean":this.createCurve(0,this.size);break;case "crunch":this.createCurve(0.2,this.size);break;case "overdrive":this.createCurve(0.5,this.size);break;case "distortion":this.createCurve(0.7,this.size);break;case "fuzz":this.createCurve(0.9,this.size);break;default:g(this+' param() : The value of "'+a+'" is one of "clean", "crunch", "overdrive", "distortion", "fuzz" !!')}break;
default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};p.prototype.toString=function(){return"SoundModule Distortion"};D.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "depth":if(void 0===b)return this.depth.gain.value;c=parseFloat(b);var e=0,d=this.lowpass.frequency.value;c>=e&&c<=d?this.depth.gain.value=
c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;case "rate":if(void 0===b)return this.rate.value;c=parseFloat(b);e=this.rate.minValue||0;d=this.rate.maxValue||1E5;c>=e&&c<=d?this.rate.value=c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;case "mix":if(void 0===b)return this.mix.gain.value;c=parseFloat(b);e=this.mix.gain.minValue||0;d=this.mix.gain.maxValue||1;c>=e&&c<=d?this.mix.gain.value=c:g(this+' param() : The range of "'+a+'" is between '+
e+" and "+d+" !!");break;case "resonance":if(void 0===b)return this.lowpass.Q.value;c=parseFloat(b);e=this.lowpass.Q.minValue||1E-4;d=this.lowpass.Q.maxValue||1E3;c>=e&&c<=d?this.lowpass.Q.value=c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};D.prototype.stop=function(a,b){h.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),
this.depth.connect(this.lowpass.frequency));return this};D.prototype.toString=function(){return"SoundModule Wah"};x.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "bass":case "middle":case "treble":case "presence":if(void 0===b)return this[c].gain.value;var e=parseFloat(b),d=this[c].gain.minValue||-40,f=this[c].gain.maxValue||40;e>=d&&e<=f?this[c].gain.value=e:g(this+
' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};x.prototype.toString=function(){return"SoundModule Equalizer"};r.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "type":if(void 0===b)return this.filter.type;var e=String(b).toLowerCase();
c={lowpass:this.filter.LOWPASS,highpass:this.filter.HIGHPASS,bandpass:this.filter.BANDPASS,lowshelf:this.filter.LOWSHELF,highshelf:this.filter.HIGHSHELF,peaking:this.filter.PEAKING,notch:this.filter.NOTCH,allpass:this.filter.ALLPASS};e in c?this.filter.type="[object String]"===Object.prototype.toString.call(this.filter.type)?e:c[e]:g(this+' param() : The value of "'+a+'" is one of "lowpass", "highpass", "bandpass", "lowshelf", "highshelf", "peaking", "notch", "allpass" !!');break;case "frequency":if(void 0===
b)return this.filter.frequency.value;e=parseFloat(b);c=this.filter.frequency.minValue||10;var d=this.filter.frequency.maxValue||this.context.sampleRate/2;e>=c&&e<=d?(this.maxFrequency=e,this.filter.frequency.value=e):g(this+' param() : The range of "'+a+'" is between '+c+" and "+d+" !!");break;case "gain":if(void 0===b)return this.filter.gain.value;e=parseFloat(b);c=this.filter.gain.minValue||-40;d=this.filter.gain.maxValue||40;e>=c&&e<=d?this.filter.gain.value=e:g(this+' param() : The range of "'+
a+'" is between '+c+" and "+d+" !!");break;case "q":if(void 0===b)return this.filter.Q.value;e=parseFloat(b);c=this.filter.Q.minValue||1E-4;d=this.filter.Q.maxValue||1E3;e>=c&&e<=d?this.filter.Q.value=e:g(this+' param() : The range of "'+a+'" is between '+c+" and "+d+" !!");break;case "attack":case "decay":case "sustain":case "release":if(void 0===b)return this[c];e=parseFloat(b);0<=e?this[c]=e:g(this+' param() : The range of "'+a+'" is greater than or equal 0 !!');break;default:g(this+' param() : The designated property ("'+
a+'") does not exist in accessible properties !!')}return this};r.prototype.start=function(a){if(this.isActive){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;var b=a+this.attack,c=this.decay,e=this.sustain*this.filter.frequency.value;this.filter.frequency.cancelScheduledValues(a);this.filter.frequency.setValueAtTime(this.filter.frequency.defaultValue,a);this.filter.frequency.linearRampToValueAtTime(this.maxFrequency,b);this.filter.frequency.setTargetAtTime(e,b,
c)}return this};r.prototype.stop=function(a){if(this.isActive){a=parseFloat(a)-this.release;if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;var b=this.release;this.filter.frequency.cancelScheduledValues(a);this.filter.frequency.setValueAtTime(this.filter.frequency.value,a);this.filter.frequency.setTargetAtTime(this.filter.frequency.defaultValue,a,b)}return this};r.prototype.toString=function(){return"SoundModule Filter"};q.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,
a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "depth":if(void 0===b)return this.depth.gain.value;c=parseFloat(b);var e=this.depth.gain.minValue||0,d=this.depth.gain.maxValue||1;c>=e&&c<=d?this.depth.gain.value=c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;case "rate":if(void 0===b)return this.rate.value;c=parseFloat(b);e=this.rate.minValue||0;d=this.rate.maxValue||1E5;c>=e&&c<=d?this.rate.value=c:g(this+' param() : The range of "'+a+'" is between '+
e+" and "+d+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};q.prototype.stop=function(a,b){h.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain));return this};q.prototype.toString=function(){return"SoundModule Tremolo"};I.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=
String(a).replace(/-/g,"").toLowerCase(),c){case "depth":if(void 0===b)return this.depth.gain.value;c=parseFloat(b);var e=this.depth.gain.minValue||0,d=this.depth.gain.maxValue||1;c>=e&&c<=d?(this.depth.gain.value=c,this.amplitude.gain.value=0===this.depth.gain.value||0===this.rate.value?1:0):g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;case "rate":if(void 0===b)return this.rate.value;c=parseFloat(b);e=this.rate.minValue||0;d=this.rate.maxValue||1E5;c>=e&&c<=d?(this.rate.value=
c,this.amplitude.gain.value=0===this.depth.gain.value||0===this.rate.value?1:0):g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};I.prototype.stop=function(a,b){h.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain));return this};I.prototype.toString=function(){return"SoundModule Ringmodulator"};
y.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "depth":if(void 0===b)return this.depth.gain.value;c=parseFloat(b);var e=this.depth.gain.minValue||0,d=this.depth.gain.maxValue||1;c>=e&&c<=d?this.depth.gain.value=c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;case "rate":if(void 0===b)return this.rate.value;c=parseFloat(b);e=this.rate.minValue||
0;d=this.rate.maxValue||1E5;c>=e&&c<=d?this.rate.value=c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};y.prototype.start=function(a){if(this.isActive&&!this.isStart){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;this.lfo.start(a);this.isStart=!0;var b=this;this.processor.onaudioprocess=function(a){var e=a.inputBuffer.getChannelData(0),
d=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);if(b.isActive&&0!==b.depth.gain.value&&0!==b.rate.value)for(var f=0;f<this.bufferSize;f++)d[f]=e[f],a[f]=-e[f];else for(f=0;f<this.bufferSize;f++)d[f]=0,a[f]=0}}return this};y.prototype.stop=function(a,b){h.prototype.stop.call(this,a,b);this.isActive&&(this.processor.disconnect(0),this.processor.onaudioprocess=function(){},this.lfo.connect(this.depth),this.depth.connect(this.processor),this.processor.connect(this.lfoSplitter),this.lfoSplitter.connect(this.amplitudeL.gain,
0),this.lfoSplitter.connect(this.amplitudeR.gain,1));return this};y.prototype.toString=function(){return"SoundModule Autopanner"};s.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "depth":if(void 0===b)return this.depth.gain.value;c=parseFloat(b);var e=0,d=this.filters[0].frequency.value;c>=e&&c<=d?this.depth.gain.value=c:g(this+' param() : The range of "'+a+'" is between '+
e+" and "+d+" !!");break;case "rate":if(void 0===b)return this.rate.value;c=parseFloat(b);e=this.rate.minValue||0;d=this.rate.maxValue||1E5;c>=e&&c<=d?this.rate.value=c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;case "mix":if(void 0===b)return this.mix.gain.value;c=parseFloat(b);e=this.mix.gain.minValue||0;d=this.mix.gain.maxValue||1;c>=e&&c<=d?this.mix.gain.value=c:g(this+' param() : The range of "'+a+'" is between '+e+" and "+d+" !!");break;default:g(this+' param() : The designated property ("'+
a+'") does not exist in accessible properties !!')}return this};s.prototype.stop=function(a,b){h.prototype.stop.call(this,a,b);if(this.isActive){this.lfo.connect(this.depth);for(var c=0,e=this.filters.length;c<e;c++)this.depth.connect(this.filters[c].frequency)}return this};s.prototype.toString=function(){return"SoundModule Phaser"};J.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),
c){case "depth":if(void 0===b)return this.depth.gain.value;var e=parseFloat(b),d=0,f=Math.ceil(1E3*this.delay.delayTime.value)/1E3;e>=d&&e<=f?this.depth.gain.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;case "rate":if(void 0===b)return this.rate.value;e=parseFloat(b);d=this.rate.minValue||0;f=this.rate.maxValue||1E5;e>=d&&e<=f?this.rate.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;case "mix":case "feedback":if(void 0===
b)return this[c].gain.value;e=parseFloat(b);d=this[c].gain.minValue||0;f=this[c].gain.maxValue||1;e>=d&&e<=f?this[c].gain.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};J.prototype.stop=function(a,b){h.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.delay.delayTime));return this};J.prototype.toString=
function(){return"SoundModule Flanger"};z.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "depth":if(void 0===b)return this.depth.gain.value;var e=parseFloat(b),d=0,f=Math.ceil(100*this.delay.delayTime.value)/100;e>=d&&e<=f?this.depth.gain.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;case "rate":if(void 0===b)return this.rate.value;
e=parseFloat(b);d=this.rate.minValue||0;f=this.rate.maxValue||1E5;e>=d&&e<=f?this.rate.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;case "mix":case "feedback":if(void 0===b)return this[c].gain.value;e=parseFloat(b);d=this[c].gain.minValue||0;f=this[c].gain.maxValue||1;e>=d&&e<=f?this[c].gain.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};
z.prototype.stop=function(a,b){h.prototype.stop.call(this,a,b);this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.delay.delayTime));return this};z.prototype.toString=function(){return"SoundModule Chorus"};L.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "delaytime":if(void 0===b)return this.delay.delayTime.value;var e=parseFloat(b),d=this.delay.delayTime.minValue||
0,f=this.delay.delayTime.maxValue||this.MAX_DELAY_TIME;e>=d&&e<=f?this.delay.delayTime.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;case "dry":case "wet":case "feedback":if(void 0===b)return this[c].gain.value;e=parseFloat(b);d=this[c].gain.minValue||0;f=this[c].gain.maxValue||1;e>=d&&e<=f?this[c].gain.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};
L.prototype.toString=function(){return"SoundModule Delay"};A.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "dry":case "wet":if(void 0===b)return this[c].gain.value;var e=parseFloat(b),d=this[c].gain.minValue||0,f=this[c].gain.maxValue||1;e>=d&&e<=f?this[c].gain.value=e:g(this+' param() : The range of "'+a+'" is between '+d+" and "+f+" !!");break;default:g(this+
' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};A.prototype.start=function(a,b){"[object Function]"!==Object.prototype.toString.call(b)&&(b=function(){});this.decodeAudioData(a,function(a){this.convolver.buffer=a}.bind(this),b.bind(this));return this};A.prototype.toString=function(){return"SoundModule Reverb"};M.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=
String(a).replace(/-/g,"").toLowerCase(),c){case "x":case "y":case "z":if(void 0===b)return this.positions[c];var e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):(this.positions[c]=e,this.panner.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case "ox":case "oy":case "oz":if(void 0===b)return this.orientations[c.charAt(1)];e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):(this.orientations[c.charAt(1)]=e,
this.panner.setOrientation(this.orientations.x,this.orientations.y,this.orientations.z));break;case "vx":case "vy":case "vz":if(void 0===b)return this.velocities[c.charAt(1)];e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):(this.velocities[c.charAt(1)]=e,this.panner.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z));break;case "refdistance":if(void 0===b)return this.panner.refDistance;e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+
'" is number type !!'):this.panner.refDistance=e;break;case "maxdistance":if(void 0===b)return this.panner.maxDistance;e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):this.panner.maxDistance=e;break;case "rollofffactor":if(void 0===b)return this.panner.rolloffFactor;e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):this.panner.rolloffFactor=e;break;case "coneinnerangle":if(void 0===b)return this.panner.coneInnerAngle;e=parseFloat(b);
isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):this.panner.coneInnerAngle=e;break;case "coneouterangle":if(void 0===b)return this.panner.coneOuterAngle;e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):this.panner.coneOuterAngle=e;break;case "coneoutergain":if(void 0===b)return this.panner.coneOuterGain;e=parseFloat(b);isNaN(e)?g(this+' param() : The type of "'+a+'" is number type !!'):this.panner.coneOuterGain=e;break;case "panningmodel":if(void 0===
b)return this.panner.panningModel;e=/HRTF/i.test(b)?String(b).toUpperCase():String(b).toLowerCase();c={equalpower:this.panner.EQUALPOWER,HRTF:this.panner.HRTF};e in c?this.panner.panningModel="[object String]"===Object.prototype.toString.call(this.panner.panningModel)?e:c[e]:g(this+' param() : The value of "'+a+'" is either "equalpower" or "HRTF" !!');break;case "distancemodel":if(void 0===b)return this.panner.distanceModel;e=String(b).replace(/-/g,"").toLowerCase();c={linear:this.panner.LINEAR_DISTANCE,
inverse:this.panner.INVERSE_DISTANCE,exponential:this.panner.EXPONENTIAL_DISTANCE};e in c?this.panner.distanceModel="[object String]"===Object.prototype.toString.call(this.panner.distanceModel)?e:c[e]:g(this+' param() : The value of "'+a+'" is one of "linear", "inverse", "exponential" !!');break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};M.prototype.toString=function(){return"SoundModule Panner"};B.prototype.param=function(a,
b){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)this.param(c,a[c]);else switch(c=String(a).replace(/-/g,"").toLowerCase(),c){case "attack":case "decay":case "sustain":case "release":if(void 0===b)return this[c];var e=parseFloat(b);0<=e?this[c]=e:g(this+' param() : The type of "'+a+'" is greater than or equal 0 !!');break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};B.prototype.isStop=function(){for(var a=
[],b=0,c=this.activeIndexes.length;b<c;b++){var e=this.activeIndexes[b];if(void 0!==e){if(0.001<this.generators[e].gain.value)return!1;a.push(e);if(a.length===this.activeCounter)return!0}}};B.prototype.ready=function(a,b,c){a=0<=parseInt(a)?parseInt(a):0;b.connect(this.generators[a]);this.generators[a].connect(c);this.activeIndexes[a]=a;this.activeCounter++;return this};B.prototype.start=function(a){a=parseFloat(a);if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;for(var b=a+this.attack,
c=this.decay,e=this.sustain,d=0,f=this.activeIndexes.length;d<f;d++){var h=this.activeIndexes[d];void 0!==h&&(this.generators[h].gain.cancelScheduledValues(a),this.generators[h].gain.setValueAtTime(0,a),this.generators[h].gain.linearRampToValueAtTime(1,b),this.generators[h].gain.setTargetAtTime(e,b,c))}return this};B.prototype.stop=function(a){a=parseFloat(a)-this.release;if(isNaN(a)||a<this.context.currentTime)a=this.context.currentTime;for(var b=this.release,c=0,e=this.activeIndexes.length;c<e;c++){var d=
this.activeIndexes[c];void 0!==d&&(this.generators[d].gain.cancelScheduledValues(a),this.generators[d].gain.setValueAtTime(this.generators[d].gain.value,a),this.generators[d].gain.setTargetAtTime(0,a,b))}return this};B.prototype.clear=function(){this.activeIndexes=[];this.activeCounter=0;return this};B.prototype.toString=function(){return"OscillatorModule EnvelopeGenerator"}}function E(a){function b(a){this.context=a;this.frequencies={start:-1,end:0};this.time=this.rate=0;this.type="linear"}s.call(this,
a);this.sources=[];this.times={start:0,stop:0};this.isAnalyser=!1;this.glide=new b(a);b.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var k in a)this.param(k,a[k]);else switch(k=String(a).replace(/-/g,"").toLowerCase(),k){case "time":if(void 0===b)return this.time;k=parseFloat(b);0<=k?this.time=k:g(this+' param() : The range of "'+a+'" is greater than or equal 0 !!');break;case "type":if(void 0===b)return this.type;k=String(b).toLowerCase();"linear"===
k||"exponential"===k?this.type=k:g(this+' param() : The value of "'+a+'" is either "linear" or "exponential" !!');break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};b.prototype.ready=function(a){this.frequencies.end=a;a=-1===this.frequencies.start?0:this.frequencies.end-this.frequencies.start;-1===this.frequencies.start||0===this.time||0===a?this.frequencies.start=this.frequencies.end:this.rate=a/this.time;return this};b.prototype.start=
function(a,b){var k=parseFloat(b);if(isNaN(k)||k<this.context.currentTime)k=this.context.currentTime;var g=k+this.time;a.frequency.cancelScheduledValues(k);a.frequency.setValueAtTime(this.frequencies.start,k);a.frequency[this.type+"RampToValueAtTime"](this.frequencies.end,g);return this};b.prototype.stop=function(){this.frequencies.start=this.frequencies.end;return this};b.prototype.toString=function(){return"OscillatorModule Glide"}}function F(a){s.call(this,a);this.sources=[];this.resources=[];
this.buffers=[];this.volumes=[];this.isStarts=[];this.settings=[];this.times={start:0,stop:0};this.isAnalyser=!1}function z(a){function b(){this.depth=0}s.call(this,a);this.source=a.createBufferSource();this.buffer=null;this.currentTime=0;this.paused=!0;this.callbacks={decode:function(){},ready:function(){},start:function(){},stop:function(){},update:function(){},ended:function(){},error:function(){}};this.vocalcanceler=new b;b.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var k in a)this.param(k,
a[k]);else switch(k=String(a).replace(/-/g,"").toLowerCase(),k){case "depth":if(void 0===b)return this.depth;k=parseFloat(b);0<=k&&1>=k?this.depth=k:g(this+" param() : The range of "+a+" is between 0 and 1 !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};b.prototype.start=function(a,b){return a-this.depth*b}}function A(a){z.call(this,a);this.media=this.source=null;this.ex="";this.duration=0;this.playbackRate=1;this.muted=
this.loop=this.controls=!1;this.callbacks={loadstart:function(){}}}function H(){this.source=null;this.sequences=[];this.timerids=[];this.prev=[];this.callbacks={start:function(){},stop:function(){},ended:function(){},error:function(){}}}var r,Q=v.AudioContext||v.webkitAudioContext?!0:!1,G=v.webkitAudioContext?!0:!1,K=2,g=function(a){switch(K){case 1:console.trace();alert(a);break;case 2:console.trace();console.error(a);break;case 3:throw console.trace(),Error(a);}},w=implement=function(a){if(Object.create)return Object.create(a);
var b=function(){};b.prototype=a;return new b},S=function(a){switch(String(a).toUpperCase()){case "NONE":case "0":this.ERROR_MODE=K=0;break;case "ALERT":case "1":this.ERROR_MODE=K=1;break;case "CONSOLE":case "2":this.ERROR_MODE=K=2;break;case "EXCEPTION":case "3":this.ERROR_MODE=K=3}},T=function(a,b,d,f,k){if("[object Object]"===Object.prototype.toString.call(a)){var l=a;"file"in l&&(a=l.file);"type"in l&&(b=l.type);"success"in l&&(d=l.success);"error"in l&&(f=l.error);"progress"in l&&(k=l.progress)}if(a instanceof
Blob){var h=new FileReader;h.onprogress=function(a){"[object Function]"===Object.prototype.toString.call(k)&&k(a)};h.onerror=function(a){if("[object Function]"===Object.prototype.toString.call(f)){var b="";switch(h.error.code){case h.error.NOT_FOUND_ERR:b="NOT_FOUND_ERR";break;case h.error.SECURITY_ERR:b="SECURITY_ERR";break;case h.error.ABORT_ERR:b="ABORT_ERR";break;case h.error.NOT_READABLE_ERR:b="NOT_READABLE_ERR";break;case h.error.ENCODING_ERR:b="ENCODING_ERR";break;default:b="ERR"}f(a,b)}};
h.onload=function(a){if("[object Function]"===Object.prototype.toString.call(d)){var b=h.result;"[object String]"===Object.prototype.toString.call(b)&&-1===b.indexOf("data:")&&-1===b.indexOf("blob:")&&(b=b.replace(/<(\/?script.*?)>/gi,"&lt;$1&gt;"));d(a,b)}};/arraybuffer/i.test(b)?h.readAsArrayBuffer(a):/dataurl/i.test(b)?h.readAsDataURL(a):/text/i.test(b)?h.readAsText(a,"utf-8"):g(this+' read() : The 1st argument is one of "ArrayBuffer", "DataURL", "Text". !!')}else"[object Function]"===Object.prototype.toString.call(f)&&
f(null,"FILE_IS_NOT_BLOB")},U=function(a,b,d,f,k){if("[object Object]"===Object.prototype.toString.call(a)){var l=a;"event"in l&&(a=l.event);"type"in l&&(b=l.type);"success"in l&&(d=l.success);"error"in l&&(f=l.error);"progress"in l&&(k=l.progress)}if(a instanceof Event){l=null;if("drop"===a.type)a.stopImmediatePropagation(),a.preventDefault(),l=a.dataTransfer.files[0];else if("change"===a.type&&"files"in a.target)l=a.target.files[0];else{g(this+' file() : The event object is either "drop" or file form\'s "change" !!');
return}if(l instanceof File){if(/text/i.test(b)&&-1===l.type.indexOf("text"))throw Error("Please upload text file !!");if(/arraybuffer|dataurl/i.test(b)&&-1===l.type.indexOf("audio"))throw Error("Please upload audio file !!");this.read({file:l,type:b,success:d,error:f,progress:k});return l}throw Error("Please upload file !!");}g(this+" file() : The 1st argument is event object !!")},V=function(a,b,d,f,k){if("[object Object]"===Object.prototype.toString.call(a)){var g=a;"url"in g&&(a=g.url);"timeout"in
g&&(b=g.timeout);"success"in g&&(d=g.success);"error"in g&&(f=g.error);"progress"in g&&(k=g.progress)}var h=new XMLHttpRequest;void 0===G||G?h.responseType="arraybuffer":h.overrideMimeType("text/plain; charset=x-user-defined");b=parseInt(b);var n=v.setTimeout(function(){h.abort();"[object Function]"===Object.prototype.toString.call(f)&&f(h,"timeout")},0<b?b:6E4);h.onreadystatechange=function(){h.readyState===h.LOADING&&"[object Function]"===Object.prototype.toString.call(k)&&k(h);if(h.readyState===
h.DONE&&(v.clearTimeout(n),200===h.status)){var b=null;if(void 0===G||G)b=h.response,b instanceof ArrayBuffer&&"[object Function]"===Object.prototype.toString.call(d)&&d(h,b);else{for(var g=h.responseText,l=[],r=0,q=g.length;r<q;r++)l.push(g.charCodeAt(r)&255);var g="audio/"+a.slice(-3),l=new Blob([new Uint8Array(l)],{type:g}),s=new FileReader;s.readAsArrayBuffer(l);s.onerror=function(a){if("[object Function]"===Object.prototype.toString.call(f)){var b="";switch(s.error.code){case s.error.NOT_FOUND_ERR:b=
"NOT_FOUND_ERR";break;case s.error.SECURITY_ERR:b="SECURITY_ERR";break;case s.error.ABORT_ERR:b="ABORT_ERR";break;case s.error.NOT_READABLE_ERR:b="NOT_READABLE_ERR";break;case s.error.ENCODING_ERR:b="ENCODING_ERR";break;default:b="ERR"}f(a,b)}};s.onload=function(){b=s.result;b instanceof ArrayBuffer&&"[object Function]"===Object.prototype.toString.call(d)&&d(h,b)}}}};h.onerror=function(){"[object Function]"===Object.prototype.toString.call(f)&&f(h,"error")};h.open("GET",a,!0);h.send(null)},W=function(a){var b=
Math.pow(2,1/12);Array.isArray(a)||(a=[a]);for(var d=Array(a.length),f=0,k=a.length;f<k;f++){var g=parseInt(a[f]);d[f]=0<=g?27.5*Math.pow(b,g):0}return d},X=function(a){a=parseFloat(a);if(0<=a)return{minutes:Math.floor(a/60),seconds:Math.floor(a%60)};g(this+" convertTime() : The range of the 1st argument is between 0 and audio duration !!")},Y=function(a){v.X===r&&(v.X=void 0);a&&v.XSound===r&&(v.XSound=void 0);return r};B.prototype.setup=function(a,b,d,f){if("[object Object]"===Object.prototype.toString.call(a)){var k=
a;"id"in k&&(a=k.id);"type"in k&&(b=k.type);"formats"in k&&(d=k.formats);"callbacks"in k&&(f=k.callbacks)}k=String(a);b="video"!==String(b).toLowerCase()?"audio":"video";this.media=null!==a&&""!==k?document.getElementById(k):document.createElement(b);if(this.media instanceof HTMLMediaElement){Array.isArray(d)||(d=[d]);a=0;for(k=d.length;a<k;a++){var l=b+"/"+String(d[a]).toLowerCase();if(/^(?:maybe|probably)/.test(this.media.canPlayType(l))){this.ex=d[a];break}}if(""===this.ex)throw Error("Media format that can be played does not exist !!");
if("[object Object]"===Object.prototype.toString.call(f))for(var h in f)this.callbacks[h.toLowerCase()]="[object Function]"===Object.prototype.toString.call(f[h])?f[h]:function(){};var n=this;for(h in this.callbacks)switch(h){case "loadedmetadata":this.media.addEventListener("loadedmetadata",function(a){n.duration=this.duration;n.callbacks.loadedmetadata(a,this)},!1);break;default:this.media.addEventListener(h,function(a){n.callbacks[a.type.toLowerCase()](a,this)},!1)}return this}this.media=null;
g(this+" setup() : The media element that has the designated ID does not exists !!")};B.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "mastervolume":if(void 0===b)return this.media instanceof HTMLMediaElement?this.media.volume:this.volume;var f=parseFloat(b),k=0;d=1;f>=k&&f<=d?(this.media instanceof HTMLMediaElement&&(this.media.volume=f),this.volume=f):g(this+
" param() : The range of "+a+" is between "+k+" and "+d+" !!");break;case "playbackrate":if(void 0===b)return this.media instanceof HTMLMediaElement?this.media.playbackRate:this.playbackRate;f=parseFloat(b);0.5<=f?(this.media instanceof HTMLMediaElement&&(this.media.playbackRate=f),this.playbackRate=f):g(this+" param() : The range of "+a+" is greater than or equal 0.5 !!");break;case "currenttime":if(void 0===b)return this.media instanceof HTMLMediaElement?this.media.currentTime:0;f=parseFloat(b);
if(this.media instanceof HTMLMediaElement)k=0,d=this.duration;else return;f>=k&&f<=d?this.media.currentTime=f:g(this+" param() : The range of "+a+" is between "+k+" and "+d+" !!");break;case "loop":case "muted":case "controls":if(void 0===b)return this.media instanceof HTMLMediaElement?this.media[d]:this[d];this.media instanceof HTMLMediaElement&&(this.media[d]=Boolean(b));this[d]=Boolean(b);break;case "width":case "height":if(void 0===b)return this.media instanceof HTMLVideoElement?this.media[d]:
0;f=parseInt(b);k=0;f>=k?this.media instanceof HTMLVideoElement&&(this.media[d]=f):g(this+" param() : The range of "+a+" is greater than or equal "+k+" !!");break;case "duration":return this.duration;case "channels":return;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};B.prototype.ready=function(a){a=String(a);try{-1!==a.indexOf("data:")||-1!==a.indexOf("blob:")?this.media.src=a:this.media.src=a+"."+this.ex}catch(b){throw Error("The designated resource cannot be loaded !!");
}return this};B.prototype.start=function(a){this.media instanceof HTMLMediaElement&&this.media.paused&&(this.media.play(),a=parseFloat(a),this.media.currentTime=0<=a&&a<=this.duration?a:0,this.media.playbackRate=this.playbackRate,this.media.controls=this.controls,this.media.loop=this.loop,this.media.muted=this.muted);return this};B.prototype.stop=function(){this.media instanceof HTMLMediaElement&&!this.media.paused&&this.media.pause();return this};B.prototype.toggle=function(a){this.media instanceof
HTMLMediaElement&&(this.media.paused?this.start(a):this.stop());return this};B.prototype.getMedia=function(){return this.media};B.prototype.isMedia=function(){return this.media instanceof HTMLMediaElement?!0:!1};B.prototype.isSource=function(){return this.isMedia()};B.prototype.isPaused=function(){return this.media instanceof HTMLMediaElement?this.media.paused:!0};B.prototype.fullscreen=function(){if(this.media instanceof HTMLVideoElement)if(this.media.webkitRequestFullscreen)this.media.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
else if(this.media.mozRequestFullScreen)this.media.mozRequestFullScreen();else if(this.media.requestFullscreen)this.media.requestFullscreen();else throw Error("Cannot change to full screen !!");return this};B.prototype.exitFullscreeen=function(){if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullscreen)document.mozCancelFullscreen();else if(document.exitFullscreen)document.exitFullscreen();else throw Error("Cannot exit from full screen !!");return this};
B.prototype.toString=function(){return"MediaFallbackModule"};if(Q){v.AudioContext=v.AudioContext||v.webkitAudioContext;audiocontext=new AudioContext;audiocontext.createScriptProcessor=audiocontext.createScriptProcessor||audiocontext.createJavaScriptNode;audiocontext.createGain=audiocontext.createGain||audiocontext.createGainNode;audiocontext.createDelay=audiocontext.createDelay||audiocontext.createDelayNode;audiocontext.createPeriodicWave=audiocontext.createPeriodicWave||audiocontext.createWaveTable;
N.prototype.state=function(a){if(void 0===a)return this.isActive;"toggle"===String(a).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(a);return this};s.prototype.setup=function(){};s.prototype.param=function(a,b){switch(String(a).replace(/-/g,"").toLowerCase()){case "mastervolume":if(void 0===b)return this.masterVolume.gain.value;var d=parseFloat(b),f=this.masterVolume.gain.minValue||0,k=this.masterVolume.gain.maxValue||1;d>=f&&d<=k?this.masterVolume.gain.value=d:g(this+" param() : The range of "+
a+" is between "+f+" and "+k+" !!")}};s.prototype.ready=function(){};s.prototype.start=function(){};s.prototype.stop=function(){};s.prototype.getContext=function(){return this.context};s.prototype.resize=function(a){s.call(this,audiocontext,a);return this};s.prototype.connect=function(a,b){Array.isArray(b)&&(this.nodes=b);for(var d=[],f=0,k=this.nodes.length;f<k;f++)this.nodes[f].isActive?d.push(this.nodes[f]):this.nodes[f].output.disconnect(0);a.disconnect(0);0<d.length?a.connect(d[0].input):a.connect(this.masterVolume);
f=0;for(k=d.length;f<k;f++)d[f].output.disconnect(0),f<d.length-1?d[f].output.connect(d[f+1].input):d[f].output.connect(this.masterVolume);this.masterVolume.connect(this.analyser.input);this.analyser.output.connect(this.context.destination);this.masterVolume.connect(this.recorder.processor);this.recorder.processor.connect(this.context.destination);this.masterVolume.connect(this.session.sender);this.session.sender.connect(this.context.destination);return this};s.prototype.module=function(a){var b=
String(a).replace(/-/g,"").toLowerCase();switch(b){case "listener":case "analyser":case "recorder":case "session":case "compressor":case "distortion":case "wah":case "equalizer":case "filter":case "tremolo":case "ringmodulator":case "autopanner":case "phaser":case "flanger":case "chorus":case "delay":case "reverb":case "panner":return this[b];case "eg":if(b in this)return this[b];case "glide":if(b in this)return this[b];case "vocalcanceler":if(b in this)return this[b];default:for(var d=0,f=this.plugins.length;d<
f;d++)if(b===this.plugins[d].name)return this.plugins[d].plugin;g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}};s.prototype.install=function(a,b){"[object Function]"===Object.prototype.toString.call(b)?(b.prototype=new this.Effector(audiocontext,this.BUFFER_SIZE),this.plugins.push({name:String(a).toLowerCase(),plugin:new b(audiocontext)})):g(this+" install() : The 1st argument is class (function) for created effector !!");return this};s.prototype.toString=
function(){return"SoundModule"};E.prototype=w(s.prototype);E.prototype.constructor=E;E.prototype.setup=function(a){function b(a,b){this.isActive=Boolean(b);this.source=a.createOscillator();this.source.start=this.source.start||this.source.noteOn;this.source.stop=this.source.stop||this.source.noteOff;this.volume=a.createGain();this.isStart=!1;this.fine=this.octave=0}b.prototype=implement(N.prototype);b.prototype.constructor=b;Array.isArray(a)||(a=[a]);for(var d=0,f=a.length;d<f;d++)this.sources[d]=
new b(this.context,Boolean(a[d])),this.eg.generators[d]=this.context.createGain(),this.eg.generators[d].gain.setTargetAtTime=this.eg.generators[d].gain.setTargetAtTime||this.eg.generators[d].gain.setTargetValueAtTime;b.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else switch(d=String(a).replace(/-/g,"").toLowerCase(),d){case "type":if(void 0===b)return this.type;d=String(b).toLowerCase();this.source.SINE=this.source.SINE||
0;this.source.SQUARE=this.source.SQUARE||1;this.source.SAWTOOTH=this.source.SAWTOOTH||2;this.source.TRIANGLE=this.source.TRIANGLE||3;var f={sine:this.source.SINE,square:this.source.SQUARE,sawtooth:this.source.SAWTOOTH,triangle:this.source.TRIANGLE};d in f?this.source.type="[object String]"===Object.prototype.toString.call(this.source.type)?d:f[d]:g(this+' param() : The value of "'+a+'" is one of "sine", "square", "sawtooth", "triangle" !!');break;case "octave":if(void 0===b)return this.octave;d=this.octave=
parseFloat(b);var f=(this.source.detune.minValue||-4800)/1200,p=(this.source.detune.maxValue||4800)/1200;d>=f&&d<=p?this.source.detune.value=this.fine+1200*d:g(this+" param() : The range of "+a+" is between "+f+" and "+p+" !!");break;case "fine":if(void 0===b)return this.fine;d=this.fine=parseFloat(b);f=-1200;p=1200;d>=f&&d<=p?this.source.detune.value=d+1200*this.octave:g(this+" param() : The range of "+a+" is between "+f+" and "+p+" !!");break;case "volume":case "gain":if(void 0===b)return this.volume.gain.value;
d=parseFloat(b);f=this.volume.gain.minValue||0;p=this.volume.gain.maxValue||1;d>=f&&d<=p?this.volume.gain.value=d:g(this+" param() : The range of "+a+" is between "+f+" and "+p+" !!");break;default:g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}return this};b.prototype.toString=function(){return"OscillatorModule Oscillator"};return this};E.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,
a[d]);else{d=String(a).replace(/-/g,"").toLowerCase();var f=s.prototype.param.call(this,d,b)}return void 0===f?this:f};E.prototype.ready=function(a,b){var d=parseFloat(a),f=parseFloat(b);0<d&&(this.times.start=d);f>d&&(this.times.stop=f);return this};E.prototype.start=function(a,b,d){var f=this.context.currentTime+this.times.start;Array.isArray(a)||(a=[a]);if(a.length<this.sources.length)for(var g=this.sources.length-a.length,l=0;l<g;l++)a.push(0);l=0;for(g=a.length;l<g;l++){var h=parseFloat(a[l]);
a[l]=0<=h?h:0}this.eg.clear();this.processor.disconnect(0);this.processor.onaudioprocess=function(){};this.connect(this.processor,b);l=0;for(g=this.sources.length;l<g;l++)if(b=this.sources[l],b.isActive){h=a.shift();this.glide.ready(h);if(b.isStart){var n,p,h=b.source.type;n=b.source.frequency.value;p=b.source.detune.value;b.source.stop(0);b.source=this.context.createOscillator();b.source.start=b.source.start||b.source.noteOn;b.source.stop=b.source.stop||b.source.noteOff;b.source.type=h;b.source.frequency.value=
n;b.source.detune.value=p}this.eg.ready(l,b.source,b.volume);b.volume.connect(this.processor);b.source.start(f);this.glide.start(b.source,f);b.isStart=!0}else b.source.disconnect(0);this.eg.start(f);this.chorus.start(f);this.flanger.start(f);this.phaser.start(f);this.autopanner.start(f);this.tremolo.start(f);this.ringmodulator.start(f);this.wah.start(f);this.filter.start(f);l=0;for(g=this.plugins.length;l<g;l++)this.plugins[l].plugin.isActive&&this.plugins[l].plugin.start(f);this.isAnalyser||(this.analyser.start("time"),
this.analyser.start("fft"),this.isAnalyser=!0);"[object Function]"===Object.prototype.toString.call(d)?this.processor.onaudioprocess=d:this.processor.onaudioprocess=function(a){var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),f=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);f.set(b);a.set(d)};return this};E.prototype.stop=function(a){var b=this.context.currentTime+this.times.stop;this.eg.stop(b);this.glide.stop();this.filter.stop(b);for(var d=0,f=this.plugins.length;d<
f;d++)this.plugins[d].plugin.isActive&&this.plugins[d].plugin.stop(b,this.eg.release);var g=this;void 0===G||G||v.setTimeout(function(){g.chorus.stop(0);g.flanger.stop(0);g.phaser.stop(0);g.autopanner.stop(0);g.tremolo.stop(0);g.ringmodulator.stop(0);g.wah.stop(0);g.analyser.stop("time");g.analyser.stop("fft");g.isAnalyser=!1;g.processor.disconnect(0);g.processor.onaudioprocess=function(){}},1E3*(this.times.stop+this.eg.release));"[object Function]"===Object.prototype.toString.call(a)?this.processor.onaudioprocess=
a:this.processor.onaudioprocess=function(a){var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),f=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);f.set(b);a.set(d);g.eg.isStop()&&(g.chorus.stop(0),g.flanger.stop(0),g.phaser.stop(0),g.autopanner.stop(0),g.tremolo.stop(0),g.ringmodulator.stop(0),g.wah.stop(0),g.analyser.stop("time"),g.analyser.stop("fft"),g.isAnalyser=!1,this.disconnect(0))};return this};E.prototype.toString=function(){return"OscillatorModule"};
F.prototype=w(s.prototype);F.prototype.constructor=F;F.prototype.setup=function(a,b,d,f,k,l){if("[object Object]"===Object.prototype.toString.call(a)){var h=a;"resources"in h&&(a=h.resources);"settings"in h&&(b=h.settings);"timeout"in h&&(d=h.timeout);"success"in h&&(f=h.success);"error"in h&&(k=h.error);"progress"in h&&(l=h.progress)}Array.isArray(a)||(a=[a]);this.resources=a;Array.isArray(b)||(b=[b]);this.buffers.length=a.length;a=0;for(h=b.length;a<h;a++){if("buffer"in b[a])if(h=parseInt(b[a].buffer),
0<=h&&h<this.buffers.length)b[a].buffer=h;else{g(this+' setup() : The "buffer" property in the 2nd argument is number type between 0 and '+(this.buffers.length-1)+" !!");return}else{g(this+' setup() : The element of array in the 2nd argument  requires "buffer" property !!');return}b[a].rate="rate"in b[a]&&0<=b[a].rate?parseFloat(b[a].rate):1;b[a].loop="loop"in b[a]?Boolean(b[a].loop):!1;b[a].start="start"in b[a]&&0<=b[a].start?parseFloat(b[a].start):0;b[a].end="end"in b[a]&&0<=b[a].end?parseFloat(b[a].end):
0;b[a].volume="volume"in b[a]&&0<=b[a].volume&&1>=b[a].volume?parseFloat(b[a].volume):1;a=0;for(h=b.length;a<h;a++)this.isStarts[a]=!1,this.volumes[a]=this.context.createGain(),this.eg.generators[a]=this.context.createGain(),this.eg.generators[a].gain.setTargetAtTime=this.eg.generators[a].gain.setTargetAtTime||this.eg.generators[a].gain.setTargetValueAtTime;this.settings=b}var n=parseInt(d),p=!1,r=this;b=function(a,b){var d=new XMLHttpRequest;void 0===G||G?d.responseType="arraybuffer":d.overrideMimeType("text/plain; charset=x-user-defined");
var g=v.setTimeout(function(){d.abort();p||"[object Function]"!==Object.prototype.toString.call(k)||k(d,"timeout");p=!0},0<n?n:6E4);d.onreadystatechange=function(){if(p)d.abort();else if(d.readyState===d.LOADING)"[object Function]"===Object.prototype.toString.call(l)&&l(d);else if(d.readyState===d.DONE&&(v.clearTimeout(g),200===d.status)){var h=null,n=function(a){a instanceof ArrayBuffer&&r.context.decodeAudioData(a,function(a){r.buffers[b]=a;a=0;for(var d=r.buffers.length;a<d;a++)if(void 0===r.buffers[a])return;
"[object Function]"===Object.prototype.toString.call(f)&&f.call(r,r.buffers)},function(a){"[object Function]"===Object.prototype.toString.call(k)&&k(a,"decode")})};if(void 0===G||G)h=d.response,n.call(r,h);else{for(var s=d.responseText,z=[],A=0,B=s.length;A<B;A++)z.push(s.charCodeAt(A)&255);var s="audio/"+a.slice(-3),z=new Blob([new Uint8Array(z)],{type:s}),w=new FileReader;w.readAsArrayBuffer(z);w.onerror=function(a){if("[object Function]"===Object.prototype.toString.call(k)){var b="";switch(w.error.code){case w.error.NOT_FOUND_ERR:b=
"NOT_FOUND_ERR";break;case w.error.SECURITY_ERR:b="SECURITY_ERR";break;case w.error.ABORT_ERR:b="ABORT_ERR";break;case w.error.NOT_READABLE_ERR:b="NOT_READABLE_ERR";break;case w.error.ENCODING_ERR:b="ENCODING_ERR";break;default:b="ERR"}k(a,b)}};w.onload=function(){h=w.result;n.call(r,h)}}}};d.onerror=function(){p||"[object Function]"!==Object.prototype.toString.call(k)||k(d,"error");p=!0};d.open("GET",a,!0);d.send(null)};a=0;for(h=this.resources.length;a<h;a++)"[object String]"===Object.prototype.toString.call(this.resources[a])?
b.call(this,this.resources[a],a):this.resources[a]instanceof AudioBuffer&&(this.buffers[a]=this.resources[a],a===h-1&&f.call(this,this.buffers));return this};F.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else{d=String(a).replace(/-/g,"").toLowerCase();var f=s.prototype.param.call(this,d,b)}return void 0===f?this:f};F.prototype.ready=function(a,b){var d=parseFloat(a),f=parseFloat(b);0<d&&(this.times.start=d);f>d&&(this.times.stop=
f);return this};F.prototype.start=function(a,b,d){if(0<=a&&a<this.settings.length){var f=parseInt(a),k=this.settings[f].buffer,l=this.settings[f].rate,h=this.settings[f].loop,n=this.settings[f].start,p=this.settings[f].end,r=this.settings[f].volume;if(void 0!==this.buffers[k]){void 0!==this.sources[f]&&(this.sources[f].stop(0),this.sources[f].disconnect(0),delete this.sources[f]);a=this.context.createBufferSource();a.buffer=this.buffers[k];a.playbackRate.value=l;a.loop=h;a.loopStart=n;a.loopEnd=p;
this.volumes[f].gain.value=r;this.eg.ready(f,a,this.volumes[f]);this.volumes[f].connect(this.processor);this.connect(this.processor,b);b=this.context.currentTime+this.times.start;a.start=a.start||a.noteGrainOn;a.stop=a.stop||a.noteOff;a.start(b);a.onended=function(){this.isStarts[f]=!1}.bind(this);this.sources[f]=a;this.eg.start(b);this.chorus.start(b);this.flanger.start(b);this.phaser.start(b);this.autopanner.start(b);this.tremolo.start(b);this.ringmodulator.start(b);this.wah.start(b);this.filter.start(b);
a=0;for(k=this.plugins.length;a<k;a++)this.plugins[a].plugin.isActive&&this.plugins[a].plugin.start(b);this.isAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.isAnalyser=!0);this.isStarts[f]=!0;var x=this;"[object Function]"===Object.prototype.toString.call(d)?this.processor.onaudioprocess=d:this.processor.onaudioprocess=function(a){if(x.isStarts.some(function(a,b,d){return a})){var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),f=a.outputBuffer.getChannelData(0);
a=a.outputBuffer.getChannelData(1);f.set(b);a.set(d)}else x.chorus.stop(),x.flanger.stop(),x.phaser.stop(),x.autopanner.stop(),x.tremolo.stop(),x.ringmodulator.stop(),x.wah.stop(),x.eg.clear(),x.analyser.stop("time"),x.analyser.stop("fft"),x.isAnalyser=!1,x.processor.disconnect(0),x.processor.onaudioprocess=function(){}};return this}}else g(this+" start() : The 1st argument is number type between 0 and "+(this.settings.length-1)+" !!")};F.prototype.stop=function(a){if(0<=a&&a<this.settings.length){if(a=
parseInt(a),void 0!==this.buffers[this.settings[a].buffer]&&void 0!==this.sources[a]){a=this.context.currentTime+this.times.stop;this.eg.stop(a);this.filter.stop(a);for(var b=0,d=this.plugins.length;b<d;b++)this.plugins[b].plugin.isActive&&this.plugins[b].plugin.stop(a,this.eg.release);return this}}else g(this+" stop() : The 1st argument is number type between 0 and "+(this.settings.length-1)+" !!")};F.prototype.toString=function(){return"OneshotModule"};z.prototype=w(s.prototype);z.prototype.constructor=
z;z.prototype.setup=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.setup(d,a[d]);else d=String(a).replace(/-/g,"").toLowerCase(),d in this.callbacks?"[object Function]"===Object.prototype.toString.call(b)?this.callbacks[d]=b:g(this+' setup() : The type of "'+a+'" is function !!'):g(this+' setup() : The designated property ("'+a+'") does not exist in accessible properties !!');return this};z.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,
a[d]);else{d=String(a).replace(/-/g,"").toLowerCase();var f=s.prototype.param.call(this,d,b);if(void 0!==f)return f;switch(d){case "playbackrate":if(void 0===b)return this.source.playbackRate.value;d=parseFloat(b);var f=this.source.playbackRate.minValue||0,k=this.source.playbackRate.maxValue||1024;d>=f&&d<=k?this.source.playbackRate.value=d:g(this+" param() : The range of "+a+" is between "+f+" and "+k+" !!");break;case "loop":case "looping":if(void 0===b)return this.source.loop;this.source.loop=
Boolean(b);break;case "currenttime":if(void 0===b)return this.currentTime;d=parseFloat(b);if(this.buffer instanceof AudioBuffer)k=this.buffer.duration,f=0;else{this.currentTime=0;break}d>=f&&d<=k?this.paused?(this.stop(),this.currentTime=d):(this.stop(),this.start(d)):g(this+" param() : The range of "+a+" is between "+f+" and "+k+" !!");break;case "duration":return this.buffer instanceof AudioBuffer?this.buffer.duration:0;case "samplerate":return this.buffer instanceof AudioBuffer?this.buffer.sampleRate:
this.SAMPLE_RATE;case "channels":return this.buffer instanceof AudioBuffer?this.buffer.numberOfChannels:0;default:"mastervolume"!==d&&g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}}return this};z.prototype.ready=function(a){a instanceof ArrayBuffer?(this.context.decodeAudioData(a,function(a){this.buffer=a;this.analyser.start("time-all-L",a);this.analyser.start("time-all-R",a);this.callbacks.ready(a)}.bind(this),this.callbacks.error.bind(this)),this.callbacks.decode(a)):
g(this+" ready() : The 1st argument is ArrayBuffer for audio !!");return this};z.prototype.start=function(a,b,d){if(this.buffer instanceof AudioBuffer&&this.paused){a=parseFloat(a);this.currentTime=0<=a&&a<=this.buffer.duration?a:0;var f=this.source.playbackRate.value,g=this.source.loop;this.source=this.context.createBufferSource();this.source.buffer=this.buffer;this.source.playbackRate.value=f;this.source.loop=g;void 0===G||G?(this.source.connect(this.processor),this.connect(this.processor,b)):this.connect(this.source,
b);this.source.start=this.source.start||this.source.noteGrainOn;this.source.stop=this.source.stop||this.source.noteOff;this.source.start(0,a,this.buffer.duration-a);this.analyser.start("time");this.analyser.start("fft");this.paused=!1;this.chorus.start(this.context.currentTime);this.flanger.start(this.context.currentTime);this.phaser.start(this.context.currentTime);this.autopanner.start(this.context.currentTime);this.tremolo.start(this.context.currentTime);this.ringmodulator.start(this.context.currentTime);
this.wah.start(this.context.currentTime);b=0;for(a=this.plugins.length;b<a;b++)this.plugins[b].plugin.isActive&&this.plugins[b].plugin.start(this.context.currentTime);this.callbacks.start(this.source,this.currentTime);var l=this;"[object Function]"===Object.prototype.toString.call(d)?this.processor.onaudioprocess=d:this.processor.onaudioprocess=function(a){var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),f=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);
if(l.currentTime<Math.floor(l.source.buffer.duration)){for(var g=0;g<this.bufferSize;g++)f[g]=l.vocalcanceler.start(b[g],d[g]),a[g]=l.vocalcanceler.start(d[g],b[g]),l.currentTime+=1*l.source.playbackRate.value/l.source.buffer.sampleRate,0===Math.floor(l.currentTime*l.source.buffer.sampleRate)%(1*l.source.buffer.sampleRate)&&l.callbacks.update(l.source,l.currentTime);l.analyser.timeAllL.update(l.currentTime);l.analyser.timeAllR.update(l.currentTime)}else l.source.loop?l.currentTime=0:l.end.call(l)}}return this};
z.prototype.stop=function(){if(this.buffer instanceof AudioBuffer&&!this.paused){this.source.stop(this.context.currentTime);this.chorus.stop(this.context.currentTime);this.flanger.stop(this.context.currentTime);this.phaser.stop(this.context.currentTime);this.autopanner.stop(this.context.currentTime);this.tremolo.stop(this.context.currentTime);this.ringmodulator.stop(this.context.currentTime);this.wah.stop(this.context.currentTime);for(var a=0,b=this.plugins.length;a<b;a++)this.plugins[a].plugin.isActive&&
this.plugins[a].plugin.stop(this.context.currentTime);this.analyser.stop("time");this.analyser.stop("fft");this.processor.disconnect(0);this.processor.onaudioprocess=function(){};this.paused=!0;this.callbacks.stop(this.source,this.currentTime)}return this};z.prototype.toggle=function(a,b,d){this.paused?this.start(a,b,d):this.stop();return this};z.prototype.end=function(){this.stop();this.currentTime=0;this.callbacks.ended(this.source,this.currentTime);return this};z.prototype.isBuffer=function(){return this.buffer instanceof
AudioBuffer?!0:!1};z.prototype.isSource=function(){return this.source instanceof AudioBufferSourceNode&&this.source.buffer instanceof AudioBuffer?!0:!1};z.prototype.isPaused=function(){return this.paused};z.prototype.toString=function(){return"AudioModule"};A.prototype=w(z.prototype);A.prototype.constructor=A;A.prototype.setup=function(a,b,d,f){if("[object Object]"===Object.prototype.toString.call(a)){var k=a;"id"in k&&(a=k.id);"type"in k&&(b=k.type);"formats"in k&&(d=k.formats);"callbacks"in k&&
(f=k.callbacks)}k=String(a);b="video"!==String(b).toLowerCase()?"audio":"video";this.media=null!==a&&""!==k?document.getElementById(k):document.createElement(b);if(this.media instanceof HTMLMediaElement){Array.isArray(d)||(d=[d]);a=0;for(k=d.length;a<k;a++){var l=b+"/"+String(d[a]).toLowerCase();if(/^(?:maybe|probably)/.test(this.media.canPlayType(l))){this.ex=d[a];break}}if(""===this.ex)throw Error("Media format that can be played does not exist !!");if("[object Object]"===Object.prototype.toString.call(f))for(var h in f)this.callbacks[h.toLowerCase()]=
"[object Function]"===Object.prototype.toString.call(f[h])?f[h]:function(){};var n=this;for(h in this.callbacks)switch(h){case "loadstart":this.media.addEventListener("loadstart",function(a){null===n.source&&(n.source=n.context.createMediaElementSource(this));n.callbacks.loadstart(a,this)},!1);break;case "loadedmetadata":this.media.addEventListener("loadedmetadata",function(a){n.duration=this.duration;n.callbacks.loadedmetadata(a,this)},!1);break;case "ended":this.media.addEventListener("ended",function(a){this.pause();
n.chorus.stop(n.context.currentTime);n.flanger.stop(n.context.currentTime);n.phaser.stop(n.context.currentTime);n.autopanner.stop(n.context.currentTime);n.tremolo.stop(n.context.currentTime);n.ringmodulator.stop(n.context.currentTime);n.wah.stop(n.context.currentTime);for(var b=0,d=n.plugins.length;b<d;b++)n.plugins[b].plugin.isActive&&n.plugins[b].plugin.stop(n.context.currentTime);n.analyser.stop("time");n.analyser.stop("fft");n.processor.disconnect(0);n.processor.onaudioprocess=function(){};n.callbacks.ended(a,
this)},!1);break;default:this.media.addEventListener(h,function(a){n.callbacks[a.type.toLowerCase()](a,this)},!1)}return this}this.media=null;g(this+" setup() : The media element that has the designated ID does not exists !!")};A.prototype.param=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.param(d,a[d]);else{d=String(a).replace(/-/g,"").toLowerCase();var f=s.prototype.param.call(this,d,b);if(void 0!==f)return f;switch(d){case "playbackrate":if(void 0===
b)return this.media instanceof HTMLMediaElement?this.media.playbackRate:this.playbackRate;var f=parseFloat(b),k;0.5<=f?(this.media instanceof HTMLMediaElement&&(this.media.playbackRate=f),this.playbackRate=f):g(this+" param() : The range of "+a+" is greater than or equal 0.5 !!");break;case "currenttime":if(void 0===b)return this.media instanceof HTMLMediaElement?this.media.currentTime:0;f=parseFloat(b);if(this.media instanceof HTMLMediaElement)k=0,d=this.duration;else return;f>=k&&f<=d?this.media.currentTime=
f:g(this+" param() : The range of "+a+" is between "+k+" and "+d+" !!");break;case "loop":case "muted":case "controls":if(void 0===b)return this.media instanceof HTMLMediaElement?this.media[d]:this[d];this.media instanceof HTMLMediaElement&&(this.media[d]=Boolean(b));this[d]=Boolean(b);break;case "width":case "height":if(void 0===b)return this.media instanceof HTMLVideoElement?this.media[d]:0;f=parseInt(b);k=0;f>=k?this.media instanceof HTMLVideoElement&&(this.media[d]=f):g(this+" param() : The range of "+
a+" is greater than or equal "+k+" !!");break;case "duration":return this.duration;case "channels":return this.source instanceof MediaElementAudioSourceNode?this.source.channelCount:0;default:"mastervolume"!==d&&g(this+' param() : The designated property ("'+a+'") does not exist in accessible properties !!')}}return this};A.prototype.ready=function(a){a=String(a);try{-1!==a.indexOf("data:")||-1!==a.indexOf("blob:")?this.media.src=a:this.media.src=a+"."+this.ex}catch(b){throw Error("The designated resource cannot be loaded !!");
}return this};A.prototype.start=function(a,b,d){if(this.source instanceof MediaElementAudioSourceNode&&this.media.paused){this.source.connect(this.processor);this.connect(this.processor,b);this.media.play();a=parseFloat(a);this.media.currentTime=0<=a&&a<=this.duration?a:0;this.media.playbackRate=this.playbackRate;this.media.controls=this.controls;this.media.loop=this.loop;this.media.muted=this.muted;this.chorus.start(this.context.currentTime);this.flanger.start(this.context.currentTime);this.phaser.start(this.context.currentTime);
this.autopanner.start(this.context.currentTime);this.tremolo.start(this.context.currentTime);this.ringmodulator.start(this.context.currentTime);this.wah.start(this.context.currentTime);a=0;for(b=this.plugins.length;a<b;a++)this.plugins[a].plugin.isActive&&this.plugins[a].plugin.start(this.context.currentTime);this.analyser.start("time");this.analyser.start("fft");var f=this;"[object Function]"===Object.prototype.toString.call(d)?this.processor.onaudioprocess=d:this.processor.onaudioprocess=function(a){var b=
a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),g=a.outputBuffer.getChannelData(0);a=a.outputBuffer.getChannelData(1);for(var p=0;p<this.bufferSize;p++)g[p]=f.vocalcanceler.start(b[p],d[p]),a[p]=f.vocalcanceler.start(d[p],b[p])}}return this};A.prototype.stop=function(){if(this.source instanceof MediaElementAudioSourceNode&&!this.media.paused){this.media.pause();this.chorus.stop(this.context.currentTime);this.flanger.stop(this.context.currentTime);this.phaser.stop(this.context.currentTime);
this.autopanner.stop(this.context.currentTime);this.tremolo.stop(this.context.currentTime);this.ringmodulator.stop(this.context.currentTime);this.wah.stop(this.context.currentTime);for(var a=0,b=this.plugins.length;a<b;a++)this.plugins[a].plugin.isActive&&this.plugins[a].plugin.stop(this.context.currentTime);this.analyser.stop("time");this.analyser.stop("fft");this.processor.disconnect(0);this.processor.onaudioprocess=function(){}}return this};A.prototype.toggle=function(a,b,d){this.media instanceof
HTMLMediaElement&&(this.media.paused?this.start(a,b,d):this.stop());return this};A.prototype.getMedia=function(){return this.media};A.prototype.isMedia=function(){return this.media instanceof HTMLMediaElement?!0:!1};A.prototype.isSource=function(){return this.source instanceof MediaElementAudioSourceNode?!0:!1};A.prototype.isPaused=function(){return this.media instanceof HTMLMediaElement?this.media.paused:!0};A.prototype.fullscreen=function(){if(this.media instanceof HTMLVideoElement)if(this.media.webkitRequestFullscreen)this.media.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
else if(this.media.mozRequestFullScreen)this.media.mozRequestFullScreen();else if(this.media.requestFullscreen)this.media.requestFullscreen();else throw Error("Cannot change to full screen !!");return this};A.prototype.exitFullscreeen=function(){if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullscreen)document.mozCancelFullscreen();else if(document.exitFullscreen)document.exitFullscreen();else throw Error("Cannot exit from full screen !!");return this};
A.prototype.toString=function(){return"MediaModule"};H.prototype.setup=function(a,b){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)this.setup(d,a[d]);else d=String(a).toLowerCase(),d in this.callbacks?"[object Function]"===Object.prototype.toString.call(b)?this.callbacks[d]=b:g(this+' setup() : The type of "'+a+'" is function !!'):g(this+' setup() : The designated property ("'+a+'") does not exist in accessible properties !!');return this};H.prototype.ready=function(a,b){null!==
this.source&&this.stop();this.sequences=[];this.timerids=[];this.prev=[];Array.isArray(b)||(b=[b]);if(a instanceof E||a instanceof F){for(this.source=a;0<b.length;){var d=[],f=String(b.shift()).match(/\s*(?:T\d+)\s*|\s*(?:O\d+)\s*|\s*(?:(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*\s*/ig);if(null===f){this.callbacks.error("MML","");return}for(var k=0,l=function(a,b){var d=
0;switch(b){case "C":d=3;break;case "D":d=5;break;case "E":d=7;break;case "F":d=8;break;case "G":d=10;break;case "A":d=12;break;case "B":d=14;break;case "R":return"R"}d=12*(a-1)+d;return 0<=d?d:-1},h=function(a){var b=Math.pow(2,1/12);return 0<=a?27.5*Math.pow(b,a):-1};0<f.length;){var n=f.shift().trim();if(/T\d+/i.test(n)){var p=parseInt(n.slice(1));if(0<p)p=60/p;else{this.callbacks.error("TEMPO",n);return}}else if(/O\d+/i.test(n)){var r=parseInt(n.slice(1));if(0>r){this.callbacks.error("OCTAVE",
n);return}}else if(/(?:(?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*/i.test(n)){if(void 0===p){this.callbacks.error("TEMPO",n);return}if(void 0===r){this.callbacks.error("OCTAVE",n);return}for(var s=n.match(/((?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*/i)[1],w=[],q=0,v=s.length;q<v;q++){var y=s.charAt(q),y=l.call(this,r,y.toUpperCase());
switch(s.charAt(q+1)){case "#":case "+":y++;q++;break;case "-":y--,q++}y>=w[0]&&(y-=12);if(0>y){this.callbacks.error("NOTE",n);return}w.push(y)}s=[];q=0;for(v=w.length;q<v;q++){y="R"!==w[q]?h.call(this,w[q],n):"R";if(-1===y){this.callbacks.error("NOTE",n);return}s.push(y)}v=n.split("&");for(q=0;0<v.length;)switch(y=v.shift().match(/(?:[CDEFGABR][#+-]?)+((?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*)/i)[1],parseInt(y)){case 1:case 2:case 4:case 8:case 16:case 32:case 64:case 128:case 256:var z=
4/parseInt(y),q=q+(-1!==y.indexOf(".")?1.5*z*p:z*p);break;case 6:q+=2*p/3;break;case 12:q+=p/3;break;case 18:q+=2*p/9;break;case 24:q+=0.5*p/3;break;case 36:q+=p/9;break;case 48:q+=0.25*p/3;break;case 72:q+=0.5*p/9;break;case 96:q+=0.125*p/3;break;case 144:q+=0.25*p/9;break;case 192:q+=0.0625*p/3;break;default:this.callbacks.error("NOTE",n)}n=k;v=n+q;k+=q;d.push({indexes:w,frequencies:s,start:n,duration:q,stop:v})}}0<d.length&&(this.sequences.push(d),this.timerids.push(null))}return this.sequences}g(this+
' ready() ; The 1st argument is X("oscillator") or X("oneshot") !!')};H.prototype.start=function(a,b,d){var f=parseInt(a);if(0<=f&&f<this.sequences.length){if(!Array.isArray(this.sequences[f]))return;if(0===this.sequences[f].length)return this.stop(d),this.callbacks.ended(),this;var k=this.sequences[f].shift();if(this.source instanceof E){this.source.start(k.frequencies,b,d);a=0;for(var l=k.indexes.length;a<l;a++)"R"!==k.indexes[a]&&this.callbacks.start(k,a)}else if(this.source instanceof F)for(a=
0,l=k.indexes.length;a<l;a++)"R"!==k.indexes[a]&&(this.source.start(k.indexes[a],b,d),this.callbacks.start(k,a));this.timerids[f]=v.setTimeout(function(){if(this.source instanceof E){this.source.stop(k.frequencies,d);for(var a=0,g=k.indexes.length;a<g;a++)"R"!==k.indexes[a]&&this.callbacks.stop(k,a)}else if(this.source instanceof F)for(a=0,g=k.indexes.length;a<g;a++)"R"!==k.indexes[a]&&(this.source.stop(k.indexes[a],d),this.callbacks.stop(k,a));this.prev=k;this.start(f,b,d)}.bind(this),1E3*k.duration)}else g(this+
" start() : The range of designated MML part is between 0 and "+(this.sequences.length-1)+" !!");return this};H.prototype.stop=function(a){var b=this.prev;if(0!==b.length){if(this.source instanceof E){this.source.stop(b.frequencies,a);for(var d=0,f=b.indexes.length;d<f;d++)"R"!==b.indexes[d]&&this.callbacks.stop(b,d)}else if(this.source instanceof F)for(d=0,f=b.indexes.length;d<f;d++)"R"!==b.indexes[d]&&(this.source.stop(b.indexes[d],a),this.callbacks.stop(b,d));d=0;for(f=this.timerids.length;d<f;d++)v.clearTimeout(this.timerids[d]),
this.timerids[d]=null;return this}};H.prototype.toggle=function(a,b,d){this.isPaused()?this.start(a,b,d):this.stop()};H.prototype.isSequences=function(){return Array.isArray(this.sequences[0])?!0:!1};H.prototype.isPaused=function(){for(var a=0,b=this.timerids.length;a<b;a++){var d=this.timerids[a];if(null!==d&&void 0!==d)return!1}return!0};H.prototype.getSequences=function(){return this.sequences};H.prototype.download=function(a){return"data:text/plain;base64,"+v.btoa(String(a))};H.prototype.toString=
function(){return"MML"};var O=new s(audiocontext),P=new E(audiocontext),Z=new F(audiocontext),$=new z(audiocontext),R=new A(audiocontext),aa=new B,ba=new H;r=function(a,b){switch(String(a).replace(/-/g,"").toLowerCase()){case "oscillator":if(void 0===b)return P;var d=parseInt(b);if(0<=d&&d<P.sources.length)return P.sources[d];g("XSound() : The range of the 2nd argument is between 0 and "+(P.sources.length-1)+" !!");break;case "oneshot":return Z;case "audio":return $;case "media":return R;case "fallback":return aa;
case "mml":return ba;default:g('XSound() : The value of the 1st argument ("'+a+'") is one of "oscillator", "oneshot", "audio", "media", "fallback", "mml" !!')}};r.IS_XSOUND=Q;r.FULL_MODE=G;r.ERROR_MODE=K;r.SAMPLE_RATE=O.SAMPLE_RATE;r.BUFFER_SIZE=O.BUFFER_SIZE;r.NUM_INPUT=O.NUM_INPUT;r.NUM_OUTPUT=O.NUM_OUTPUT;r.error=S;r.read=T;r.file=U;r.ajax=V;r.toFrequencies=W;r.convertTime=X;r.noConflict=Y;r.getCurrentTime=function(){return audiocontext.currentTime}}else{var R=new B;r=function(){return R};r.IS_XSOUND=
Q;r.ERROR_MODE=K;r.SAMPLE_RATE=null;r.BUFFER_SIZE=null;r.NUM_INPUT=null;r.NUM_OUTPUT=null;r.error=S;r.read=T;r.file=U;r.ajax=V;r.toFrequencies=W;r.convertTime=X;r.noConflict=Y}r.toString=function(){return"XSound"};v.XSound=r;v.X=r})(window);