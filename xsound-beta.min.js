/** 
 * xsound.min.js
 * @fileoverview Web Audio API Library
 *
 * Copyright 2012, 2013@Tomohiro IKEDA
 * Released under the MIT license
 */
(function(r){var i;var u=r.webkitAudioContext?true:false;var A={NONE:0,CONSOLE:1,EXCEPTION:2};var y=A.CONSOLE;var n=function(D){switch(y){case A.CONSOLE:console.trace();console.error(D);break;case A.EXCEPTION:console.trace();throw new Error(D);break;case A.NONE:default:break}};var x=implement=function(D){if(Object.create){return Object.create(D)}else{function E(){}E.prototype=D;return new E()}};var v=function(D){switch(String(D).toUpperCase()){case"NONE":case"0":y=A.NONE;this.ERROR_MODE=A.NONE;break;case"CONSOLE":case"1":y=A.CONSOLE;this.ERROR_MODE=A.CONSOLE;break;case"EXCEPTION":case"2":y=A.EXCEPTION;this.ERROR_MODE=A.EXCEPTION;break;default:break}};var w=function(I,J,E,G,K){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){var H=arguments[0];if("file" in H){I=H.file}if("type" in H){J=H.type}if("success" in H){E=H.success}if("error" in H){G=H.error}if("progress" in H){K=H.progress}}if(!(I instanceof Blob)){var F="FILE_IS_NOT_BLOB";if(Object.prototype.toString.call(G)==="[object Function]"){G(null,F)}return}var D=new FileReader();D.onprogress=function(L){if(Object.prototype.toString.call(K)==="[object Function]"){K(L)}};D.onerror=function(M){if(Object.prototype.toString.call(G)==="[object Function]"){var L="";switch(D.error.code){case D.error.NOT_FOUND_ERR:L="NOT_FOUND_ERR";break;case D.error.SECURITY_ERR:L="SECURITY_ERR";break;case D.error.ABORT_ERR:L="ABORT_ERR";break;case D.error.NOT_READABLE_ERR:L="NOT_READABLE_ERR";break;case D.error.ENCODING_ERR:L="ENCODING_ERR";break;default:L="ERR";break}G(M,L)}};D.onload=function(M){if(Object.prototype.toString.call(E)==="[object Function]"){var L=D.result;if((Object.prototype.toString.call(L)==="[object String]")&&(L.indexOf("data:")===-1)){L=L.replace(/<(script)>(.*)<(\/script)>/gi,"&lt;$1&gt;$2&lt;$3&gt;")}E(M,L)}};if(/arraybuffer/i.test(J)){D.readAsArrayBuffer(I)}else{if(/dataurl/i.test(J)){D.readAsDataURL(I)}else{if(/text/i.test(J)){D.readAsText(I,"utf-8")}else{n(this+' read() : The 1st argument is one of "ArrayBuffer", "DataURL", "Text". !!')}}}};var z=function(H,I,D,E,J){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){var G=arguments[0];if("type" in G){H=G.type}if("event" in G){I=G.event}if("success" in G){D=G.success}if("error" in G){E=G.error}if("progress" in G){J=G.progress}}if(!(I instanceof Event)){n(this+" file() : The 1st argument is event object !!");return}var F=null;if(I.type==="drop"){I.preventDefault();F=("items" in I.dataTransfer)?I.dataTransfer.items[0].getAsFile():I.dataTransfer.files[0]}else{if((I.type==="change")&&("files" in I.target)){F=I.target.files[0]}else{n(this+' file() : The event object is either "drop" or file form\'s "change" !!');return}}if(!(F instanceof File)){throw new Error("Please upload file !!")}else{if((/text/i.test(H))&&(F.type.indexOf("text")===-1)){throw new Error("Please upload text file !!")}else{if((/arraybuffer|dataurl/i.test(H))&&(F.type.indexOf("audio")===-1)){throw new Error("Please upload audio file !!")}else{this.read({file:F,type:H,success:D,error:E,progress:J});return F}}}};var l=function(D,K,E,H,G){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){var I=arguments[0];if("url" in I){D=I.url}if("timeout" in I){K=I.timeout}if("success" in I){E=I.success}if("error" in I){H=I.error}if("progress" in I){G=I.progress}}var J="error";var L="timeout";var N=new XMLHttpRequest();N.responseType="arraybuffer";var M=parseInt(K);var F=r.setTimeout(function(){N.abort();if(Object.prototype.toString.call(H)==="[object Function]"){H(N,L)}},((M>0)?M:60000));N.onreadystatechange=function(){if((N.readyState===N.LOADING)&&(Object.prototype.toString.call(G)==="[object Function]")){G(N)}if(N.readyState===N.DONE){r.clearTimeout(F);if(N.status===200){var O=N.response;if((O instanceof ArrayBuffer)&&(Object.prototype.toString.call(E)==="[object Function]")){E(N,O)}}}};N.onerror=function(){if(Object.prototype.toString.call(H)==="[object Function]"){H(N,J)}};N.open("GET",D,true);N.send(null)};var j=function(G){var I=Math.pow(2,(1/12));var E=27.5;if(!Array.isArray(G)){G=[G]}var J=new Array(G.length);for(var H=0,D=G.length;H<D;H++){var F=parseInt(G[H]);J[H]=(F>=0)?(E*Math.pow(I,F)):0}return J};var h=function(G){var E=parseFloat(G);if(E>=0){var D=Math.floor(E/60);var F=Math.floor(E%60);return{minutes:D,seconds:F}}else{n(this+" convertTime() : The range of the 1st argument is between 0 and audio duration !!")}};var C=function(D){if(r.X===i){r.X=undefined}if(D&&(r.XSound===i)){r.XSound=undefined}return i};function m(){this.media=null;this.ex="";this.duration=0;this.volume=1;this.playbackRate=1;this.controls=false;this.loop=false;this.muted=false;this.callbacks={}}m.prototype.setup=function(D,K,L,I){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){var J=arguments[0];if("id" in J){D=J.id}if("type" in J){K=J.type}if("formats" in J){L=J.formats}if("callbacks" in J){I=J.callbacks}}var G=String(D);var O=(String(K).toLowerCase()!=="video")?"audio":"video";this.media=((D!==null)&&(G!==""))?document.getElementById(G):document.createElement(O);if(!(this.media instanceof HTMLMediaElement)){this.media=null;n(this+" setup() : The media element that has the designated ID does not exists !!");return}if(!Array.isArray(L)){L=[L]}for(var F=0,H=L.length;F<H;F++){var M=O+"/"+String(L[F]).toLowerCase();if(/^(?:maybe|probably)/.test(this.media.canPlayType(M))){this.ex=L[F];break}}if(this.ex===""){throw new Error("Media format that can be played does not exist !!")}if(Object.prototype.toString.call(I)==="[object Object]"){for(var E in I){this.callbacks[E.toLowerCase()]=(Object.prototype.toString.call(I[E])==="[object Function]")?I[E]:function(){}}}var N=this;for(var E in this.callbacks){switch(E){case"loadedmetadata":this.media.addEventListener("loadedmetadata",function(P){N.duration=this.duration;N.callbacks.loadedmetadata(P,this)},false);break;default:this.media.addEventListener(E,function(P){N.callbacks[(P.type).toLowerCase()](P,this)},false);break}}return this};m.prototype.param=function(H,I){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var F in arguments[0]){this.param(F,arguments[0][F])}}else{var F=String(H).replace(/-/g,"").toLowerCase();switch(F){case"mastervolume":if(I===undefined){return(this.media instanceof HTMLMediaElement)?this.media.volume:this.volume}else{var E=parseFloat(I);var G=0;var D=1;if((E>=G)&&(E<=D)){if(this.media instanceof HTMLMediaElement){this.media.volume=E}this.volume=E}else{n(this+" param() : The range of "+H+" is between "+G+" and "+D+" !!")}}break;case"playbackrate":if(I===undefined){return(this.media instanceof HTMLMediaElement)?this.media.playbackRate:this.playbackRate}else{var E=parseFloat(I);var G=0.5;if(E>=G){if(this.media instanceof HTMLMediaElement){this.media.playbackRate=E}this.playbackRate=E}else{n(this+" param() : The range of "+H+" is greater than or equal 0.5 !!")}}break;case"currenttime":if(I===undefined){return(this.media instanceof HTMLMediaElement)?this.media.currentTime:0}else{var E=parseFloat(I);if(this.media instanceof HTMLMediaElement){var G=0;var D=this.duration}else{return}if((E>=G)&&(E<=D)){this.media.currentTime=E}else{n(this+" param() : The range of "+H+" is between "+G+" and "+D+" !!")}}break;case"loop":case"muted":case"controls":if(I===undefined){return(this.media instanceof HTMLMediaElement)?this.media[F]:this[F]}else{if(this.media instanceof HTMLMediaElement){this.media[F]=Boolean(I)}this[F]=Boolean(I)}break;case"width":case"height":if(I===undefined){return(this.media instanceof HTMLVideoElement)?this.media[F]:0}else{var E=parseInt(I);var G=0;if(E>=G){if(this.media instanceof HTMLVideoElement){this.media[F]=E}}else{n(this+" param() : The range of "+H+" is greater than or equal "+G+" !!")}}break;case"duration":return this.duration;case"channels":return;default:n(this+' param() : The designated property ("'+H+'") does not exist in accessible properties !!');break}}return this};m.prototype.ready=function(E){var G=String(E);try{if(G.indexOf("data:")!==-1){this.media.src=G}else{var F=G+"."+this.ex;this.media.src=F}}catch(D){throw new Error("The designated resource cannot be loaded !!")}return this};m.prototype.start=function(D){if((this.media instanceof HTMLMediaElement)&&this.media.paused){this.media.play();var E=parseFloat(D);this.media.currentTime=((E>=0)&&(E<=this.duration))?E:0;this.media.playbackRate=this.playbackRate;this.media.controls=this.controls;this.media.loop=this.loop;this.media.muted=this.muted}return this};m.prototype.stop=function(){if((this.media instanceof HTMLMediaElement)&&!this.media.paused){this.media.pause()}return this};m.prototype.toggle=function(D){if(this.media instanceof HTMLMediaElement){this.media.paused?this.start(D):this.stop()}return this};m.prototype.getMedia=function(){return this.media};m.prototype.isMedia=function(){return(this.media instanceof HTMLMediaElement)?true:false};m.prototype.isSource=function(){return this.isMedia()};m.prototype.isPaused=function(){return(this.media instanceof HTMLMediaElement)?this.media.paused:true};m.prototype.fullscreen=function(){if(this.media instanceof HTMLVideoElement){if(this.media.webkitRequestFullscreen){this.media.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}else{if(this.media.mozRequestFullScreen){this.media.mozRequestFullScreen()}else{if(this.media.requestFullscreen){this.media.requestFullscreen()}else{throw new Error("Cannot change to full screen !!")}}}}return this};m.prototype.exitFullscreeen=function(){if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.mozCancelFullscreen){document.mozCancelFullscreen()}else{if(document.exitFullscreen){document.exitFullscreen()}else{throw new Error("Cannot exit from full screen !!")}}}return this};m.prototype.toString=function(){return"MediaFallbackModule"};if(u){r.AudioContext=r.AudioContext||r.webkitAudioContext;audiocontext=new AudioContext();audiocontext.createScriptProcessor=audiocontext.createScriptProcessor||audiocontext.createJavaScriptNode;audiocontext.createGain=audiocontext.createGain||audiocontext.createGainNode;audiocontext.createDelay=audiocontext.createDelay||audiocontext.createDelayNode;audiocontext.createPeriodicWave=audiocontext.createPeriodicWave||audiocontext.createWaveTable}else{var d=new m();i=function(){return d};i.IS_XSOUND=u;i.ERROR_MODE=y;i.SAMPLE_RATE=null;i.BUFFER_SIZE=null;i.NUM_INPUT=null;i.NUM_OUTPUT=null;i.error=v;i.read=w;i.file=z;i.ajax=l;i.toFrequencies=j;i.convertTime=h;i.noConflict=C;i.toString=function(){return"XSound"};r.XSound=i;r.X=i;return}function q(D){this.isActive=Boolean(D)}q.prototype.state=function(D){if(D===undefined){return this.isActive}else{if(String(D).toLowerCase()==="toggle"){this.isActive=!this.isActive}else{this.isActive=Boolean(D)}}return this};function e(E,I){this.context=E;this.SAMPLE_RATE=E.sampleRate;this.NUM_INPUT=2;this.NUM_OUTPUT=2;if(I!==undefined){switch(parseInt(I)){case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:this.BUFFER_SIZE=parseInt(I);break;default:n(this+" constructor() : The 2nd argument is one of 256, 512, 1024, 2048, 4096, 8192, 16384 !!");return}}else{if(/(Win(dows )?NT 6\.2)/.test(navigator.userAgent)){this.BUFFER_SIZE=1024}else{if(/(Win(dows )?NT 6\.1)/.test(navigator.userAgent)){this.BUFFER_SIZE=1024}else{if(/(Win(dows )?NT 6\.0)/.test(navigator.userAgent)){this.BUFFER_SIZE=2048}else{if(/Win(dows )?(NT 5\.1|XP)/.test(navigator.userAgent)){this.BUFFER_SIZE=4096}else{if(/Mac|PPC/.test(navigator.userAgent)){this.BUFFER_SIZE=1024}else{if(/Linux/.test(navigator.userAgent)){this.BUFFER_SIZE=8192}else{if(/iPhone|iPad|iPod/.test(navigator.userAgent)){this.BUFFER_SIZE=2048}else{this.BUFFER_SIZE=16384}}}}}}}}this.masterVolume=E.createGain();this.processor=E.createScriptProcessor(this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT);Q.prototype=implement(q.prototype);N.prototype=implement(q.prototype);Q.prototype.constructor=Q;N.prototype.constructor=N;X.prototype=x(N.prototype);O.prototype=x(N.prototype);W.prototype=x(N.prototype);P.prototype=x(N.prototype);Y.prototype=x(N.prototype);M.prototype=x(N.prototype);H.prototype=x(N.prototype);U.prototype=x(N.prototype);T.prototype=x(N.prototype);K.prototype=x(N.prototype);S.prototype=x(N.prototype);F.prototype=x(N.prototype);L.prototype=x(N.prototype);R.prototype=x(N.prototype);X.prototype.constructor=X;O.prototype.constructor=O;W.prototype.constructor=W;P.prototype.constructor=P;Y.prototype.constructor=Y;M.prototype.constructor=M;H.prototype.constructor=H;U.prototype.constructor=U;T.prototype.constructor=T;K.prototype.constructor=K;S.prototype.constructor=S;F.prototype.constructor=F;L.prototype.constructor=L;R.prototype.constructor=R;this.listener=new G(E);this.analyser=new V(E);this.recorder=new J(E,this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT);this.session=new Q(E,this.BUFFER_SIZE,this.NUM_INPUT,this.NUM_OUTPUT,this.analyser);this.eg=new D(E);this.compressor=new X(E,this.BUFFER_SIZE);this.distortion=new O(E,this.BUFFER_SIZE);this.wah=new W(E,this.BUFFER_SIZE);this.equalizer=new P(E,this.BUFFER_SIZE);this.filter=new Y(E,this.BUFFER_SIZE);this.tremolo=new M(E,this.BUFFER_SIZE);this.ringmodulator=new H(E,this.BUFFER_SIZE);this.autopanner=new U(E,this.BUFFER_SIZE);this.phaser=new T(E,this.BUFFER_SIZE);this.flanger=new K(E,this.BUFFER_SIZE);this.chorus=new S(E,this.BUFFER_SIZE);this.delay=new F(E,this.BUFFER_SIZE);this.reverb=new L(E,this.BUFFER_SIZE);this.panner=new R(E,this.BUFFER_SIZE);this.nodes=[this.compressor,this.distortion,this.wah,this.equalizer,this.filter,this.tremolo,this.ringmodulator,this.autopanner,this.flanger,this.phaser,this.chorus,this.delay,this.reverb];this.Effector=N;this.plugins=[];function G(Z){this.listener=Z.listener;this.dopplerFactor=1;this.speedOfSound=343.3;this.positions={x:0,y:0,z:0};this.fronts={x:0,y:0,z:-1};this.ups={x:0,y:1,z:0};this.velocities={x:0,y:0,z:0};this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z);this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z);this.listener.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z)}G.prototype.param=function(ab,ac){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var aa in arguments[0]){this.param(aa,arguments[0][aa])}}else{var aa=String(ab).replace(/-/g,"").toLowerCase();switch(aa){case"dopplerfactor":if(ac===undefined){return this.listener.dopplerFactor}else{var Z=parseFloat(ac);if(Z>=0){this.listener.dopplerFactor=Z}else{n(this+' param() : The range of "'+ab+'" is greater than or equal 0 !!')}}break;case"speedofsound":if(ac===undefined){return this.listener.speedOfSound}else{var Z=parseFloat(ac);if(Z>=0){this.listener.speedOfSound=Z}else{n(this+' param() : The range of "'+ab+'" is greater than or equal 0 !!')}}break;case"x":case"y":case"z":if(ac===undefined){return this.positions[aa]}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.positions[aa]=Z;this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z)}}break;case"fx":case"fy":case"fz":if(ac===undefined){return this.fronts[aa.charAt(1)]}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.fronts[aa.charAt(1)]=Z;this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z)}}break;case"ux":case"uy":case"uz":if(ac===undefined){return this.ups[aa.charAt(1)]}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.ups[aa.charAt(1)]=Z;this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z)}}break;case"vx":case"vy":case"vz":if(ac===undefined){return this.velocities[aa.charAt(1)]}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.velocities[aa.charAt(1)]=Z;this.listener.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z)}}break;default:n(this+' param() : The designated property ("'+ab+'") does not exist in accessible properties !!');break}}return this};G.prototype.toString=function(){return"SoundModule Listener"};function V(aa){this.analyser=aa.createAnalyser();this.input=aa.createGain();this.output=aa.createGain();this.input.connect(this.analyser);this.analyser.connect(this.output);ad.prototype=implement(q.prototype);ad.prototype.constructor=ad;Z.prototype=x(ad.prototype);ab.prototype=x(ad.prototype);ac.prototype=x(ad.prototype);Z.prototype.constructor=Z;ab.prototype.constructor=ab;ac.prototype.constructor=ac;this.timeAllL=new Z(aa.sampleRate);this.timeAllR=new Z(aa.sampleRate);this.time=new ab(aa.sampleRate);this.fft=new ac(aa.sampleRate);this.analyser.fftSize=2048;this.analyser.minDecibels=-100;this.analyser.maxDecibels=-30;this.analyser.smoothingTimeConstant=0.8;function ad(ae){this.SAMPLE_RATE=ae;this.drawType="";this.canvas=null;this.context=null;this.svg=null;this.svgParent=null;this.interval=1000;this.timerid=null;this.styles={shape:"line",grad:[{offset:0,color:"rgba(0, 128, 255, 1.0)"},{offset:1,color:"rgba(0, 0, 255, 1.0)"}],wave:"rgba(0, 0, 255, 1.0)",grid:"rgba(255, 0, 0, 1.0)",text:"rgba(255, 255, 255, 1.0)",font:"13px Arial",width:1.5,cap:"round",join:"miter",top:15,right:15,bottom:15,left:15}}ad.prototype.setup=function(ae,ag,af){switch(String(ae).toLowerCase()){case"canvas":this.drawType="canvas";this.canvas=document.getElementById(String(ag));if(this.canvas instanceof HTMLCanvasElement){this.context=this.canvas.getContext("2d")}else{n(this+" setup() : The designated canvas ID does not exists !!")}break;case"svg":this.drawType="svg";this.svg=document.getElementById(String(ag));if(this.svg instanceof SVGElement){this.svgParent=document.getElementById(String(af));if(!(this.svgParent instanceof HTMLElement)){n(this+" setup() : The designated parent node ID does not exists !!")}}else{n(this+" setup() : The designated SVG ID does not exists !!")}break;default:n(this+' setup() : The 1st argument is either "canvas" or "svg" !!');break}return this};ad.prototype.param=function(al,ak){var ae=String(al).replace(/-/g,"").toLowerCase();switch(ae){case"interval":if(ak===undefined){return this.interval}else{var am=parseFloat(ak);if(am>=0){this.interval=am}else{n(this+' param() : The range of "'+al+'" is greater than or equal 0 !!')}}break;case"shape":if(ak===undefined){return this.styles.shape}else{var am=String(ak).toLowerCase();if((am==="line")||(am==="rect")){this.styles.shape=(this.styles.wave!=="gradient")?am:"rect"}else{n(this+' param() : The type of "'+al+'" is either "line" or "rect" !!')}}break;case"grad":if(ak===undefined){return this.styles.grad}else{if(!Array.isArray(ak)){ak=[ak]}var ai=false;for(var ag=0,ah=ak.length;ag<ah;ag++){var aj=ak[ag];if(("offset" in aj)&&("color" in aj)){var af=parseFloat(aj.offset);if(isNaN(af)||(af<0)||(af>1)){ai=true;break}}else{ai=true;break}}if(ai){n(this+' param() : The type of "'+al+'" is object\'s array that has 2 properties ("offset", "color") !! The range of "offset" is between 0 and 1 !!')}else{this.styles.grad=ak}}break;case"wave":case"grid":case"text":case"font":case"cap":case"join":if(ak===undefined){return this.styles[ae]}else{if(typeof ak!=="string"){n(this+' param() : The type of "'+al+'" is string type !!')}else{if((ae==="wave")&&(ak==="gradient")){this.styles.shape="rect"}this.styles[ae]=(ae==="font")?ak:ak.toLowerCase()}}break;case"width":case"top":case"right":case"bottom":case"left":if(ak===undefined){return this.styles[ae]}else{var am=(ae==="width")?parseFloat(ak):parseInt(ak);if(am>=0){this.styles[ae]=am}else{n(this+' param() : The range of "'+al+'" is greater than or equal 0 !!')}}break;default:break}};ad.prototype.start=function(ae,ag,af){switch(this.drawType){case"canvas":this.drawToCanvas(ae,ag,af);break;case"svg":this.drawToSVG(ae,ag,af);break;default:break}return this};ad.prototype.download=function(){switch(this.drawType){case"canvas":return this.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");case"svg":return this.svgParent.innerHTML;default:return this}};ad.prototype.drawToCanvas=function(ae){};ad.prototype.drawToSVG=function(ae){};ad.prototype.toString=function(){return"SoundModule Draw"};function Z(ae){ad.call(this,ae);q.call(this,false);this.savedImage=null;this.length=0;this.currentTime="rgba(255, 255, 255, 1.0)";this.plotinterval=0.0625;this.textinterval=60}Z.prototype.param=function(ag,ai){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var af in arguments[0]){this.param(af,arguments[0][af])}}else{var af=String(ag).replace(/-/g,"").toLowerCase();var ah=ad.prototype.param.call(this,af,ai);if(ah!==undefined){return ah}else{switch(af){case"currenttime":if(ai===undefined){return this.currentTime}else{if(typeof ai!=="string"){n(this+' param() : The type of "'+ag+'" is string type !!')}else{this.currentTime=ai.toLowerCase()}}break;case"plotinterval":case"textinterval":if(ai===undefined){return this[af]}else{var ae=parseFloat(ai);if(ae>0){this[af]=ae}else{n(this+' param() : The range of "'+ag+'" is greater than 0 !!')}}break;default:if(!(af in this.styles)){n(this+' param() : The designated property ("'+ag+'") does not exist in accessible properties !!')}break}}}return this};Z.prototype.drawToCanvas=function(ax){if(!((this.canvas instanceof HTMLCanvasElement)&&this.isActive)){return this}var ag=this.context;var am=this.canvas.width;var aw=this.canvas.height;var ah=am-(this.styles.left+this.styles.right);var an=aw-(this.styles.top+this.styles.bottom);var ay=Math.floor(an/2)+this.styles.top;var al=0;var ak=0;var ao="";var ai=Math.floor(this.plotinterval*this.SAMPLE_RATE);var au=Math.floor(this.textinterval*this.SAMPLE_RATE);ag.clearRect(0,0,am,aw);switch(this.styles.shape){case"line":ag.strokeStyle=this.styles.wave;ag.lineWidth=this.styles.width;ag.lineCap=this.styles.cap;ag.lineJoin=this.styles.join;ag.beginPath();for(var at=0,av=ax.length;at<av;at++){if((at%ai)===0){al=Math.floor((at/av)*ah)+this.styles.left;ak=Math.floor((1-ax[at])*(an/2))+this.styles.top;(at===0)?ag.moveTo(al,ak):ag.lineTo(al,ak)}}ag.stroke();break;case"rect":if(this.styles.wave!=="gradient"){ag.fillStyle=this.styles.wave}for(var at=0,av=ax.length;at<av;at++){if((at%ai)===0){al=Math.floor((at/av)*ah)+this.styles.left;ak=-1*Math.floor(ax[at]*(an/2));if(this.styles.wave==="gradient"){var ap=(an/2)+this.styles.top;var af=ag.createLinearGradient(0,ap,0,(ap+ak));for(var ar=0,aj=this.styles.grad.length;ar<aj;ar++){var aq=this.styles.grad[ar];af.addColorStop(aq.offset,aq.color)}ag.fillStyle=af}ag.fillRect(al,ay,this.styles.width,ak)}}break;default:break}if((this.styles.grid!=="none")||(this.styles.text!=="none")){for(var at=0,av=ax.length;at<av;at++){if((at%au)===0){al=Math.floor((at/av)*ah)+this.styles.left;ao=Math.floor(at/this.SAMPLE_RATE)+" s";if(this.styles.grid!=="none"){ag.fillStyle=this.styles.grid;ag.fillRect(al,this.styles.top,1,an)}if(this.styles.text!=="none"){ag.fillStyle=this.styles.text;ag.font=this.styles.font;ag.fillText(ao,(al-(ag.measureText(ao).width/2)),aw)}}}var ae=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];for(var at=0,av=ae.length;at<av;at++){ao=ae[at];al=Math.floor(am-ag.measureText(ao).width);ak=Math.floor((1-parseFloat(ao.trim()))*(an/2))+this.styles.top;if(this.styles.grid!=="none"){ag.fillStyle=this.styles.grid;ag.fillRect(this.styles.left,ak,ah,1)}ak-=parseInt(ag.font.match(/\s*(\d+)px.*/)[1]/4);if(this.styles.text!=="none"){ag.fillStyle=this.styles.text;ag.font=this.styles.font;ag.fillText(ao,al,ak)}}}this.savedImage=ag.getImageData(0,0,am,aw);this.length=ax.length;ag.fillStyle=this.currentTime;ag.fillRect(this.styles.left,this.styles.top,1,an);return this};Z.prototype.drawToSVG=function(aA){if(!((this.svg instanceof SVGElement)&&(this.svgParent instanceof HTMLElement)&&this.isActive)){return this}var ar=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>";var an=this.svg.getAttribute("width");var ay=this.svg.getAttribute("height");var ai=an-(this.styles.left+this.styles.right);var ao=ay-(this.styles.top+this.styles.bottom);var aD=Math.floor(ao/2)+this.styles.top;var am=0;var al=0;var ap="";var aj=Math.floor(this.plotinterval*this.SAMPLE_RATE);var av=Math.floor(this.textinterval*this.SAMPLE_RATE);var aC="";switch(this.styles.shape){case"line":aC+="stroke : "+this.styles.wave+"; ";aC+="fill : none; ";aC+="stroke-width : "+this.styles.width+"; ";aC+="stroke-linecap : "+this.styles.cap+"; ";aC+="stroke-linejoin : "+this.styles.join+";";break;case"rect":if(this.styles.wave==="gradient"){var ag="";ag+="<defs>";ag+='<linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var au=0,ax=this.styles.grad.length;au<ax;au++){var at=this.styles.grad[au];ag+='<stop offset="'+at.offset+'" stop-color="'+at.color+'" />'}ag+="</linearGradient>";ag+="</defs>";aC+="stroke : none; ";aC+="fill : url(#svg-linear-gradient); ";aC+="stroke-width : 0;"}else{aC+="stroke : none; ";aC+="fill : "+this.styles.wave+"; ";aC+="stroke-width : 0;"}break;default:break}var aB="";aB+="stroke : none; ";aB+="fill : "+this.styles.grid+"; ";aB+="stroke-width : 0;";var af=this.styles.font.match(/\s*(\d+)px (.*)/);var az=af[2];var aq=af[1];var ak="";ak+="stroke : none; ";ak+="fill : "+this.styles.text+"; ";ak+="font-family : "+az+"; ";ak+="font-size : "+aq+";";var aw="";aw+="stroke : none; ";aw+="fill : "+this.currentTime+"; ";aw+="stroke-width : 0;";this.svgParent.innerHTML=ar;ar=this.svgParent.innerHTML.replace("</svg>","");if(this.styles.wave==="gradient"){ar+=ag}switch(this.styles.shape){case"line":ar+='<path style="'+aC+'" d="';for(var au=0,ax=aA.length;au<ax;au++){if((au%aj)===0){am=Math.floor((au/ax)*ai)+this.styles.left;al=Math.floor((1-aA[au])*(ao/2))+this.styles.top;if(au===0){ar+="M"+am+" "+al}else{ar+=" ";ar+="L"+am+" "+al}}}ar+='" />';break;case"rect":for(var au=0,ax=aA.length;au<ax;au++){if((au%aj)===0){am=Math.floor((au/ax)*ai)+this.styles.left;al=Math.floor(aA[au]*(ao/2));ar+=(al<0)?'<rect style="'+aC+'" x="'+am+'" y="'+aD+'" width="'+this.styles.width+'" height="'+(-al)+'" />':'<rect style="'+aC+'" x="'+am+'" y="'+aD+'" width="'+this.styles.width+'" height="'+al+'" transform="translate('+this.styles.width+" 0) rotate(180 "+am+" "+aD+')" />'}}break;default:break}if((this.styles.grid!=="none")||(this.styles.text!=="none")){var ah=document.createElement("canvas").getContext("2d");for(var au=0,ax=aA.length;au<ax;au++){if((au%av)===0){am=Math.floor((au/ax)*ai)+this.styles.left;ap=Math.floor(au/this.SAMPLE_RATE)+" s";if(this.styles.grid!=="none"){ar+='<rect style="'+aB+'" x="'+am+'" y="'+this.styles.top+'" width="1" height="'+ao+'" />'}am-=Math.floor(ah.measureText(ap).width/2);if(this.styles.text!=="none"){ar+='<text style="'+ak+'" x="'+am+'" y="'+ay+'">'+ap+"</text>"}}}var ae=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];for(var au=0,ax=ae.length;au<ax;au++){ap=ae[au];am=an-Math.floor(1.5*ah.measureText(ap).width);al=Math.floor((1-parseFloat(ap.trim()))*(ao/2))+this.styles.top;if(this.styles.grid!=="none"){ar+='<rect style="'+aB+'" x="'+this.styles.left+'" y="'+al+'" width="'+ai+'" height="1" />'}al-=Math.floor(parseInt(aq)/4);if(this.styles.text!=="none"){ar+='<text style="'+ak+'" x="'+am+'" y="'+al+'">'+ap+"</text>"}}}ar+='<rect class="svg-current-time" style="'+aw+'" x="'+this.styles.left+'" y="'+this.styles.top+'" width="1" height="'+ao+'" />';ar+="</svg>";this.svgParent.innerHTML=ar;this.savedImage=ar;this.length=aA.length;return this};Z.prototype.update=function(af){switch(this.drawType){case"canvas":if((this.canvas instanceof HTMLCanvasElement)&&this.isActive){break}else{return}case"svg":if((this.svg instanceof SVGElement)&&(this.svgParent instanceof HTMLElement)&&this.isActive){break}else{return}default:break}var am=parseFloat(af);if(isNaN(am)||(am<0)){n(this+" update() : The 1st argument is number type greater than 0 !!");return}var al=0;var ai=0;var aj=0;var ag=0;var ak=0;switch(this.drawType){case"canvas":if(this.savedImage instanceof ImageData){var ae=this.context;al=this.canvas.width;ai=this.canvas.height;aj=al-(this.styles.left+this.styles.right);ag=ai-(this.styles.top+this.styles.bottom);ak=Math.floor(((am*this.SAMPLE_RATE)/this.length)*aj)+this.styles.left;ae.clearRect(0,0,al,ai);ae.putImageData(this.savedImage,0,0);ae.fillStyle=this.currentTime;ae.fillRect(ak,this.styles.top,1,ag)}break;case"svg":var ah=this.svgParent.getElementsByClassName("svg-current-time")[0];if(ah instanceof SVGElement){al=this.svg.getAttribute("width");ai=this.svg.getAttribute("height");aj=al-(this.styles.left+this.styles.right);ag=ai-(this.styles.top+this.styles.bottom);ak=Math.floor(((am*this.SAMPLE_RATE)/this.length)*aj);ah.setAttribute("transform",("translate("+ak+" 0)"))}break;default:break}return this};Z.prototype.drag=function(al){var ak=null;var af=true;switch(this.drawType){case"canvas":if((this.canvas instanceof HTMLCanvasElement)&&this.isActive){ak=this.canvas;af=true;break}else{return}case"svg":if((this.svg instanceof SVGElement)&&(this.svgParent instanceof HTMLElement)&&this.isActive){ak=this.svgParent;af=false;break}else{return}default:break}var ae="";var ag="";var ah="";if(/iPhone|iPad|iPod|Android/.test(navigator.userAgent)){ae="touchstart";ag="touchmove";ah="touchend"}else{ae="mousedown";ag="mousemove";ah="mouseup"}var aj=function(av){var au=0;var aq=0;switch(this.drawType){case"canvas":au=this.canvas.offsetLeft;aq=this.canvas.width;break;case"svg":au=this.svgParent.offsetLeft;aq=this.svg.getAttribute("width");break;default:break}var ao=av-(au+this.styles.left);var ap=aq-(this.styles.left+this.styles.right);if(ao<0){ao=0}if(ao>ap){ao=ap}var at=(ao/ap)*this.length;var ar=at/this.SAMPLE_RATE;this.update(ar);if(Object.prototype.toString.call(al)==="[object Function]"){al(ar)}};var am=function(ao){if(ao.pageX){return ao.pageX}else{if(ao.touches[0]){return ao.touches[0].pageX}}};var ai=false;var an=this;ak.addEventListener(ae,function(ao){if(an.savedImage!==null){aj.call(an,am(ao));ai=true}},af);ak.addEventListener(ag,function(ao){ao.preventDefault();if(ai&&(an.savedImage!==null)){aj.call(an,am(ao))}},af);r.addEventListener(ah,function(ao){ai=false},true);return this};Z.prototype.toString=function(){return"SoundModule Analyser TimeAll"};function ab(ae){ad.call(this,ae);q.call(this,false);this.textinterval=0.005}ab.prototype.param=function(ag,ai){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var af in arguments[0]){this.param(af,arguments[0][af])}}else{var af=String(ag).replace(/-/g,"").toLowerCase();var ah=ad.prototype.param.call(this,af,ai);if(ah!==undefined){return ah}else{switch(af){case"textinterval":if(ai===undefined){return this.textinterval}else{var ae=parseFloat(ai);if(ae>0){this.textinterval=ae}else{n(this+' param() : The range of "'+ag+'" is greater than 0 !!')}}break;default:if(!((af==="interval")||(af in this.styles))){n(this+' param() : The designated property ("'+ag+'") does not exist in accessible properties !!')}break}}}return this};ab.prototype.drawToCanvas=function(aw){if(!((this.canvas instanceof HTMLCanvasElement)&&this.isActive)){return this}var ag=this.context;var al=this.canvas.width;var av=this.canvas.height;var ah=al-(this.styles.left+this.styles.right);var am=av-(this.styles.top+this.styles.bottom);var ax=Math.floor(am/2)+this.styles.top;var ak=0;var aj=0;var an="";var at=Math.floor(this.textinterval*this.SAMPLE_RATE);ag.clearRect(0,0,al,av);switch(this.styles.shape){case"line":ag.strokeStyle=this.styles.wave;ag.lineWidth=this.styles.width;ag.lineCap=this.styles.cap;ag.lineJoin=this.styles.join;ag.beginPath();for(var ar=0,au=aw.length;ar<au;ar++){ak=Math.floor((ar/au)*ah)+this.styles.left;aj=Math.floor((1-(aw[ar]/255))*am)+this.styles.top;(ar===0)?ag.moveTo(ak,aj):ag.lineTo(ak,aj)}ag.stroke();break;case"rect":if(this.styles.wave!=="gradient"){ag.fillStyle=this.styles.wave}for(var ar=0,au=aw.length;ar<au;ar++){ak=Math.floor((ar/au)*ah)+this.styles.left;aj=Math.floor((0.5-(aw[ar]/255))*am);if(this.styles.wave==="gradient"){var ao=(am/2)+this.styles.top;var af=ag.createLinearGradient(0,ao,0,(ao+aj));for(var aq=0,ai=this.styles.grad.length;aq<ai;aq++){var ap=this.styles.grad[aq];af.addColorStop(ap.offset,ap.color)}ag.fillStyle=af}ag.fillRect(ak,ax,this.styles.width,aj)}break;default:break}if((this.styles.grid!=="none")||(this.styles.text!=="none")){for(var ar=0,au=aw.length;ar<au;ar++){if((ar%at)===0){ak=Math.floor((ar/au)*ah)+this.styles.left;an=Math.floor((ar/this.SAMPLE_RATE)*1000)+" ms";if(this.styles.grid!=="none"){ag.fillStyle=this.styles.grid;ag.fillRect(ak,this.styles.top,1,am)}if(this.styles.text!=="none"){ag.fillStyle=this.styles.text;ag.font=this.styles.font;ag.fillText(an,(ak-(ag.measureText(an).width/2)),av)}}}var ae=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];for(var ar=0,au=ae.length;ar<au;ar++){an=ae[ar];ak=Math.floor(al-ag.measureText(an).width);aj=Math.floor((1-parseFloat(an.trim()))*(am/2))+this.styles.top;if(this.styles.grid!=="none"){ag.fillStyle=this.styles.grid;ag.fillRect(this.styles.left,aj,ah,1)}aj-=parseInt(ag.font.match(/\s*(\d+)px.*/)[1]/4);if(this.styles.text!=="none"){ag.fillStyle=this.styles.text;ag.font=this.styles.font;ag.fillText(an,ak,aj)}}}return this};ab.prototype.drawToSVG=function(ay){if(!((this.svg instanceof SVGElement)&&(this.svgParent instanceof HTMLElement)&&this.isActive)){return this}var aq=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>";var am=this.svg.getAttribute("width");var aw=this.svg.getAttribute("height");var ai=am-(this.styles.left+this.styles.right);var an=aw-(this.styles.top+this.styles.bottom);var aB=Math.floor(an/2)+this.styles.top;var al=0;var ak=0;var ao="";var au=Math.floor(this.textinterval*this.SAMPLE_RATE);var az="";switch(this.styles.shape){case"line":az+="stroke : "+this.styles.wave+"; ";az+="fill : none; ";az+="stroke-width : "+this.styles.width+"; ";az+="stroke-linecap : "+this.styles.cap+"; ";az+="stroke-linejoin : "+this.styles.join+";";break;case"rect":if(this.styles.wave==="gradient"){var ag="";ag+="<defs>";ag+='<linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var at=0,av=this.styles.grad.length;at<av;at++){var ar=this.styles.grad[at];ag+='<stop offset="'+ar.offset+'" stop-color="'+ar.color+'" />'}ag+="</linearGradient>";ag+="</defs>";az+="stroke : none; ";az+="fill : url(#svg-linear-gradient); ";az+="stroke-width : 0;"}else{az+="stroke : none; ";az+="fill : "+this.styles.wave+"; ";az+="stroke-width : 0;"}break;default:break}var aA="";aA+="stroke : none; ";aA+="fill : "+this.styles.grid+"; ";aA+="stroke-width : 0;";var af=this.styles.font.match(/\s*(\d+)px (.*)/);var ax=af[2];var ap=af[1];var aj="";aj+="stroke : none; ";aj+="fill : "+this.styles.text+"; ";aj+="font-family : "+ax+"; ";aj+="font-size : "+ap+";";this.svgParent.innerHTML=aq;aq=this.svgParent.innerHTML.replace("</svg>","");if(this.styles.wave==="gradient"){aq+=ag}switch(this.styles.shape){case"line":aq+='<path style="'+az+'" d="';for(var at=0,av=ay.length;at<av;at++){al=Math.floor((at/av)*ai)+this.styles.left;ak=Math.floor((1-(ay[at]/255))*an)+this.styles.top;if(at===0){aq+="M"+al+" "+ak}else{aq+=" ";aq+="L"+al+" "+ak}}aq+='" />';break;case"rect":for(var at=0,av=ay.length;at<av;at++){al=Math.floor((at/av)*ai)+this.styles.left;ak=Math.floor(((ay[at]/255)-0.5)*an);aq+=(ak<0)?'<rect style="'+az+'" x="'+al+'" y="'+aB+'" width="'+this.styles.width+'" height="'+(-ak)+'" />':'<rect style="'+az+'" x="'+al+'" y="'+aB+'" width="'+this.styles.width+'" height="'+ak+'" transform="translate('+this.styles.width+" 0) rotate(180 "+al+" "+aB+')" />'}break;default:break}if((this.styles.grid!=="none")||(this.styles.text!=="none")){var ah=document.createElement("canvas").getContext("2d");for(var at=0,av=ay.length;at<av;at++){if((at%au)===0){al=Math.floor((at/av)*ai)+this.styles.left;ao=Math.floor((at/this.SAMPLE_RATE)*1000)+" ms";if(this.styles.grid!=="none"){aq+='<rect style="'+aA+'" x="'+al+'" y="'+this.styles.top+'" width="1" height="'+an+'" />'}al-=Math.floor(ah.measureText(ao).width/2);if(this.styles.text!=="none"){aq+='<text style="'+aj+'" x="'+al+'" y="'+aw+'">'+ao+"</text>"}}}var ae=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"];for(var at=0,av=ae.length;at<av;at++){ao=ae[at];al=am-Math.floor(1.5*ah.measureText(ao).width);ak=Math.floor((1-parseFloat(ao.trim()))*(an/2))+this.styles.top;if(this.styles.grid!=="none"){aq+='<rect style="'+aA+'" x="'+this.styles.left+'" y="'+ak+'" width="'+ai+'" height="1" />'}ak-=Math.floor(parseInt(ap)/4);if(this.styles.text!=="none"){aq+='<text style="'+aj+'" x="'+al+'" y="'+ak+'">'+ao+"</text>"}}}aq+="</svg>";this.svgParent.innerHTML=aq;return this};ab.prototype.toString=function(){return"SoundModule Analyser Time"};function ac(ae){ad.call(this,ae);q.call(this,false);this.type="uint";this.size=256;this.textinterval=1000}ac.prototype.param=function(ai,ak){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ag in arguments[0]){this.param(ag,arguments[0][ag])}}else{var ag=String(ai).replace(/-/g,"").toLowerCase();var aj=ad.prototype.param.call(this,ag,ak);if(aj!==undefined){return aj}else{switch(ag){case"type":if(ak===undefined){return this.type}else{var af=String(ak).toLowerCase();if((af==="uint")||(af==="float")){this.type=af}else{n(this+' param() : The value of "'+ai+'" is either "uint" or "float" !!')}}break;case"size":if(ak===undefined){return this.size}else{var af=parseFloat(ak);var ah=0;var ae=1024;if((af>=0)&&(af<=ae)){this.size=af}else{n(this+' param() : The range of "'+ai+'" is between '+ah+" and "+ae+" !!")}}break;case"textinterval":if(ak===undefined){return this.textinterval}else{var af=parseFloat(ak);if(af>0){this.textinterval=af}else{n(this+' param() : The range of "'+ai+'" is greater than 0 !!')}}break;default:if(!((ag==="interval")||(ag in this.styles))){n(this+' param() : The designated property ("'+ai+'") does not exist in accessible properties !!')}break}}}return this};ac.prototype.drawToCanvas=function(aC,aE,aD){if(!((this.canvas instanceof HTMLCanvasElement)&&this.isActive)){return this}var ak=parseFloat(aE);var av=parseFloat(aD);var aq=av-ak;var ag=this.context;var an=this.canvas.width;var aA=this.canvas.height;var ai=an-(this.styles.left+this.styles.right);var ao=aA-(this.styles.top+this.styles.bottom);var am=0;var al=0;var ap="";var ar=(this.size>aC.length)?aC.length:this.size;var ah=this.SAMPLE_RATE/(2*aC.length);var ay=Math.floor(this.textinterval/ah);ag.clearRect(0,0,an,aA);switch(this.type){case"float":ag.strokeStyle=(this.styles.wave!=="gradient")?this.styles.wave:"rgba(0, 0, 255, 1.0)";ag.lineWidth=this.styles.width;ag.lineCap=this.styles.cap;ag.lineJoin=this.styles.join;ag.beginPath();for(var ax=0;ax<ar;ax++){am=Math.floor((ax/ar)*ai)+this.styles.left;al=(Math.abs(aC[ax]-av)*(ao/aq))+this.styles.top;(ax===0)?ag.moveTo(am,al):ag.lineTo(am,al)}ag.stroke();break;case"uint":default:switch(this.styles.shape){case"line":ag.strokeStyle=this.styles.wave;ag.lineWidth=this.styles.width;ag.lineCap=this.styles.cap;ag.lineJoin=this.styles.join;ag.beginPath();for(var ax=0;ax<ar;ax++){am=Math.floor((ax/ar)*ai)+this.styles.left;al=Math.floor((1-(aC[ax]/255))*ao)+this.styles.top;(ax===0)?ag.moveTo(am,al):ag.lineTo(am,al)}ag.stroke();break;case"rect":if(this.styles.wave!=="gradient"){ag.fillStyle=this.styles.wave}for(var ax=0;ax<ar;ax++){am=Math.floor((ax/ar)*ai)+this.styles.left;al=-1*Math.floor((aC[ax]/255)*ao);if(this.styles.wave==="gradient"){var at=ao+this.styles.top;var af=ag.createLinearGradient(0,at,0,(at+al));for(var aw=0,aj=this.styles.grad.length;aw<aj;aw++){var au=this.styles.grad[aw];af.addColorStop(au.offset,au.color)}ag.fillStyle=af}ag.fillRect(am,(ao+this.styles.top),this.styles.width,al)}break;default:break}break}if((this.styles.grid!=="none")||(this.styles.text!=="none")){var aB=0;for(var ax=0;ax<ar;ax++){if((ax%ay)===0){am=Math.floor((ax/ar)*ai)+this.styles.left;aB=Math.floor(this.textinterval*(ax/ay));ap=(aB<1000)?(aB+" Hz"):(String(aB/1000).slice(0,3)+" kHz");if(this.styles.grid!=="none"){ag.fillStyle=this.styles.grid;ag.fillRect(am,this.styles.top,1,ao)}if(this.styles.text!=="none"){ag.fillStyle=this.styles.text;ag.font=this.styles.font;ag.fillText(ap,(am-(ag.measureText(ap).width/2)),aA)}}}switch(this.type){case"float":for(var ax=ak;ax<=av;ax+=10){ap=ax+"dB";am=an-Math.floor(ag.measureText(ap).width);al=Math.floor(((-1*(ax-av))/aq)*ao)+this.styles.top;if(this.styles.grid!=="none"){ag.fillStyle=this.styles.grid;ag.fillRect(this.styles.left,al,ai,1)}al-=parseInt(ag.font.match(/\s*(\d+)px.*/)[1]/4);if(this.styles.text!=="none"){ag.fillStyle=this.styles.text;ag.font=this.styles.font;ag.fillText(ap,am,al)}}break;case"uint":default:var ae=["0.00","0.25","0.50","0.75","1.00"];for(var ax=0,az=ae.length;ax<az;ax++){ap=ae[ax];am=an-Math.floor(ag.measureText(ap).width);al=((1-parseFloat(ap))*ao)+this.styles.top;if(this.styles.grid!=="none"){ag.fillStyle=this.styles.grid;ag.fillRect(this.styles.left,al,ai,1)}al-=parseInt(ag.font.match(/\s*(\d+)px.*/)[1]/4);if(this.styles.text!=="none"){ag.fillStyle=this.styles.text;ag.font=this.styles.font;ag.fillText(ap,am,al)}}break}}return this};ac.prototype.drawToSVG=function(aE,aG,aF){if(!((this.svg instanceof SVGElement)&&(this.svgParent instanceof HTMLElement)&&this.isActive)){return this}var al=parseFloat(aG);var ax=parseFloat(aF);var ar=ax-al;var av=this.svgParent.innerHTML.match(/(<svg[^<>]*>).*<\/svg>/)[1]+"</svg>";var ao=this.svg.getAttribute("width");var aB=this.svg.getAttribute("height");var aj=ao-(this.styles.left+this.styles.right);var ap=aB-(this.styles.top+this.styles.bottom);var an=0;var am=0;var aq="";var at=(this.size>aE.length)?aE.length:this.size;var ai=this.SAMPLE_RATE/(2*aE.length);var az=Math.floor(this.textinterval/ai);var aI="";switch(this.styles.shape){case"line":aI+="stroke : "+this.styles.wave+"; ";aI+="fill : none; ";aI+="stroke-width : "+this.styles.width+"; ";aI+="stroke-linecap : "+this.styles.cap+"; ";aI+="stroke-linejoin : "+this.styles.join+";";break;case"rect":if((this.type==="uint")&&(this.styles.wave==="gradient")){var ag="";ag+="<defs>";ag+='<linearGradient id="svg-linear-gradient" x1="0%" y1="0%" x2="0%" y2="100%">';for(var ay=0,aA=this.styles.grad.length;ay<aA;ay++){var aw=this.styles.grad[ay];ag+='<stop offset="'+aw.offset+'" stop-color="'+aw.color+'" />'}ag+="</linearGradient>";ag+="</defs>";aI+="stroke : none; ";aI+="fill : url(#svg-linear-gradient); ";aI+="stroke-width : 0;"}else{if((this.type==="uint")&&(this.styles.wave!=="gradient")){aI+="stroke : none; ";aI+="fill : "+this.styles.wave+"; ";aI+="stroke-width : 0;"}else{if(this.type!=="uint"){aI+="stroke : rgba(0, 0, 255, 1.0); ";aI+="fill : none; ";aI+="stroke-width : "+this.styles.width+"; ";aI+="stroke-linecap : "+this.styles.cap+"; ";aI+="stroke-linejoin : "+this.styles.join+";"}}}break;default:break}var aH="";aH+="stroke : none; ";aH+="fill : "+this.styles.grid+"; ";aH+="stroke-width : 0;";var af=this.styles.font.match(/\s*(\d+)px (.*)/);var aD=af[2];var au=af[1];var ak="";ak+="stroke : none; ";ak+="fill : "+this.styles.text+"; ";ak+="font-family : "+aD+"; ";ak+="font-size : "+au+";";this.svgParent.innerHTML=av;av=this.svgParent.innerHTML.replace("</svg>","");if((this.type==="uint")&&(this.styles.wave==="gradient")){av+=ag}switch(this.type){case"float":av+='<path style="'+aI+'" d="';for(var ay=0;ay<at;ay++){an=Math.floor((ay/at)*aj)+this.styles.left;am=Math.floor(-1*(aE[ay]-ax)*(ap/ar))+this.styles.top;if(ay===0){av+="M"+an+" "+am}else{av+=" ";av+="L"+an+" "+am}}av+='" />';break;case"uint":default:switch(this.styles.shape){case"line":av+='<path style="'+aI+'" d="';for(var ay=0;ay<at;ay++){an=Math.floor((ay/at)*aj)+this.styles.left;am=Math.floor((1-(aE[ay]/255))*ap)+this.styles.top;if(ay===0){av+="M"+an+" "+am}else{av+=" ";av+="L"+an+" "+am}}av+='" />';break;case"rect":for(var ay=0;ay<at;ay++){an=Math.floor((ay/at)*aj)+this.styles.left;am=Math.floor((aE[ay]/255)*ap);av+='<rect style="'+aI+'" x="'+an+'" y="'+(this.styles.top+ap)+'" width="'+this.styles.width+'" height="'+am+'" transform="translate('+this.styles.width+" 0) rotate(180 "+an+" "+(this.styles.top+ap)+')" />'}break;default:break}break}if((this.styles.grid!=="none")||(this.styles.text!=="none")){var ah=document.createElement("canvas").getContext("2d");var aC=0;for(var ay=0;ay<at;ay++){if((ay%az)===0){an=Math.floor((ay/at)*aj)+this.styles.left;aC=Math.floor(this.textinterval*(ay/az));aq=(aC<1000)?(aC+" Hz"):(String(aC/1000).slice(0,3)+" kHz");if(this.styles.grid!=="none"){av+='<rect style="'+aH+'" x="'+an+'" y="'+this.styles.top+'" width="1" height="'+ap+'" />'}an-=Math.floor(ah.measureText(aq).width/2);if(this.styles.text!=="none"){av+='<text style="'+ak+'" x="'+an+'" y="'+aB+'">'+aq+"</text>"}}}switch(this.type){case"float":for(var ay=al;ay<=ax;ay+=10){aq=ay+"dB";an=ao-Math.floor(1.5*ah.measureText(aq).width);am=Math.floor(((-1*(ay-ax))/ar)*ap)+this.styles.top;if(this.styles.grid!=="none"){av+='<rect style="'+aH+'" x="'+this.styles.left+'" y="'+am+'" width="'+aj+'" height="1" />'}am-=Math.floor(parseInt(au)/4);if(this.styles.text!=="none"){av+='<text style="'+ak+'" x="'+an+'" y="'+am+'">'+aq+"</text>"}}break;case"uint":default:var ae=["0.00","0.25","0.50","0.75","1.00"];for(var ay=0,aA=ae.length;ay<aA;ay++){aq=ae[ay];an=ao-Math.floor(1.5*ah.measureText(aq).width);am=((1-parseFloat(aq))*ap)+this.styles.top;if(this.styles.grid!=="none"){av+='<rect style="'+aH+'" x="'+this.styles.left+'" y="'+am+'" width="'+aj+'" height="1" />'}am-=Math.floor(parseInt(au)/4);if(this.styles.text!=="none"){av+='<text style="'+ak+'" x="'+an+'" y="'+am+'">'+aq+"</text>"}}break}}av+="</svg>";this.svgParent.innerHTML=av;return this};ac.prototype.toString=function(){return"SoundModule Analyser FFT"}}V.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"fftsize":if(ae===undefined){return this.analyser.fftSize}else{var aa=parseInt(ae);switch(aa){case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:this.analyser.fftSize=aa;break;default:n(this+' param() : The value of "'+ad+'" is one of 32 or 64 or 128 or 256 or 512 or 1024 or 2048 !!');break}}break;case"frequencybincount":return this.analyser.frequencyBinCount;case"mindecibels":case"maxdecibels":if(ae===undefined){return this.analyser[ab.replace("decibels","Decibels")]}else{var aa=parseFloat(ae);if(isNaN(aa)){n(this+' param() : The type of "'+ad+'" is number type !!')}else{this.analyser[ab.replace("decibels","Decibels")]=aa;if(this.analyser.minDecibels>=this.analyser.maxDecibels){var ac=this.analyser.minDecibels;var Z=this.analyser.maxDecibels;n(this+' param() : The designated dB (min : "'+ac+'" / max : "'+Z+'") is invalid !!');this.analyser.minDecibels=-100;this.analyser.maxDecibels=-30}}}break;case"smoothingtimeconstant":if(ae===undefined){return this.analyser.smoothingTimeConstant}else{var aa=parseFloat(ae);var ac=0;var Z=1;if((aa>=ac)&&(aa<=Z)){this.analyser.smoothingTimeConstant=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};V.prototype.start=function(ab,aa){var ac=String(ab).replace(/-/g,"").toLowerCase();switch(ac){case"timealll":if(aa instanceof AudioBuffer){if(aa.numberOfChannels>0){var Z=new Float32Array(aa.length);Z.set(aa.getChannelData(0));this.timeAllL.start(Z)}}else{n(this+" start() : The 2nd argument is the instance of AudioBuffer !!")}break;case"timeallr":if(aa instanceof AudioBuffer){if(aa.numberOfChannels>1){var Z=new Float32Array(aa.length);Z.set(aa.getChannelData(1));this.timeAllR.start(Z)}}else{n(this+" start() : The 2nd argument is the instance of AudioBuffer !!")}break;case"time":var Z=new Uint8Array(this.analyser.fftSize);this.analyser.getByteTimeDomainData(Z);this.time.start(Z);this.time.timerid=r.setTimeout(function(){this.start(ab)}.bind(this),this.time.interval);break;case"fft":if(this.fft.type==="uint"){var Z=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(Z);this.fft.start(Z)}else{var Z=new Float32Array(this.analyser.frequencyBinCount);this.analyser.getFloatFrequencyData(Z);this.fft.start(Z,this.analyser.minDecibels,this.analyser.maxDecibels)}this.fft.timerid=r.setTimeout(function(){this.start(ab)}.bind(this),this.fft.interval);break;default:n(this+' start() : The 1st argument is one of "timeAllL" or "timeAllR" or "time" or "fft" !!');break}return this};V.prototype.stop=function(Z){var aa=String(Z).replace(/-/g,"").toLowerCase();switch(aa){case"timealll":case"timeallr":break;case"time":r.clearTimeout(this.time.timerid);this.time.timerid=null;break;case"fft":r.clearTimeout(this.fft.timerid);this.fft.timerid=null;break;default:n(this+' stop() : The 1st argument is one of "timeAllL" or "timeAllR" or "time" or "fft" !!');break}return this};V.prototype.domain=function(Z){var aa=String(Z).replace(/-/g,"").toLowerCase();switch(aa){case"timealll":case"timeallr":return this["timeAll"+aa.slice(-1).toUpperCase()];case"time":case"fft":return this[aa];default:n(this+' domain() : The 1st argument is one of "timeAllL" or "timeAllR" or "time" or "fft" !!');break}};V.prototype.toString=function(){return"SoundModule Analyser"};function J(ab,ac,aa,Z){this.SAMPLE_RATE=ab.sampleRate;this.context=ab;this.processor=ab.createScriptProcessor(ac,aa,Z);this.mixLs=[];this.mixRs=[];this.trackLs=[];this.trackRs=[];this.numtrack=0;this.activeTrack=-1;this.paused=true;this.gainL=1;this.gainR=1}J.prototype.setup=function(Z){var ab=parseInt(Z);if(ab>0){this.numTrack=ab;this.trackLs=new Array(this.numTrack);this.trackRs=new Array(this.numTrackn);for(var aa=0;aa<ab;aa++){this.trackLs[aa]=[]}for(var aa=0;aa<ab;aa++){this.trackRs[aa]=[]}}else{this.numTrack=1;this.trackLs=new Array(this.numTrack);this.trackRs=new Array(this.numTrack);this.trackLs[0]=[];this.trackRs[0]=[]}return this};J.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"gainl":case"gainr":if(ae===undefined){return this["gain"+ab.slice(-1).toUpperCase()]}else{var aa=parseFloat(ae);var ac=0;var Z=1;if((aa>=ac)&&(aa<=Z)){this["gain"+ab.slice(-1).toUpperCase()]=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};J.prototype.ready=function(Z){if(this.isTrack(Z)){this.activeTrack=Z-1}return this};J.prototype.start=function(){if((this.getActiveTrack()!==-1)&&this.paused){var Z=this;this.paused=false;this.processor.onaudioprocess=function(ad){if(Z.getActiveTrack()!==-1){var ab=ad.inputBuffer.getChannelData(0);var ac=ad.inputBuffer.getChannelData(1);for(var aa=0;aa<this.bufferSize;aa++){Z.trackLs[Z.activeTrack].push(Z.gainL*ab[aa]);Z.trackRs[Z.activeTrack].push(Z.gainR*ac[aa])}}else{this.disconnect(0)}}}return this};J.prototype.stop=function(){this.activeTrack=-1;this.paused=true;this.processor.disconnect(0);return this};J.prototype.isTrack=function(Z){var aa=parseInt(Z)-1;if((aa>=0)&&(aa<this.numTrack)){return true}else{n(this+" isTrack() : The 1st argument is number type between 0 and "+(this.numTrack-1)+" !!");return false}};J.prototype.getActiveTrack=function(){return this.activeTrack};J.prototype.mix=function(){if(this.getActiveTrack()!==-1){this.stop()}var Z=function(af){var ac=(af==="L")?this.trackLs:this.trackRs;var ae={values:[],sum:0,num:0};var ad=0;while(true){for(var ab=0,aa=ac.length;ab<aa;ab++){if(ac[ab][ad]!==undefined){ae.sum+=ac[ab][ad];ae.num++}}if(ae.num>0){ae.values[ad]=ae.sum/ae.num;ae.sum=0;ae.num=0;ad++}else{if(af==="L"){this.mixLs=ae.values.slice(0,ae.values.length)}if(af==="R"){this.mixRs=ae.values.slice(0,ae.values.length)}break}}};Z.call(this,"L");Z.call(this,"R");return this};J.prototype.clear=function(aa){if(this.getActiveTrack()!==-1){this.stop()}if(String(aa).toLowerCase()==="all"){for(var ab=0,Z=this.trackLs.length;ab<Z;ab++){this.trackLs[ab].length=0}for(var ab=0,Z=this.trackRs.length;ab<Z;ab++){this.trackRs[ab].length=0}}else{if(this.isTrack(aa)){this.trackLs[aa-1].length=0;this.trackRs[aa-1].length=0}}return this};J.prototype.create=function(ap,Z,ah,at){if(this.getActiveTrack()!==-1){this.stop()}var aj=[];var ak=[];if(String(ap).toLowerCase()==="all"){this.mix();aj=this.mixLs;ak=this.mixRs}else{if(this.isTrack(ap)){aj=this.trackLs[ap-1];ak=this.trackRs[ap-1]}}if((aj.length===0)&&(ak.length===0)){return}var ao=(Z===1)?1:2;var aq=(ah===8)?8:16;var al=[];var ae=Math.min(aj.length,ak.length);switch(aq){case 8:for(var au=0;au<ae;au++){var aa=0;if((au%ao)===0){aa=((aj[au]+1)/2)*(Math.pow(2,8)-1)}else{aa=((ak[au-1]+1)/2)*(Math.pow(2,8)-1)}if(aa>(Math.pow(2,8)-1)){aa=(Math.pow(2,8)-1)}if(aa<(Math.pow(2,0)-1)){aa=(Math.pow(2,0)-1)}al.push(Math.floor(aa))}break;case 16:for(var au=0;au<ae;au++){var aa=0;if((au%ao)===0){aa=Math.floor(aj[au]*Math.pow(2,15))}else{aa=Math.floor(ak[au-1]*Math.pow(2,15))}if(aa>(Math.pow(2,15)-1)){aa=Math.pow(2,15)-1}if(aa<(-Math.pow(2,15)-1)){aa=-Math.pow(2,15)-1}if(aa<0){aa+=Math.pow(2,16)}al.push(aa)}break;default:break}var aw=28;var ax=8+(ae*ao*(aq/8));var an=36+(ae*ao*(aq/8));var ar=8+(aw+ax);var ag=(this.SAMPLE_RATE*0.5);var ay=(this.SAMPLE_RATE*0.5)*ao*(aq/8);var am=ae*ao*(aq/8);switch(String(at).toLowerCase()){case"base64":var ai="";ai+="RIFF";ai+=String.fromCharCode(((an>>0)&255),((an>>8)&255),((an>>16)&255),((an>>24)&255));ai+="WAVE";ai+="fmt "+String.fromCharCode(16,0,0,0);ai+=String.fromCharCode(1,0);ai+=String.fromCharCode(ao,0);ai+=String.fromCharCode(((ag>>0)&255),((ag>>8)&255),((ag>>16)&255),((ag>>24)&255));ai+=String.fromCharCode(((ay>>0)&255),((ay>>8)&255),((ay>>16)&255),((ay>>24)&255));ai+=String.fromCharCode((ao*(aq/8)),0);ai+=String.fromCharCode(aq,0);ai+="data";ai+=String.fromCharCode(((am>>0)&255),((am>>8)&255),((am>>16)&255),((am>>24)&255));for(var au=0,av=al.length;au<av;au++){ai+=String.fromCharCode(((al[au]>>0)&255),((al[au]>>8)&255))}var ad=r.btoa(ai);var af="data:audio/wav;base64,"+ad;return af;case"blob":default:var ac=[];ac[0]=82;ac[1]=73;ac[2]=70;ac[3]=70;ac[4]=(an>>0)&255;ac[5]=(an>>8)&255;ac[6]=(an>>16)&255;ac[7]=(an>>24)&255;ac[8]=87;ac[9]=65;ac[10]=86;ac[11]=69;ac[12]=102;ac[13]=109;ac[14]=116;ac[15]=32;ac[16]=16;ac[17]=0;ac[18]=0;ac[19]=0;ac[20]=1;ac[21]=0;ac[22]=ao;ac[23]=0;ac[24]=(ag>>0)&255;ac[25]=(ag>>8)&255;ac[26]=(ag>>16)&255;ac[27]=(ag>>24)&255;ac[28]=(ay>>0)&255;ac[29]=(ay>>8)&255;ac[30]=(ay>>16)&255;ac[31]=(ay>>24)&255;ac[32]=ao*(aq/8);ac[33]=0;ac[34]=aq;ac[35]=0;ac[36]=100;ac[37]=97;ac[38]=116;ac[39]=97;ac[40]=(am>>0)&255;ac[41]=(am>>8)&255;ac[42]=(am>>16)&255;ac[43]=(am>>24)&255;for(var au=0,av=al.length;au<av;au++){ac[(ar-am)+(2*au)]=((al[au]>>0)&255);ac[(ar-am)+(2*au)+1]=((al[au]>>8)&255)}r.URL=r.URL||r.webkitURL;var ab=new Blob([new Uint8Array(ac)],{type:"audio/wav"});var az=r.URL.createObjectURL(ab);return az}};J.prototype.toString=function(){return"SoundModule Recorder"};function Q(ac,ad,ab,Z,aa){q.call(this,false);this.context=ac;this.analyser=aa;this.sender=ac.createScriptProcessor(((ad<2048)?ad:2048),ab,Z);this.receiver=ac.createScriptProcessor(((ad<2048)?ad:2048),ab,Z);this.websocket=null;this.paused=true}Q.prototype.setup=function(ae,ai,ac,aj,ag,Z,ad){if(navigator.onLine){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){var af=arguments[0];if("tls" in af){ae=af.tls}if("host" in af){ai=af.host}if("port" in af){ac=af.port}if("path" in af){aj=af.path}if("open" in af){ag=af.open}if("close" in af){Z=af.close}if("error" in af){ad=af.error}}var ab=ae?"wss://":"ws://";if(aj.charAt(0)!=="/"){aj="/"+aj}var aa=parseInt(ac);if(isNaN(aa)||(aa<0)||(aa>65535)){n(this+" setup() : The 3rd argument is number type for port number (0 - 65535)");return}this.websocket=new WebSocket(ab+ai+":"+aa+aj);this.websocket.binaryType="arraybuffer";var ah=this;this.websocket.onopen=function(ak){if(Object.prototype.toString.call(ag)==="[object Function]"){ag(ak,ah.websocket)}};this.websocket.onclose=function(ak){if(Object.prototype.toString.call(Z)==="[object Function]"){Z(ak,ah.websocket)}};this.websocket.onerror=function(ak){if(Object.prototype.toString.call(ad)==="[object Function]"){ad(ak,ah.websocket)}};this.websocket.onmessage=function(an){if(ah.isActive){if(an.data instanceof ArrayBuffer){var am=an.data.byteLength/Float32Array.BYTES_PER_ELEMENT;var al=Math.floor(am/2);var ap=al*Float32Array.BYTES_PER_ELEMENT;var ak=new Float32Array(an.data,0,al);var ao=new Float32Array(an.data,ap,al);ah.receiver.connect(ah.analyser.input);ah.analyser.output.connect(ah.context.destination);ah.analyser.start("time");ah.analyser.start("fft");ah.receiver.onaudioprocess=function(at){var aq=at.outputBuffer.getChannelData(0);var ar=at.outputBuffer.getChannelData(1);aq.set(ak);ar.set(ao);if(!ah.isActive||(ah.websocket===null)){ah.analyser.stop("time");ah.analyser.stop("fft");this.disconnect(0)}}}}else{ah.analyser.stop("time");ah.analyser.stop("fft");ah.receiver.disconnect(0)}}}else{this.websocket=null;this.isActive=false;throw new Error("Now offline !!")}return this};Q.prototype.start=function(){if(this.isActive&&this.isConnected()&&this.paused){this.paused=false;var Z=new Float32Array(2*this.sender.bufferSize);var aa=this;this.sender.onaudioprocess=function(ae){if(aa.isActive&&aa.isConnected()){var ac=ae.inputBuffer.getChannelData(0);var ad=ae.inputBuffer.getChannelData(1);for(var ab=0;ab<this.bufferSize;ab++){Z[ab]=ac[ab];Z[(Z.length/2)+ab]=ad[ab]}aa.websocket.send(Z)}else{aa.paused=true;aa.sender.disconnect(0)}}}return this};Q.prototype.close=function(){if(this.websocket instanceof WebSocket){this.websocket.close();this.websocket=null}return this};Q.prototype.isConnected=function(){return((this.websocket instanceof WebSocket)&&(this.websocket.readyState===WebSocket.OPEN))?true:false};Q.prototype.toString=function(){return"SoundModule Session"};function N(Z,aa){q.call(this,true);this.context=Z;this.input=Z.createGain();this.output=Z.createGain();this.lfo=Z.createOscillator();this.depth=Z.createGain();this.rate=this.lfo.frequency;this.processor=Z.createScriptProcessor(aa,1,2);this.lfo.start=this.lfo.start||this.lfo.noteOn;this.lfo.stop=this.lfo.stop||this.lfo.noteOff;this.values={};this.isStart=false}N.prototype.param=function(Z,aa){return this};N.prototype.start=function(aa){if(this.isActive&&!this.isStart){var Z=parseFloat(aa);if(isNaN(Z)||(Z<this.context.currentTime)){Z=this.context.currentTime}this.lfo.start(Z);this.isStart=true}return this};N.prototype.stop=function(ad,Z){if(this.isActive&&this.isStart){var ac=parseFloat(ad);var ae=parseFloat(Z);if(isNaN(ac)||(ac<this.context.currentTime)){ac=this.context.currentTime}if(isNaN(ae)||(ae<0)){ae=0}var ab=this.lfo.type;var aa=this.lfo.frequency.value;this.lfo.stop(ac+ae);this.lfo=this.context.createOscillator();this.lfo.type=ab;this.lfo.frequency.value=aa;this.rate=this.lfo.frequency;this.lfo.start=this.lfo.start||this.lfo.noteOn;this.lfo.stop=this.lfo.stop||this.lfo.noteOff;this.isStart=false}return this};N.prototype.toString=function(){return"SoundModule Effector"};function X(Z,aa){N.call(this,Z,aa);this.compressor=Z.createDynamicsCompressor();this.input.connect(this.compressor);this.compressor.connect(this.output);this.compressor.threshold.value=-24;this.compressor.knee.value=30;this.compressor.ratio.value=12;this.compressor.attack.value=0.003;this.compressor.release.value=0.25}X.prototype.param=function(ae,ag){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ae).replace(/-/g,"").toLowerCase();if(ab in this.compressor){if(ag===undefined){return this.compressor[ab].value}else{var aa=parseFloat(ag);var af={threshold:-100,knee:0,ratio:1,attack:0,release:0};var ac={threshold:0,knee:40,ratio:20,attack:1,release:1};var ad=this.compressor[ab].minValue||af[ab];var Z=this.compressor[ab].maxValue||ac[ab];if((aa>=ad)&&(aa<=Z)){this.compressor[ab].value=aa}else{n(this+' param() : The range of "'+ae+'" is between '+ad+" and "+Z+" !!")}}}else{n(this+' param() : The designated property ("'+ae+'") does not exist in accessible properties !!')}}return this};X.prototype.toString=function(){return"SoundModule Compressor"};function O(Z,aa){N.call(this,Z,aa);this.distortion=Z.createWaveShaper();this.clean=Z.createGain();this.drive=Z.createGain();this.size=16384;this.createCurve=function(ae,af){if((ae>0)&&(ae<1)){var ag=new Float32Array(af);var ac=(2*ae)/(1-ae);for(var ad=0;ad<af;ad++){var ab=(ad-0)*(1-(-1))/(af-0)+(-1);ag[ad]=(1+ac)*ab/(1+ac*Math.abs(ab))}this.distortion.curve=ag}else{this.distortion.curve=null}};this.input.connect(this.clean);this.clean.connect(this.output);this.input.connect(this.distortion);this.distortion.connect(this.drive);this.drive.connect(this.output);this.clean.gain.value=1;this.drive.gain.value=0}O.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"drive":if(ae===undefined){return this.drive.gain.value}else{var aa=parseFloat(ae);var ac=this.drive.gain.minValue||0;var Z=this.drive.gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this.drive.gain.value=aa;this.clean.gain.value=1-this.drive.gain.value}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"size":if(ae===undefined){return this.size}else{var aa=parseInt(ae);if(aa>=0){this.size=aa}else{n(this+' param() : The range of "'+ad+'" is greater than or equal 0 !!')}}break;case"curve":if(ae===undefined){return this.distortion.curve}else{switch(String(ae).toLowerCase()){case"clean":this.createCurve(0,this.size);break;case"crunch":this.createCurve(0.2,this.size);break;case"overdrive":this.createCurve(0.5,this.size);break;case"distortion":this.createCurve(0.7,this.size);break;case"fuzz":this.createCurve(0.9,this.size);break;default:n(this+' param() : The value of "'+ad+'" is one of "clean" or "crunch" or "overdrive" or "distortion" or "fuzz" !!');break}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};O.prototype.toString=function(){return"SoundModule Distortion"};function W(Z,aa){N.call(this,Z,aa);this.lowpass=Z.createBiquadFilter();this.mix=Z.createGain();this.lowpass.LOWPASS=this.lowpass.LOWPASS||0;this.input.connect(this.output);this.input.connect(this.lowpass);this.lowpass.connect(this.mix);this.mix.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.lowpass.frequency);this.lowpass.type=(Object.prototype.toString.call(this.lowpass.type)==="[object String]")?"lowpass":this.lowpass.LOWPASS;this.lowpass.frequency.value=500;this.lowpass.gain.value=0;this.lowpass.Q.value=1;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0}W.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"depth":if(ae===undefined){return this.depth.gain.value}else{var aa=parseFloat(ae);var ac=0;var Z=this.lowpass.frequency.value;if((aa>=ac)&&(aa<=Z)){this.depth.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"rate":if(ae===undefined){return this.rate.value}else{var aa=parseFloat(ae);var ac=this.rate.minValue||0;var Z=this.rate.maxValue||100000;if((aa>=ac)&&(aa<=Z)){this.rate.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"mix":if(ae===undefined){return this.mix.gain.value}else{var aa=parseFloat(ae);var ac=this.mix.gain.minValue||0;var Z=this.mix.gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this.mix.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"resonance":if(ae===undefined){return this.lowpass.Q.value}else{var aa=parseFloat(ae);var ac=this.lowpass.Q.minValue||0.0001;var Z=this.lowpass.Q.maxValue||1000;if((aa>=ac)&&(aa<=Z)){this.lowpass.Q.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};W.prototype.stop=function(aa,Z){N.prototype.stop.call(this,aa,Z);if(this.isActive){this.lfo.connect(this.depth);this.depth.connect(this.lowpass.frequency)}return this};W.prototype.toString=function(){return"SoundModule Wah"};function P(Z,aa){N.call(this,Z,aa);this.bass=Z.createBiquadFilter();this.middle=Z.createBiquadFilter();this.treble=Z.createBiquadFilter();this.presence=Z.createBiquadFilter();this.bass.LOWSHELF=this.bass.LOWSHELF||3;this.middle.PEAKING=this.middle.PEAKING||5;this.treble.HIGHSHELF=this.treble.HIGHSHELF||4;this.presence.HIGHSHELF=this.presence.HIGHSHELF||4;this.input.connect(this.bass);this.bass.connect(this.middle);this.middle.connect(this.treble);this.treble.connect(this.presence);this.presence.connect(this.output);this.bass.type=(Object.prototype.toString.call(this.bass.type)==="[object String]")?"lowshelf":this.bass.LOWSHELF;this.middle.type=(Object.prototype.toString.call(this.middle.type)==="[object String]")?"peaking":this.middle.PEAKING;this.treble.type=(Object.prototype.toString.call(this.treble.type)==="[object String]")?"highshelf":this.treble.HIGHSHELF;this.presence.type=(Object.prototype.toString.call(this.presence.type)==="[object String]")?"highshelf":this.presence.HIGHSHELF;this.bass.frequency.value=500;this.middle.frequency.value=1000;this.treble.frequency.value=2000;this.presence.frequency.value=4000;this.middle.Q.value=Math.SQRT1_2;this.bass.gain.value=0;this.middle.gain.value=0;this.treble.gain.value=0;this.presence.gain.value=0}P.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"bass":case"middle":case"treble":case"presence":if(ae===undefined){return this[ab].gain.value}else{var aa=parseFloat(ae);var ac=this[ab].gain.minValue||-40;var Z=this[ab].gain.maxValue||40;if((aa>=ac)&&(aa<=Z)){this[ab].gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};P.prototype.toString=function(){return"SoundModule Equalizer"};function Y(Z,aa){N.call(this,Z,aa);this.filter=Z.createBiquadFilter();this.filter.LOWPASS=this.filter.LOWPASS||0;this.filter.HIGHPASS=this.filter.HIGHPASS||1;this.filter.BANDPASS=this.filter.BANDPASS||2;this.filter.LOWSHELF=this.filter.LOWSHELF||3;this.filter.HIGHSHELF=this.filter.HIGHSHELF||4;this.filter.PEAKING=this.filter.PEAKING||5;this.filter.NOTCH=this.filter.NOTCH||6;this.filter.ALLPASS=this.filter.ALLPASS||7;this.input.connect(this.filter);this.filter.connect(this.output);this.filter.frequency.setTargetAtTime=this.filter.frequency.setTargetAtTime||this.filter.frequency.setTargetValueAtTime;this.filter.type=(Object.prototype.toString.call(this.filter.type)==="[object String]")?"lowpass":this.filter.LOWPASS;this.filter.frequency.value=350;this.filter.Q.value=1;this.filter.gain.value=0;this.maxFrequency=this.filter.frequency.value;this.attack=0.01;this.decay=0.3;this.sustain=0.5;this.release=1}Y.prototype.param=function(ae,af){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ac in arguments[0]){this.param(ac,arguments[0][ac])}}else{var ac=String(ae).replace(/-/g,"").toLowerCase();switch(ac){case"type":if(af===undefined){return this.filter.type}else{var ab=String(af).toLowerCase();var aa={lowpass:this.filter.LOWPASS,highpass:this.filter.HIGHPASS,bandpass:this.filter.BANDPASS,lowshelf:this.filter.LOWSHELF,highshelf:this.filter.HIGHSHELF,peaking:this.filter.PEAKING,notch:this.filter.NOTCH,allpass:this.filter.ALLPASS};if(ab in aa){this.filter.type=(Object.prototype.toString.call(this.filter.type)==="[object String]")?ab:aa[ab]}else{n(this+' param() : The value of "'+ae+'" is one of "lowpass" or "highpass" or "bandpass" or "lowshelf" or "highshelf" or "peaking" or "notch" or "allpass" !!')}}break;case"frequency":if(af===undefined){return this.filter.frequency.value}else{var ab=parseFloat(af);var ad=this.filter.frequency.minValue||10;var Z=this.filter.frequency.maxValue||(this.context.sampleRate/2);if((ab>=ad)&&(ab<=Z)){this.maxFrequency=ab;this.filter.frequency.value=ab}else{n(this+' param() : The range of "'+ae+'" is between '+ad+" and "+Z+" !!")}}break;case"gain":if(af===undefined){return this.filter.gain.value}else{var ab=parseFloat(af);var ad=this.filter.gain.minValue||-40;var Z=this.filter.gain.maxValue||40;if((ab>=ad)&&(ab<=Z)){this.filter.gain.value=ab}else{n(this+' param() : The range of "'+ae+'" is between '+ad+" and "+Z+" !!")}}break;case"q":if(af===undefined){return this.filter.Q.value}else{var ab=parseFloat(af);var ad=this.filter.Q.minValue||0.0001;var Z=this.filter.Q.maxValue||1000;if((ab>=ad)&&(ab<=Z)){this.filter.Q.value=ab}else{n(this+' param() : The range of "'+ae+'" is between '+ad+" and "+Z+" !!")}}break;case"attack":case"decay":case"sustain":case"release":if(af===undefined){return this[ac]}else{var ab=parseFloat(af);if(ab>=0){this[ac]=ab}else{n(this+' param() : The range of "'+ae+'" is greater than or equal 0 !!')}}break;default:n(this+' param() : The designated property ("'+ae+'") does not exist in accessible properties !!');break}}return this};Y.prototype.start=function(ac){if(this.isActive){var ab=parseFloat(ac);if(isNaN(ab)||(ab<this.context.currentTime)){ab=this.context.currentTime}var ae=ab;var ad=ae+this.attack;var aa=this.decay;var Z=this.sustain*this.filter.frequency.value;this.filter.frequency.cancelScheduledValues(ae);this.filter.frequency.setValueAtTime(this.filter.frequency.defaultValue,ae);this.filter.frequency.linearRampToValueAtTime(this.maxFrequency,ad);this.filter.frequency.setTargetAtTime(Z,ad,aa)}return this};Y.prototype.stop=function(ac){if(this.isActive){var ab=parseFloat(ac)-this.release;if(isNaN(ab)||(ab<this.context.currentTime)){ab=this.context.currentTime}var aa=ab;var Z=this.release;this.filter.frequency.cancelScheduledValues(aa);this.filter.frequency.setValueAtTime(this.filter.frequency.value,aa);this.filter.frequency.setTargetAtTime(this.filter.frequency.defaultValue,aa,Z)}return this};Y.prototype.toString=function(){return"SoundModule Filter"};function M(Z,aa){N.call(this,Z,aa);this.amplitude=Z.createGain();this.input.connect(this.amplitude);this.amplitude.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain);this.amplitude.gain.value=1;this.depth.gain.value=0;this.rate.value=0}M.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"depth":if(ae===undefined){return this.depth.gain.value}else{var aa=parseFloat(ae);var ac=this.depth.gain.minValue||0;var Z=this.depth.gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this.depth.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"rate":if(ae===undefined){return this.rate.value}else{var aa=parseFloat(ae);var ac=this.rate.minValue||0;var Z=this.rate.maxValue||100000;if((aa>=ac)&&(aa<=Z)){this.rate.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};M.prototype.stop=function(aa,Z){N.prototype.stop.call(this,aa,Z);if(this.isActive){this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain)}return this};M.prototype.toString=function(){return"SoundModule Tremolo"};function H(Z,aa){N.call(this,Z,aa);this.amplitude=Z.createGain();this.input.connect(this.amplitude);this.amplitude.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain);this.amplitude.gain.value=1;this.depth.gain.value=0;this.rate.value=0}H.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"depth":if(ae===undefined){return this.depth.gain.value}else{var aa=parseFloat(ae);var ac=this.depth.gain.minValue||0;var Z=this.depth.gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this.depth.gain.value=aa;this.amplitude.gain.value=((this.depth.gain.value===0)||(this.rate.value===0))?1:0}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"rate":if(ae===undefined){return this.rate.value}else{var aa=parseFloat(ae);var ac=this.rate.minValue||0;var Z=this.rate.maxValue||100000;if((aa>=ac)&&(aa<=Z)){this.rate.value=aa;this.amplitude.gain.value=((this.depth.gain.value===0)||(this.rate.value===0))?1:0}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};H.prototype.stop=function(aa,Z){N.prototype.stop.call(this,aa,Z);if(this.isActive){this.lfo.connect(this.depth);this.depth.connect(this.amplitude.gain)}return this};H.prototype.toString=function(){return"SoundModule Ringmodulator"};function U(Z,aa){N.call(this,Z,aa);this.amplitudeL=Z.createGain();this.amplitudeR=Z.createGain();this.splitter=Z.createChannelSplitter(2);this.merger=Z.createChannelMerger(2);this.input.connect(this.splitter);this.splitter.connect(this.amplitudeL,0,0);this.splitter.connect(this.amplitudeR,1,0);this.amplitudeL.connect(this.merger,0,0);this.amplitudeR.connect(this.merger,0,1);this.merger.connect(this.output);this.lfoSplitter=Z.createChannelSplitter(2);this.lfo.connect(this.depth);this.depth.connect(this.processor);this.processor.connect(this.lfoSplitter);this.lfoSplitter.connect(this.amplitudeL.gain,0);this.lfoSplitter.connect(this.amplitudeR.gain,1);this.amplitudeL.gain.value=1;this.amplitudeR.gain.value=1;this.depth.gain.value=0;this.rate.value=0}U.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"depth":if(ae===undefined){return this.depth.gain.value}else{var aa=parseFloat(ae);var ac=this.depth.gain.minValue||0;var Z=this.depth.gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this.depth.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"rate":if(ae===undefined){return this.rate.value}else{var aa=parseFloat(ae);var ac=this.rate.minValue||0;var Z=this.rate.maxValue||100000;if((aa>=ac)&&(aa<=Z)){this.rate.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};U.prototype.start=function(ab){if(this.isActive&&!this.isStart){var aa=parseFloat(ab);if(isNaN(aa)||(aa<this.context.currentTime)){aa=this.context.currentTime}this.lfo.start(aa);this.isStart=true;var Z=this;this.processor.onaudioprocess=function(ag){var ac=ag.inputBuffer.getChannelData(0);var ad=ag.outputBuffer.getChannelData(0);var af=ag.outputBuffer.getChannelData(1);if(Z.isActive&&(Z.depth.gain.value!==0)&&(Z.rate.value!==0)){for(var ae=0;ae<this.bufferSize;ae++){ad[ae]=ac[ae];af[ae]=-ac[ae]}}else{for(var ae=0;ae<this.bufferSize;ae++){ad[ae]=0;af[ae]=0}}}}return this};U.prototype.stop=function(aa,Z){N.prototype.stop.call(this,aa,Z);if(this.isActive){this.processor.disconnect(0);this.lfo.connect(this.depth);this.depth.connect(this.processor);this.processor.connect(this.lfoSplitter);this.lfoSplitter.connect(this.amplitudeL.gain,0);this.lfoSplitter.connect(this.amplitudeR.gain,1)}return this};U.prototype.toString=function(){return"SoundModule Autopanner"};function T(ab,ac){N.call(this,ab,ac);this.NUM_FILTER=12;this.filters=new Array(this.NUM_FILTER);for(var aa=0;aa<this.NUM_FILTER;aa++){this.filters[aa]=ab.createBiquadFilter();this.filters[aa].ALLPASS=this.filters[aa].ALLPASS||7;this.filters[aa].type=(Object.prototype.toString.call(this.filters[aa].type)==="[object String]")?"allpass":this.filters[aa].ALLPASS;this.filters[aa].frequency.value=350;this.filters[aa].Q.value=Math.SQRT1_2;this.filters[aa].gain.value=0}this.mix=ab.createGain();this.input.connect(this.output);this.input.connect(this.filters[0]);for(var aa=0;aa<this.NUM_FILTER;aa++){if(aa<(this.NUM_FILTER-1)){this.filters[aa].connect(this.filters[aa+1])}else{this.filters[aa].connect(this.mix);this.mix.connect(this.output)}}this.lfo.connect(this.depth);for(var aa=0,Z=this.filters.length;aa<Z;aa++){this.depth.connect(this.filters[aa].frequency)}this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0}T.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"depth":if(ae===undefined){return this.depth.gain.value}else{var aa=parseFloat(ae);var ac=0;var Z=this.filters[0].frequency.value;if((aa>=ac)&&(aa<=Z)){this.depth.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"rate":if(ae===undefined){return this.rate.value}else{var aa=parseFloat(ae);var ac=this.rate.minValue||0;var Z=this.rate.maxValue||100000;if((aa>=ac)&&(aa<=Z)){this.rate.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"mix":if(ae===undefined){return this.mix.gain.value}else{var aa=parseFloat(ae);var ac=this.mix.gain.minValue||0;var Z=this.mix.gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this.mix.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};T.prototype.stop=function(ac,aa){N.prototype.stop.call(this,ac,aa);if(this.isActive){this.lfo.connect(this.depth);for(var ab=0,Z=this.filters.length;ab<Z;ab++){this.depth.connect(this.filters[ab].frequency)}}return this};T.prototype.toString=function(){return"SoundModule Phaser"};function K(Z,aa){N.call(this,Z,aa);this.delay=Z.createDelay();this.mix=Z.createGain();this.feedback=Z.createGain();this.input.connect(this.output);this.input.connect(this.delay);this.delay.connect(this.feedback);this.feedback.connect(this.delay);this.delay.connect(this.mix);this.mix.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime);this.delay.delayTime.value=0.005;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0;this.feedback.gain.value=0}K.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"depth":if(ae===undefined){return this.depth.gain.value}else{var aa=parseFloat(ae);var ac=0;var Z=Math.ceil(this.delay.delayTime.value*1000)/1000;if((aa>=ac)&&(aa<=Z)){this.depth.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"rate":if(ae===undefined){return this.rate.value}else{var aa=parseFloat(ae);var ac=this.rate.minValue||0;var Z=this.rate.maxValue||100000;if((aa>=ac)&&(aa<=Z)){this.rate.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"mix":case"feedback":if(ae===undefined){return this[ab].gain.value}else{var aa=parseFloat(ae);var ac=this[ab].gain.minValue||0;var Z=this[ab].gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this[ab].gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};K.prototype.stop=function(aa,Z){N.prototype.stop.call(this,aa,Z);if(this.isActive){this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime)}return this};K.prototype.toString=function(){return"SoundModule Flanger"};function S(Z,aa){N.call(this,Z,aa);this.delay=Z.createDelay();this.mix=Z.createGain();this.feedback=Z.createGain();this.input.connect(this.output);this.input.connect(this.delay);this.delay.connect(this.feedback);this.feedback.connect(this.delay);this.delay.connect(this.mix);this.mix.connect(this.output);this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime);this.delay.delayTime.value=0.02;this.depth.gain.value=0;this.rate.value=0;this.mix.gain.value=0;this.feedback.gain.value=0}S.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"depth":if(ae===undefined){return this.depth.gain.value}else{var aa=parseFloat(ae);var ac=0;var Z=Math.ceil(this.delay.delayTime.value*100)/100;if((aa>=ac)&&(aa<=Z)){this.depth.gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"rate":if(ae===undefined){return this.rate.value}else{var aa=parseFloat(ae);var ac=this.rate.minValue||0;var Z=this.rate.maxValue||100000;if((aa>=ac)&&(aa<=Z)){this.rate.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"mix":case"feedback":if(ae===undefined){return this[ab].gain.value}else{var aa=parseFloat(ae);var ac=this[ab].gain.minValue||0;var Z=this[ab].gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this[ab].gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};S.prototype.stop=function(aa,Z){N.prototype.stop.call(this,aa,Z);if(this.isActive){this.lfo.connect(this.depth);this.depth.connect(this.delay.delayTime)}return this};S.prototype.toString=function(){return"SoundModule Chorus"};function F(Z,aa){N.call(this,Z,aa);this.MAX_DELAY_TIME=5;this.delay=Z.createDelay(this.MAX_DELAY_TIME);this.dry=Z.createGain();this.wet=Z.createGain();this.feedback=Z.createGain();this.input.connect(this.dry);this.dry.connect(this.output);this.input.connect(this.delay);this.delay.connect(this.feedback);this.feedback.connect(this.delay);this.delay.connect(this.wet);this.wet.connect(this.output);this.delay.delayTime.value=0;this.dry.gain.value=1;this.wet.gain.value=0;this.feedback.gain.value=0}F.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"delaytime":if(ae===undefined){return this.delay.delayTime.value}else{var aa=parseFloat(ae);var ac=this.delay.delayTime.minValue||0;var Z=this.delay.delayTime.maxValue||this.MAX_DELAY_TIME;if((aa>=ac)&&(aa<=Z)){this.delay.delayTime.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;case"dry":case"wet":case"feedback":if(ae===undefined){return this[ab].gain.value}else{var aa=parseFloat(ae);var ac=this[ab].gain.minValue||0;var Z=this[ab].gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this[ab].gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};F.prototype.toString=function(){return"SoundModule Delay"};function L(Z,aa){N.call(this,Z,aa);this.dry=Z.createGain();this.wet=Z.createGain();this.convolver=Z.createConvolver();this.decodeAudioData=function(ad,ab,ac){Z.decodeAudioData(ad,ab,ac)};this.input.connect(this.dry);this.dry.connect(this.output);this.input.connect(this.convolver);this.convolver.connect(this.wet);this.wet.connect(this.output);this.dry.gain.value=1;this.wet.gain.value=0}L.prototype.param=function(ad,ae){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var ab in arguments[0]){this.param(ab,arguments[0][ab])}}else{var ab=String(ad).replace(/-/g,"").toLowerCase();switch(ab){case"dry":case"wet":if(ae===undefined){return this[ab].gain.value}else{var aa=parseFloat(ae);var ac=this[ab].gain.minValue||0;var Z=this[ab].gain.maxValue||1;if((aa>=ac)&&(aa<=Z)){this[ab].gain.value=aa}else{n(this+' param() : The range of "'+ad+'" is between '+ac+" and "+Z+" !!")}}break;default:n(this+' param() : The designated property ("'+ad+'") does not exist in accessible properties !!');break}}return this};L.prototype.start=function(ab,aa){var Z=function(ac){this.convolver.buffer=ac};if(Object.prototype.toString.call(aa)!=="[object Function]"){aa=function(){}}this.decodeAudioData(ab,Z.bind(this),aa.bind(this));return this};L.prototype.toString=function(){return"SoundModule Reverb"};function R(Z,aa){N.call(this,Z,aa);this.panner=Z.createPanner();this.panner.EQUALPOWER=this.panner.EQUALPOWER||0;this.panner.HRTF=this.panner.HRTF||1;this.panner.LINEAR_DISTANCE=this.panner.LINEAR_DISTANCE||0;this.panner.INVERSE_DISTANCE=this.panner.INVERSE_DISTANCE||1;this.panner.EXPONENTIAL_DISTANCE=this.panner.EXPONENTIAL_DISTANCE||2;this.input.connect(this.panner);this.panner.connect(this.output);this.positions={x:0,y:0,z:0};this.orientations={x:1,y:0,z:0};this.velocities={x:0,y:0,z:0};this.panner.refDistance=1;this.panner.maxDistance=10000;this.panner.rolloffFactor=1;this.panner.coneInnerAngle=360;this.panner.coneOuterAngle=360;this.panner.coneOuterGain=0;this.panner.panningModel=(Object.prototype.toString.call(this.panner.panningModel)==="[object String]")?"HRTF":1;this.panner.distanceModel=(Object.prototype.toString.call(this.panner.distanceModel)==="[object String]")?"inverse":1;this.panner.setPosition(this.positions.x,this.positions.y,this.positions.z);this.panner.setOrientation(this.orientations.x,this.orientations.y,this.orientations.z);this.panner.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z)}R.prototype.param=function(ab,ac){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var aa in arguments[0]){this.param(aa,arguments[0][aa])}}else{var aa=String(ab).replace(/-/g,"").toLowerCase();switch(aa){case"x":case"y":case"z":if(ac===undefined){return this.positions[aa]}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.positions[aa]=Z;this.panner.setPosition(this.positions.x,this.positions.y,this.positions.z)}}break;case"ox":case"oy":case"oz":if(ac===undefined){return this.orientations[aa.charAt(1)]}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.orientations[aa.charAt(1)]=Z;this.panner.setOrientation(this.orientations.x,this.orientations.y,this.orientations.z)}}break;case"vx":case"vy":case"vz":if(ac===undefined){return this.velocities[aa.charAt(1)]}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.velocities[aa.charAt(1)]=Z;this.panner.setVelocity(this.velocities.x,this.velocities.y,this.velocities.z)}}break;case"refdistance":if(ac===undefined){return this.panner.refDistance}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.panner.refDistance=Z}}break;case"maxdistance":if(ac===undefined){return this.panner.maxDistance}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.panner.maxDistance=Z}}break;case"rollofffactor":if(ac===undefined){return this.panner.rolloffFactor}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.panner.rolloffFactor=Z}}break;case"coneinnerangle":if(ac===undefined){return this.panner.coneInnerAngle}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.panner.coneInnerAngle=Z}}break;case"coneouterangle":if(ac===undefined){return this.panner.coneOuterAngle}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.panner.coneOuterAngle=Z}}break;case"coneoutergain":if(ac===undefined){return this.panner.coneOuterGain}else{var Z=parseFloat(ac);if(isNaN(Z)){n(this+' param() : The type of "'+ab+'" is number type !!')}else{this.panner.coneOuterGain=Z}}break;case"panningmodel":if(ac===undefined){return this.panner.panningModel}else{var Z=/HRTF/i.test(ac)?String(ac).toUpperCase():String(ac).toLowerCase();var ad={equalpower:this.panner.EQUALPOWER,HRTF:this.panner.HRTF};if(Z in ad){this.panner.panningModel=(Object.prototype.toString.call(this.panner.panningModel)==="[object String]")?Z:ad[Z]}else{n(this+' param() : The value of "'+ab+'" is either "equalpower" or "HRTF" !!')}}break;case"distancemodel":if(ac===undefined){return this.panner.distanceModel}else{var Z=String(ac).replace(/-/g,"").toLowerCase();var ad={linear:this.panner.LINEAR_DISTANCE,inverse:this.panner.INVERSE_DISTANCE,exponential:this.panner.EXPONENTIAL_DISTANCE};if(Z in ad){this.panner.distanceModel=(Object.prototype.toString.call(this.panner.distanceModel)==="[object String]")?Z:ad[Z]}else{n(this+' param() : The value of "'+ab+'" is one of "linear" or "inverse" or "exponential" !!')}}break;default:n(this+' param() : The designated property ("'+ab+'") does not exist in accessible properties !!');break}}return this};R.prototype.toString=function(){return"SoundModule Panner"};function D(Z){this.context=Z;this.generators=[];this.activeIndexes=[];this.activeCounter=0;this.attack=0.01;this.decay=0.3;this.sustain=0.5;this.release=1}D.prototype.param=function(ab,ac){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var aa in arguments[0]){this.param(aa,arguments[0][aa])}}else{var aa=String(ab).replace(/-/g,"").toLowerCase();switch(aa){case"attack":case"decay":case"sustain":case"release":if(ac===undefined){return this[aa]}else{var Z=parseFloat(ac);if(Z>=0){this[aa]=Z}else{n(this+' param() : The type of "'+ab+'" is greater than or equal 0 !!')}}break;default:n(this+' param() : The designated property ("'+ab+'") does not exist in accessible properties !!');break}}return this};D.prototype.isStop=function(){var ab=[];for(var ac=0,aa=this.activeIndexes.length;ac<aa;ac++){var Z=this.activeIndexes[ac];if(Z===undefined){continue}if(this.generators[Z].gain.value>0.001){return false}else{ab.push(Z);if(ab.length===this.activeCounter){return true}}}};D.prototype.ready=function(ab,aa,Z){var ac=(parseInt(ab)>=0)?parseInt(ab):0;aa.connect(this.generators[ac]);this.generators[ac].connect(Z);this.activeIndexes[ac]=ac;this.activeCounter++;return this};D.prototype.start=function(Z){var ah=parseFloat(Z);if(isNaN(ah)||(ah<this.context.currentTime)){ah=this.context.currentTime}var ad=ah;var ac=ad+this.attack;var ab=this.decay;var af=this.sustain;for(var aa=0,ae=this.activeIndexes.length;aa<ae;aa++){var ag=this.activeIndexes[aa];if(ag===undefined){continue}this.generators[ag].gain.cancelScheduledValues(ad);this.generators[ag].gain.setValueAtTime(0,ad);this.generators[ag].gain.linearRampToValueAtTime(1,ac);this.generators[ag].gain.setTargetAtTime(af,ac,ab)}return this};D.prototype.stop=function(af){var ae=parseFloat(af)-this.release;if(isNaN(ae)||(ae<this.context.currentTime)){ae=this.context.currentTime}var ad=ae;var ab=this.release;for(var ac=0,aa=this.activeIndexes.length;ac<aa;ac++){var Z=this.activeIndexes[ac];if(Z===undefined){continue}this.generators[Z].gain.cancelScheduledValues(ad);this.generators[Z].gain.setValueAtTime(this.generators[Z].gain.value,ad);this.generators[Z].gain.setTargetAtTime(0,ad,ab)}return this};D.prototype.clear=function(){this.activeIndexes=[];this.activeCounter=0;return this};D.prototype.toString=function(){return"OscillatorModule EnvelopeGenerator"}}e.prototype.setup=function(){};e.prototype.param=function(H,I){var F=String(H).replace(/-/g,"").toLowerCase();switch(F){case"mastervolume":if(I===undefined){return this.masterVolume.gain.value}else{var E=parseFloat(I);var G=this.masterVolume.gain.minValue||0;var D=this.masterVolume.gain.maxValue||1;if((E>=G)&&(E<=D)){this.masterVolume.gain.value=E}else{n(this+" param() : The range of "+H+" is between "+G+" and "+D+" !!")}}break;default:break}};e.prototype.ready=function(){};e.prototype.start=function(){};e.prototype.stop=function(){};e.prototype.getContext=function(){return this.context};e.prototype.resize=function(D){e.call(this,audiocontext,D);return this};e.prototype.connect=function(H,E){if(Array.isArray(E)){this.nodes=E}var G=[];for(var F=0,D=this.nodes.length;F<D;F++){if(this.nodes[F].isActive){G.push(this.nodes[F])}else{this.nodes[F].output.disconnect(0)}}H.disconnect(0);if(G.length>0){H.connect(G[0].input)}else{H.connect(this.masterVolume)}for(var F=0,D=G.length;F<D;F++){G[F].output.disconnect(0);if(F<(G.length-1)){G[F].output.connect(G[F+1].input)}else{G[F].output.connect(this.masterVolume)}}this.masterVolume.connect(this.analyser.input);this.analyser.output.connect(this.context.destination);this.masterVolume.connect(this.recorder.processor);this.recorder.processor.connect(this.context.destination);this.masterVolume.connect(this.session.sender);this.session.sender.connect(this.context.destination);return this};e.prototype.module=function(G){var E=String(G).replace(/-/g,"").toLowerCase();switch(E){case"listener":case"analyser":case"recorder":case"session":case"compressor":case"distortion":case"wah":case"equalizer":case"filter":case"tremolo":case"ringmodulator":case"autopanner":case"phaser":case"flanger":case"chorus":case"delay":case"reverb":case"panner":return this[E];case"eg":if(E in this){return this[E]}case"glide":if(E in this){return this[E]}case"vocalcanceler":if(E in this){return this[E]}default:for(var F=0,D=this.plugins.length;F<D;F++){if(E===this.plugins[F].name){return this.plugins[F].plugin}}n(this+' param() : The designated property ("'+G+'") does not exist in accessible properties !!');break}};e.prototype.effector=function(D){if(Object.prototype.toString.call(D)==="[object Function]"){D.prototype=x(Effector.prototype);D.prototype.constructor=D;return D}else{n(this+" effector : The 1st argument is class (function) for created effector !!")}};e.prototype.install=function(E,D){this.plugins.push({name:String(E).toLowerCase(),plugin:new D(audiocontext)});return this};e.prototype.toString=function(){return"SoundModule"};function g(E){e.call(this,E);this.sources=[];this.times={start:0,stop:0};this.isAnalyser=false;this.glide=new D(E);function D(F){this.context=F;this.frequencies={start:-1,end:0};this.rate=0;this.time=0;this.type="linear"}D.prototype.param=function(H,I){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var G in arguments[0]){this.param(G,arguments[0][G])}}else{var G=String(H).replace(/-/g,"").toLowerCase();switch(G){case"time":if(I===undefined){return this.time}else{var F=parseFloat(I);if(F>=0){this.time=F}else{n(this+' param() : The range of "'+H+'" is greater than or equal 0 !!')}}break;case"type":if(I===undefined){return this.type}else{var F=String(I).toLowerCase();if((F==="linear")||(F==="exponential")){this.type=F}else{n(this+' param() : The value of "'+H+'" is either "linear" or "exponential" !!')}}break;default:n(this+' param() : The designated property ("'+H+'") does not exist in accessible properties !!');break}}return this};D.prototype.ready=function(G){this.frequencies.end=G;var F=(this.frequencies.start===-1)?0:(this.frequencies.end-this.frequencies.start);if((this.frequencies.start===-1)||(this.time===0)||(F===0)){this.frequencies.start=this.frequencies.end}else{this.rate=F/this.time}return this};D.prototype.start=function(F,H){var G=parseFloat(H);if(isNaN(G)||(G<this.context.currentTime)){G=this.context.currentTime}var J=G;var I=J+this.time;F.frequency.cancelScheduledValues(J);F.frequency.setValueAtTime(this.frequencies.start,J);F.frequency[this.type+"RampToValueAtTime"](this.frequencies.end,I);return this};D.prototype.stop=function(){this.frequencies.start=this.frequencies.end;return this};D.prototype.toString=function(){return"OscillatorModule Glide"}}g.prototype=x(e.prototype);g.prototype.constructor=g;g.prototype.setup=function(E){G.prototype=implement(q.prototype);G.prototype.constructor=G;if(!Array.isArray(E)){E=[E]}for(var F=0,D=E.length;F<D;F++){this.sources[F]=new G(this.context,Boolean(E[F]));this.eg.generators[F]=this.context.createGain();this.eg.generators[F].gain.setTargetAtTime=this.eg.generators[F].gain.setTargetAtTime||this.eg.generators[F].gain.setTargetValueAtTime}function G(H,I){q.call(this,I);this.source=H.createOscillator();this.source.start=this.source.start||this.source.noteOn;this.source.stop=this.source.stop||this.source.noteOff;this.volume=H.createGain();this.isStart=false;this.octave=0;this.fine=0}G.prototype.param=function(N,O){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var K in arguments[0]){this.param(K,arguments[0][K])}}else{var K=String(N).replace(/-/g,"").toLowerCase();var L=1200;switch(K){case"type":if(O===undefined){return this.type}else{var J=String(O).toLowerCase();this.source.SINE=this.source.SINE||0;this.source.SQUARE=this.source.SQUARE||1;this.source.SAWTOOTH=this.source.SAWTOOTH||2;this.source.TRIANGLE=this.source.TRIANGLE||3;var I={sine:this.source.SINE,square:this.source.SQUARE,sawtooth:this.source.SAWTOOTH,triangle:this.source.TRIANGLE};if(J in I){this.source.type=(Object.prototype.toString.call(this.source.type)==="[object String]")?J:I[J]}else{n(this+' param() : The value of "'+N+'" is one of "sine" or "square" or "sawtooth" or "triangle" !!')}}break;case"octave":if(O===undefined){return this.octave}else{var J=this.octave=parseFloat(O);var M=(this.source.detune.minValue||-4800)/L;var H=(this.source.detune.maxValue||4800)/L;if((J>=M)&&(J<=H)){this.source.detune.value=this.fine+(J*L)}else{n(this+" param() : The range of "+N+" is between "+M+" and "+H+" !!")}}break;case"fine":if(O===undefined){return this.fine}else{var J=this.fine=parseFloat(O);var M=-L;var H=L;if((J>=M)&&(J<=H)){this.source.detune.value=J+(this.octave*L)}else{n(this+" param() : The range of "+N+" is between "+M+" and "+H+" !!")}}break;case"volume":case"gain":if(O===undefined){return this.volume.gain.value}else{var J=parseFloat(O);var M=this.volume.gain.minValue||0;var H=this.volume.gain.maxValue||1;if((J>=M)&&(J<=H)){this.volume.gain.value=J}else{n(this+" param() : The range of "+N+" is between "+M+" and "+H+" !!")}}break;default:n(this+' param() : The designated property ("'+N+'") does not exist in accessible properties !!');break}}return this};G.prototype.toString=function(){return"OscillatorModule Oscillator"};return this};g.prototype.param=function(E,G){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var D in arguments[0]){this.param(D,arguments[0][D])}}else{var D=String(E).replace(/-/g,"").toLowerCase();var F=e.prototype.param.call(this,D,G)}return(F===undefined)?this:F};g.prototype.ready=function(F,E){var D=parseFloat(F);var G=parseFloat(E);if(D>0){this.times.start=D}if(G>D){this.times.stop=G}return this};g.prototype.start=function(E,H,F){var D=this.context.currentTime+this.times.start;if(!Array.isArray(E)){E=[E]}if(E.length<this.sources.length){var N=this.sources.length-E.length;for(var I=0;I<N;I++){E.push(0)}}for(var I=0,K=E.length;I<K;I++){var J=parseFloat(E[I]);E[I]=(J>=0)?J:0}this.eg.clear();this.processor.disconnect(0);this.connect(this.processor,H);for(var I=0,K=this.sources.length;I<K;I++){var M=this.sources[I];if(M.isActive){var L=E.shift();this.glide.ready(L);if(M.isStart){var G={};G.type=M.source.type;G.frequency=M.source.frequency.value;G.detune=M.source.detune.value;M.source.stop(0);M.source=this.context.createOscillator();M.source.start=M.source.start||M.source.noteOn;M.source.stop=M.source.stop||M.source.noteOff;M.source.type=G.type;M.source.frequency.value=G.frequency;M.source.detune.value=G.detune}this.eg.ready(I,M.source,M.volume);M.volume.connect(this.processor);M.source.start(D);this.glide.start(M.source,D);M.isStart=true}else{M.source.disconnect(0)}}this.eg.start(D);this.chorus.start(D);this.flanger.start(D);this.phaser.start(D);this.autopanner.start(D);this.tremolo.start(D);this.ringmodulator.start(D);this.wah.start(D);this.filter.start(D);for(var I=0,K=this.plugins.length;I<K;I++){if(this.plugins[I].plugin.isActive){this.plugins[I].plugin.start(D)}}if(!this.isAnalyser){this.analyser.start("time");this.analyser.start("fft");this.isAnalyser=true}if(Object.prototype.toString.call(F)==="[object Function]"){this.processor.onaudioprocess=F}else{this.processor.onaudioprocess=function(S){var Q=S.inputBuffer.getChannelData(0);var R=S.inputBuffer.getChannelData(1);var O=S.outputBuffer.getChannelData(0);var P=S.outputBuffer.getChannelData(1);O.set(Q);P.set(R)}}return this};g.prototype.stop=function(H){var G=this.context.currentTime+this.times.stop;this.eg.stop(G);this.glide.stop();this.filter.stop(G);for(var F=0,D=this.plugins.length;F<D;F++){if(this.plugins[F].plugin.isActive){this.plugins[F].plugin.stop(G,this.eg.release)}}var E=this;if(Object.prototype.toString.call(H)==="[object Function]"){this.processor.onaudioprocess=H}else{this.processor.onaudioprocess=function(M){var K=M.inputBuffer.getChannelData(0);var L=M.inputBuffer.getChannelData(1);var I=M.outputBuffer.getChannelData(0);var J=M.outputBuffer.getChannelData(1);I.set(K);J.set(L);if(E.eg.isStop()){E.chorus.stop(0);E.flanger.stop(0);E.phaser.stop(0);E.autopanner.stop(0);E.tremolo.stop(0);E.ringmodulator.stop(0);E.wah.stop(0);E.analyser.stop("time");E.analyser.stop("fft");E.isAnalyser=false;this.disconnect(0)}else{}}}return this};g.prototype.toString=function(){return"OscillatorModule"};function f(D){e.call(this,D);this.sources=[];this.urls=[];this.buffers=[];this.volumes=[];this.isStarts=[];this.settings=[];this.times={start:0,stop:0};this.isAnalyser=false}f.prototype=x(e.prototype);f.prototype.constructor=f;f.prototype.setup=function(O,G,Q,E,J,H){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){var N=arguments[0];if("urls" in N){O=N.urls}if("settings" in N){G=N.settings}if("timeout" in N){Q=N.timeout}if("success" in N){E=N.success}if("error" in N){J=N.error}if("progress" in N){H=N.progress}}if(!Array.isArray(O)){O=[O]}this.urls=O;if(!Array.isArray(G)){G=[G]}this.buffers.length=O.length;for(var I=0,K=G.length;I<K;I++){if("buffer" in G[I]){var D=parseInt(G[I].buffer);if((D>=0)&&(D<this.buffers.length)){G[I].buffer=D}else{n(this+' setup() : The "buffer" property in the 2nd argument is number type between 0 and '+(this.buffers.length-1)+" !!");return}}else{n(this+' setup() : The element of array in the 2nd argument  requires "buffer" property !!');return}G[I].rate=(("rate" in G[I])&&(G[I].rate>=0))?parseFloat(G[I].rate):1;G[I].loop=("loop" in G[I])?Boolean(G[I].loop):false;G[I].start=(("start" in G[I])&&(G[I].start>=0))?parseFloat(G[I].start):0;G[I].end=(("end" in G[I])&&(G[I].end>=0))?parseFloat(G[I].end):0;G[I].volume=(("volume" in G[I])&&(G[I].volume>=0)&&(G[I].volume<=1))?parseFloat(G[I].volume):1;for(var I=0,K=G.length;I<K;I++){this.isStarts[I]=false;this.volumes[I]=this.context.createGain();this.eg.generators[I]=this.context.createGain();this.eg.generators[I].gain.setTargetAtTime=this.eg.generators[I].gain.setTargetAtTime||this.eg.generators[I].gain.setTargetValueAtTime}this.settings=G}var S=parseInt(Q);var M="error";var P="timeout";var F="decode";var L=false;var R=function(U,T){var W=new XMLHttpRequest();W.responseType="arraybuffer";var V=r.setTimeout(function(){W.abort();if(!L&&(Object.prototype.toString.call(J)==="[object Function]")){J(W,P)}L=true},((S>0)?S:60000));W.onreadystatechange=function(){if(L){W.abort()}else{if(W.readyState===W.LOADING){if(Object.prototype.toString.call(H)==="[object Function]"){H(W)}}else{if(W.readyState===W.DONE){r.clearTimeout(V);if(W.status===200){var Y=W.response;if(Y instanceof ArrayBuffer){var X=function(ac){this.buffers[T]=ac;for(var ab=0,aa=this.buffers.length;ab<aa;ab++){if(this.buffers[ab]===undefined){return}}if(Object.prototype.toString.call(E)==="[object Function]"){E.call(this,this.buffers)}};var Z=function(aa){if(Object.prototype.toString.call(J)==="[object Function]"){J(aa,F)}};this.context.decodeAudioData(Y,X.bind(this),Z.bind(this))}}}}}}.bind(this);W.onerror=function(){if(!L&&(Object.prototype.toString.call(J)==="[object Function]")){J(W,M)}L=true};W.open("GET",U,true);W.send(null)};for(var I=0,K=this.urls.length;I<K;I++){R.call(this,this.urls[I],I)}return this};f.prototype.param=function(E,G){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var D in arguments[0]){this.param(D,arguments[0][D])}}else{var D=String(E).replace(/-/g,"").toLowerCase();var F=e.prototype.param.call(this,D,G)}return(F===undefined)?this:F};f.prototype.ready=function(F,E){var D=parseFloat(F);var G=parseFloat(E);if(D>0){this.times.start=D}if(G>D){this.times.stop=G}return this};f.prototype.start=function(P,K,H){if((P>=0)&&(P<this.settings.length)){var R=parseInt(P)}else{n(this+" start() : The 1st argument is number type between 0 and "+(this.settings.length-1)+" !!");return}var J=this.settings[R].buffer;var E=this.settings[R].rate;var N=this.settings[R].loop;var I=this.settings[R].start;var G=this.settings[R].end;var M=this.settings[R].volume;if(this.buffers[J]===undefined){return}if(this.sources[R]!==undefined){this.sources[R].stop(0);this.sources[R].disconnect(0);delete this.sources[R]}var D=this.context.createBufferSource();D.buffer=this.buffers[J];D.playbackRate.value=E;D.loop=N;D.loopStart=I;D.loopEnd=G;this.volumes[R].gain.value=M;this.eg.ready(R,D,this.volumes[R]);this.volumes[R].connect(this.processor);this.connect(this.processor,K);var F=this.context.currentTime+this.times.start;D.start=D.start||D.noteGrainOn;D.stop=D.stop||D.noteOff;D.start(F);D.onended=function(){this.isStarts[R]=false}.bind(this);this.sources[R]=D;this.eg.start(F);this.chorus.start(F);this.flanger.start(F);this.phaser.start(F);this.autopanner.start(F);this.tremolo.start(F);this.ringmodulator.start(F);this.wah.start(F);this.filter.start(F);for(var L=0,O=this.plugins.length;L<O;L++){if(this.plugins[L].plugin.isActive){this.plugins[L].plugin.start(F)}}if(!this.isAnalyser){this.analyser.start("time");this.analyser.start("fft");this.isAnalyser=true}this.isStarts[R]=true;var Q=this;if(Object.prototype.toString.call(H)==="[object Function]"){this.processor.onaudioprocess=H}else{this.processor.onaudioprocess=function(X){var S=Q.isStarts.some(function(Z,Y,aa){return Z});if(S){var V=X.inputBuffer.getChannelData(0);var W=X.inputBuffer.getChannelData(1);var T=X.outputBuffer.getChannelData(0);var U=X.outputBuffer.getChannelData(1);T.set(V);U.set(W)}else{Q.chorus.stop();Q.flanger.stop();Q.phaser.stop();Q.autopanner.stop();Q.tremolo.stop();Q.ringmodulator.stop();Q.wah.stop();Q.eg.clear();Q.analyser.stop("time");Q.analyser.stop("fft");Q.isAnalyser=false;Q.processor.disconnect(0)}}}return this};f.prototype.stop=function(G){if((G>=0)&&(G<this.settings.length)){var E=parseInt(G);var F=this.settings[E].buffer}else{n(this+" stop() : The 1st argument is number type between 0 and "+(this.settings.length-1)+" !!");return}if((this.buffers[F]===undefined)||(this.sources[E]===undefined)){return}var I=this.context.currentTime+this.times.stop;this.eg.stop(I);this.filter.stop(I);for(var H=0,D=this.plugins.length;H<D;H++){if(this.plugins[H].plugin.isActive){this.plugins[H].plugin.stop(I,this.eg.release)}}return this};f.prototype.toString=function(){return"OneshotModule"};function p(D){e.call(this,D);this.source=D.createBufferSource();this.buffer=null;this.currentTime=0;this.paused=true;this.callbacks={decode:function(){},ready:function(){},start:function(){},stop:function(){},update:function(){},ended:function(){},error:function(){}};this.vocalcanceler=new E();function E(){this.depth=0}E.prototype.param=function(J,K){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var H in arguments[0]){this.param(H,arguments[0][H])}}else{var H=String(J).replace(/-/g,"").toLowerCase();switch(H){case"depth":if(K===undefined){return this.depth}else{var G=parseFloat(K);var I=0;var F=1;if((G>=I)&&(G<=F)){this.depth=G}else{n(this+" param() : The range of "+J+" is between "+I+" and "+F+" !!")}}break;default:n(this+' param() : The designated property ("'+J+'") does not exist in accessible properties !!');break}}return this};E.prototype.start=function(G,F){return G-(this.depth*F)}}p.prototype=x(e.prototype);p.prototype.constructor=p;p.prototype.setup=function(E,F){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var D in arguments[0]){this.setup(D,arguments[0][D])}}else{var D=String(E).replace(/-/g,"").toLowerCase();if(D in this.callbacks){if(Object.prototype.toString.call(F)==="[object Function]"){this.callbacks[D]=F}else{n(this+' setup() : The type of "'+E+'" is function !!')}}else{n(this+' setup() : The designated property ("'+E+'") does not exist in accessible properties !!')}}return this};p.prototype.param=function(H,J){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var F in arguments[0]){this.param(F,arguments[0][F])}}else{var F=String(H).replace(/-/g,"").toLowerCase();var I=e.prototype.param.call(this,F,J);if(I!==undefined){return I}else{switch(F){case"playbackrate":if(J===undefined){return this.source.playbackRate.value}else{var E=parseFloat(J);var G=this.source.playbackRate.minValue||0;var D=this.source.playbackRate.maxValue||1024;if((E>=G)&&(E<=D)){this.source.playbackRate.value=E}else{n(this+" param() : The range of "+H+" is between "+G+" and "+D+" !!")}}break;case"loop":case"looping":if(J===undefined){return this.source.loop}else{this.source.loop=Boolean(J)}break;case"currenttime":if(J===undefined){return this.currentTime}else{var E=parseFloat(J);if(this.buffer instanceof AudioBuffer){var D=this.buffer.duration;var G=0}else{this.currentTime=0;break}if((E>=G)&&(E<=D)){if(this.paused){this.stop();this.currentTime=E}else{this.stop();this.start(E)}}else{n(this+" param() : The range of "+H+" is between "+G+" and "+D+" !!")}}break;case"duration":return(this.buffer instanceof AudioBuffer)?this.buffer.duration:0;case"samplerate":return(this.buffer instanceof AudioBuffer)?this.buffer.sampleRate:this.SAMPLE_RATE;case"channels":return(this.buffer instanceof AudioBuffer)?this.buffer.numberOfChannels:0;default:if(F!=="mastervolume"){n(this+' param() : The designated property ("'+H+'") does not exist in accessible properties !!')}break}}}return this};p.prototype.ready=function(E){if(E instanceof ArrayBuffer){var D=function(F){this.buffer=F;this.analyser.start("time-all-L",F);this.analyser.start("time-all-R",F);this.callbacks.ready(F)};this.context.decodeAudioData(E,D.bind(this),this.callbacks.error.bind(this));this.callbacks.decode(E)}else{n(this+" ready() : The 1st argument is ArrayBuffer for audio !!")}return this};p.prototype.start=function(I,F,E){if((this.buffer instanceof AudioBuffer)&&this.paused){var K=parseFloat(I);this.currentTime=((K>=0)&&(K<=this.buffer.duration))?K:0;var D=this.source.playbackRate.value;var H=this.source.loop;this.source=this.context.createBufferSource();this.source.buffer=this.buffer;this.source.playbackRate.value=D;this.source.loop=H;this.source.connect(this.processor);this.connect(this.processor,F);this.source.start=this.source.start||this.source.noteGrainOn;this.source.stop=this.source.stop||this.source.noteOff;this.source.start(0,K,(this.buffer.duration-K));this.analyser.start("time");this.analyser.start("fft");this.paused=false;this.chorus.start(this.context.currentTime);this.flanger.start(this.context.currentTime);this.phaser.start(this.context.currentTime);this.autopanner.start(this.context.currentTime);this.tremolo.start(this.context.currentTime);this.ringmodulator.start(this.context.currentTime);this.wah.start(this.context.currentTime);for(var G=0,J=this.plugins.length;G<J;G++){if(this.plugins[G].plugin.isActive){this.plugins[G].plugin.start(this.context.currentTime)}}this.callbacks.start(this.source,this.currentTime);var L=this;if(Object.prototype.toString.call(E)==="[object Function]"){this.processor.onaudioprocess=E}else{this.processor.onaudioprocess=function(T){var R=T.inputBuffer.getChannelData(0);var S=T.inputBuffer.getChannelData(1);var O=T.outputBuffer.getChannelData(0);var Q=T.outputBuffer.getChannelData(1);if(L.currentTime<Math.floor(L.source.buffer.duration)){for(var P=0;P<this.bufferSize;P++){O[P]=L.vocalcanceler.start(R[P],S[P]);Q[P]=L.vocalcanceler.start(S[P],R[P]);L.currentTime+=((1*L.source.playbackRate.value)/L.source.buffer.sampleRate);var N=Math.floor(L.currentTime*L.source.buffer.sampleRate);var M=1*L.source.buffer.sampleRate;if((N%M)===0){L.callbacks.update(L.source,L.currentTime)}}L.analyser.timeAllL.update(L.currentTime);L.analyser.timeAllR.update(L.currentTime)}else{if(L.source.loop){L.currentTime=0}else{L.end.call(L)}}}}}return this};p.prototype.stop=function(){if((this.buffer instanceof AudioBuffer)&&!this.paused){this.source.stop(this.context.currentTime);this.chorus.stop(this.context.currentTime);this.flanger.stop(this.context.currentTime);this.phaser.stop(this.context.currentTime);this.autopanner.stop(this.context.currentTime);this.tremolo.stop(this.context.currentTime);this.ringmodulator.stop(this.context.currentTime);this.wah.stop(this.context.currentTime);for(var E=0,D=this.plugins.length;E<D;E++){if(this.plugins[E].plugin.isActive){this.plugins[E].plugin.stop(this.context.currentTime)}}this.analyser.stop("time");this.analyser.stop("fft");this.processor.disconnect(0);this.paused=true;this.callbacks.stop(this.source,this.currentTime)}return this};p.prototype.toggle=function(D,E,F){if(this.paused){this.start(D,E,F)}else{this.stop()}return this};p.prototype.end=function(){this.stop();this.currentTime=0;this.callbacks.ended(this.source,this.currentTime);return this};p.prototype.isBuffer=function(){return(this.buffer instanceof AudioBuffer)?true:false};p.prototype.isSource=function(){return((this.source instanceof AudioBufferSourceNode)&&(this.source.buffer instanceof AudioBuffer))?true:false};p.prototype.isPaused=function(){return this.paused};p.prototype.toString=function(){return"AudioModule"};function c(D){p.call(this,D);this.source=null;this.media=null;this.ex="";this.duration=0;this.playbackRate=1;this.controls=false;this.loop=false;this.muted=false;this.callbacks={loadstart:function(){}}}c.prototype=x(p.prototype);c.prototype.constructor=c;c.prototype.setup=function(D,K,L,I){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){var J=arguments[0];if("id" in J){D=J.id}if("type" in J){K=J.type}if("formats" in J){L=J.formats}if("callbacks" in J){I=J.callbacks}}var G=String(D);var O=(String(K).toLowerCase()!=="video")?"audio":"video";this.media=((D!==null)&&(G!==""))?document.getElementById(G):document.createElement(O);if(!(this.media instanceof HTMLMediaElement)){this.media=null;n(this+" setup() : The media element that has the designated ID does not exists !!");return}if(!Array.isArray(L)){L=[L]}for(var F=0,H=L.length;F<H;F++){var M=O+"/"+String(L[F]).toLowerCase();if(/^(?:maybe|probably)/.test(this.media.canPlayType(M))){this.ex=L[F];break}}if(this.ex===""){throw new Error("Media format that can be played does not exist !!")}if(Object.prototype.toString.call(I)==="[object Object]"){for(var E in I){this.callbacks[E.toLowerCase()]=(Object.prototype.toString.call(I[E])==="[object Function]")?I[E]:function(){}}}var N=this;for(var E in this.callbacks){switch(E){case"loadstart":this.media.addEventListener("loadstart",function(P){if(N.source===null){N.source=N.context.createMediaElementSource(this)}N.callbacks.loadstart(P,this)},false);break;case"loadedmetadata":this.media.addEventListener("loadedmetadata",function(P){N.duration=this.duration;N.callbacks.loadedmetadata(P,this)},false);break;case"ended":this.media.addEventListener("ended",function(R){this.pause();N.chorus.stop(N.context.currentTime);N.flanger.stop(N.context.currentTime);N.phaser.stop(N.context.currentTime);N.autopanner.stop(N.context.currentTime);N.tremolo.stop(N.context.currentTime);N.ringmodulator.stop(N.context.currentTime);N.wah.stop(N.context.currentTime);for(var Q=0,P=N.plugins.length;Q<P;Q++){if(N.plugins[Q].plugin.isActive){N.plugins[Q].plugin.stop(N.context.currentTime)}}N.analyser.stop("time");N.analyser.stop("fft");N.processor.disconnect(0);N.callbacks.ended(R,this)},false);break;default:this.media.addEventListener(E,function(P){N.callbacks[(P.type).toLowerCase()](P,this)},false);break}}return this};c.prototype.param=function(H,J){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var F in arguments[0]){this.param(F,arguments[0][F])}}else{var F=String(H).replace(/-/g,"").toLowerCase();var I=e.prototype.param.call(this,F,J);if(I!==undefined){return I}else{switch(F){case"playbackrate":if(J===undefined){return(this.media instanceof HTMLMediaElement)?this.media.playbackRate:this.playbackRate}else{var E=parseFloat(J);var G=0.5;if(E>=G){if(this.media instanceof HTMLMediaElement){this.media.playbackRate=E}this.playbackRate=E}else{n(this+" param() : The range of "+H+" is greater than or equal 0.5 !!")}}break;case"currenttime":if(J===undefined){return(this.media instanceof HTMLMediaElement)?this.media.currentTime:0}else{var E=parseFloat(J);if(this.media instanceof HTMLMediaElement){var G=0;var D=this.duration}else{return}if((E>=G)&&(E<=D)){this.media.currentTime=E}else{n(this+" param() : The range of "+H+" is between "+G+" and "+D+" !!")}}break;case"loop":case"muted":case"controls":if(J===undefined){return(this.media instanceof HTMLMediaElement)?this.media[F]:this[F]}else{if(this.media instanceof HTMLMediaElement){this.media[F]=Boolean(J)}this[F]=Boolean(J)}break;case"width":case"height":if(J===undefined){return(this.media instanceof HTMLVideoElement)?this.media[F]:0}else{var E=parseInt(J);var G=0;if(E>=G){if(this.media instanceof HTMLVideoElement){this.media[F]=E}}else{n(this+" param() : The range of "+H+" is greater than or equal "+G+" !!")}}break;case"duration":return this.duration;case"channels":return(this.source instanceof MediaElementAudioSourceNode)?this.source.channelCount:0;default:if(F!=="mastervolume"){n(this+' param() : The designated property ("'+H+'") does not exist in accessible properties !!')}break}}}return this};c.prototype.ready=function(E){var F=String(E);try{if(F.indexOf("data:")!==-1){this.media.src=F}else{this.media.src=F+"."+this.ex}}catch(D){throw new Error("The designated resource cannot be loaded !!")}return this};c.prototype.start=function(E,G,I){if((this.source instanceof MediaElementAudioSourceNode)&&this.media.paused){this.source.connect(this.processor);this.connect(this.processor,G);this.media.play();var J=parseFloat(E);this.media.currentTime=((J>=0)&&(J<=this.duration))?J:0;this.media.playbackRate=this.playbackRate;this.media.controls=this.controls;this.media.loop=this.loop;this.media.muted=this.muted;this.chorus.start(this.context.currentTime);this.flanger.start(this.context.currentTime);this.phaser.start(this.context.currentTime);this.autopanner.start(this.context.currentTime);this.tremolo.start(this.context.currentTime);this.ringmodulator.start(this.context.currentTime);this.wah.start(this.context.currentTime);for(var H=0,D=this.plugins.length;H<D;H++){if(this.plugins[H].plugin.isActive){this.plugins[H].plugin.start(this.context.currentTime)}}this.analyser.start("time");this.analyser.start("fft");var F=this;if(Object.prototype.toString.call(I)==="[object Function]"){this.processor.onaudioprocess=I}else{this.processor.onaudioprocess=function(P){var N=P.inputBuffer.getChannelData(0);var O=P.inputBuffer.getChannelData(1);var K=P.outputBuffer.getChannelData(0);var M=P.outputBuffer.getChannelData(1);for(var L=0;L<this.bufferSize;L++){K[L]=F.vocalcanceler.start(N[L],O[L]);M[L]=F.vocalcanceler.start(O[L],N[L])}}}}return this};c.prototype.stop=function(){if((this.source instanceof MediaElementAudioSourceNode)&&!this.media.paused){this.media.pause();this.chorus.stop(this.context.currentTime);this.flanger.stop(this.context.currentTime);this.phaser.stop(this.context.currentTime);this.autopanner.stop(this.context.currentTime);this.tremolo.stop(this.context.currentTime);this.ringmodulator.stop(this.context.currentTime);this.wah.stop(this.context.currentTime);for(var E=0,D=this.plugins.length;E<D;E++){if(this.plugins[E].plugin.isActive){this.plugins[E].plugin.stop(this.context.currentTime)}}this.analyser.stop("time");this.analyser.stop("fft");this.processor.disconnect(0)}return this};c.prototype.toggle=function(D,E,F){if(this.media instanceof HTMLMediaElement){this.media.paused?this.start(D,E,F):this.stop()}return this};c.prototype.getMedia=function(){return this.media};c.prototype.isMedia=function(){return(this.media instanceof HTMLMediaElement)?true:false};c.prototype.isSource=function(){return(this.source instanceof MediaElementAudioSourceNode)?true:false};c.prototype.isPaused=function(){return(this.media instanceof HTMLMediaElement)?this.media.paused:true};c.prototype.fullscreen=function(){if(this.media instanceof HTMLVideoElement){if(this.media.webkitRequestFullscreen){this.media.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}else{if(this.media.mozRequestFullScreen){this.media.mozRequestFullScreen()}else{if(this.media.requestFullscreen){this.media.requestFullscreen()}else{throw new Error("Cannot change to full screen !!")}}}}return this};c.prototype.exitFullscreeen=function(){if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else{if(document.mozCancelFullscreen){document.mozCancelFullscreen()}else{if(document.exitFullscreen){document.exitFullscreen()}else{throw new Error("Cannot exit from full screen !!")}}}return this};c.prototype.toString=function(){return"MediaModule"};function b(){this.source=null;this.sequences=[];this.timerids=[];this.prev=[];this.callbacks={start:function(){},stop:function(){},ended:function(){},error:function(){}}}b.prototype.setup=function(E,F){if(Object.prototype.toString.call(arguments[0])==="[object Object]"){for(var D in arguments[0]){this.setup(D,arguments[0][D])}}else{var D=String(E).toLowerCase();if(D in this.callbacks){if(Object.prototype.toString.call(F)==="[object Function]"){this.callbacks[D]=F}else{n(this+' setup() : The type of "'+E+'" is function !!')}}else{n(this+' setup() : The designated property ("'+E+'") does not exist in accessible properties !!')}}return this};b.prototype.ready=function(X,ah){if(this.source!==null){this.stop()}this.sequences=[];this.timerids=[];this.prev=[];if(!Array.isArray(ah)){ah=[ah]}if((X instanceof g)||(X instanceof f)){this.source=X}else{n(this+' ready() ; The 1st argument is X("oscillator") or X("oneshot") !!');return}while(ah.length>0){var G=String(ah.shift());var ad=60;var af=12;var T=4;var ai=/\s*(?:T\d+)\s*|\s*(?:O\d+)\s*|\s*(?:(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*\s*/ig;var ag="MML";var Z="TEMPO";var P="OCTAVE";var ab="NOTE";var L=[];var Q=G.match(ai);if(Q===null){this.callbacks.error(ag,"");return}var ae=0;var I=function(an,ao){var am=0;switch(ao){case"C":am=3;break;case"D":am=5;break;case"E":am=7;break;case"F":am=8;break;case"G":am=10;break;case"A":am=12;break;case"B":am=14;break;case"R":return"R";default:break}var al=(af*(an-1))+am;if(al>=0){return al}else{return -1}};var R=function(am){var an=Math.pow(2,(1/12));var al=27.5;if(am>=0){return al*Math.pow(an,am)}else{return -1}};while(Q.length>0){var H=Q.shift().trim();if(/T\d+/i.test(H)){var E=parseInt(H.slice(1));if(E>0){var U=ad/E}else{this.callbacks.error(Z,H);return}}else{if(/O\d+/i.test(H)){var W=parseInt(H.slice(1));if(W<0){this.callbacks.error(P,H);return}}else{if(/(?:(?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*/i.test(H)){if(U===undefined){this.callbacks.error(Z,H);return}if(W===undefined){this.callbacks.error(P,H);return}var V=H.replace(/((?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*/i,"$1");var M=[];for(var aa=0,ac=V.length;aa<ac;aa++){var ak=V.charAt(aa);var O=I.call(this,W,ak.toUpperCase());switch(V.charAt(aa+1)){case"#":case"+":O++;aa++;break;case"-":O--;aa++;break;default:break}if(O>=M[0]){O-=af}if(O<0){this.callbacks.error(ab,H);return}M.push(O)}var K=[];for(var aa=0,ac=M.length;aa<ac;aa++){var S=(M[aa]!=="R")?R.call(this,M[aa],H):"R";if(S===-1){this.callbacks.error(ab,H);return}K.push(S)}var F=H.split("&");var D=0;while(F.length>0){var aj=F.shift().replace(/(?:[CDEFGABR][#+-]?)+((?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*)/i,"$1");switch(parseInt(aj)){case 1:case 2:case 4:case 8:case 16:case 32:case 64:case 128:case 256:var N=T/parseInt(aj);D+=(aj.indexOf(".")!==-1)?((1.5*N)*U):(N*U);break;case 6:D+=(2*U)/3;break;case 12:D+=U/3;break;case 18:D+=(2*U)/9;break;case 24:D+=(0.5*U)/3;break;case 36:D+=U/9;break;case 48:D+=(0.25*U)/3;break;case 72:D+=(0.5*U)/9;break;case 96:D+=(0.125*U)/3;break;case 144:D+=(0.25*U)/9;break;case 192:D+=(0.0625*U)/3;break;default:this.callbacks.error(ab,H);break}}var J=ae;var Y=J+D;ae+=D;L.push({indexes:M,frequencies:K,start:J,duration:D,stop:Y})}}}}if(L.length>0){this.sequences.push(L);this.timerids.push(null)}}return this.sequences};b.prototype.start=function(F,E,H){var I=parseInt(F);if((I>=0)&&(I<this.sequences.length)){if(!Array.isArray(this.sequences[I])){return}if(this.sequences[I].length===0){this.stop(H);this.callbacks.ended();return this}var J=this.sequences[I].shift();if(this.source instanceof g){this.source.start(J.frequencies,E,H);for(var G=0,D=J.indexes.length;G<D;G++){if(J.indexes[G]!=="R"){this.callbacks.start(J,G)}}}else{if(this.source instanceof f){for(var G=0,D=J.indexes.length;G<D;G++){if(J.indexes[G]!=="R"){this.source.start(J.indexes[G],E,H);this.callbacks.start(J,G)}}}}this.timerids[I]=r.setTimeout(function(){if(this.source instanceof g){this.source.stop(J.frequencies,H);for(var L=0,K=J.indexes.length;L<K;L++){if(J.indexes[L]!=="R"){this.callbacks.stop(J,L)}}}else{if(this.source instanceof f){for(var L=0,K=J.indexes.length;L<K;L++){if(J.indexes[L]!=="R"){this.source.stop(J.indexes[L],H);this.callbacks.stop(J,L)}}}}this.prev=J;this.start(I,E,H)}.bind(this),(J.duration*1000))}else{n(this+" start() : The range of designated MML part is between 0 and "+(this.sequences.length-1)+" !!")}return this};b.prototype.stop=function(F){var G=this.prev;if(G.length===0){return}if(this.source instanceof g){this.source.stop(G.frequencies,F);for(var E=0,D=G.indexes.length;E<D;E++){if(G.indexes[E]!=="R"){this.callbacks.stop(G,E)}}}else{if(this.source instanceof f){for(var E=0,D=G.indexes.length;E<D;E++){if(G.indexes[E]!=="R"){this.source.stop(G.indexes[E],F);this.callbacks.stop(G,E)}}}}for(var E=0,D=this.timerids.length;E<D;E++){r.clearTimeout(this.timerids[E]);this.timerids[E]=null}return this};b.prototype.toggle=function(E,D,F){if(this.isPaused()){this.start(E,D,F)}else{this.stop()}};b.prototype.isSequences=function(){return Array.isArray(this.sequences[0])?true:false};b.prototype.isPaused=function(){for(var E=0,D=this.timerids.length;E<D;E++){var F=this.timerids[E];if((F===null)||(F===undefined)){}else{return false}}return true};b.prototype.getSequences=function(){return this.sequences};b.prototype.download=function(E){var D=r.btoa(String(E));var F="data:text/plain;base64,"+D;return F};b.prototype.toString=function(){return"MML"};var k=new e(audiocontext);var t=new g(audiocontext);var o=new f(audiocontext);var B=new p(audiocontext);var d=new c(audiocontext);var s=new m();var a=new b();i=function(G,D){var F=String(G).replace(/-/g,"").toLowerCase();switch(F){case"oscillator":if(D===undefined){return t}else{var E=parseInt(D);if((E>=0)&&(E<t.sources.length)){return t.sources[E]}else{n("XSound() : The range of the 2nd argument is between 0 and "+(t.sources.length-1)+" !!")}}break;case"oneshot":return o;case"audio":return B;case"media":return d;case"fallback":return s;case"mml":return a;default:n('XSound() : The value of the 1st argument ("'+G+'") is one of "oscillator" or "oneshot" or "audio" or "media" or "fallback" or "mml" !!');break}};i.IS_XSOUND=u;i.ERROR_MODE=y;i.SAMPLE_RATE=k.SAMPLE_RATE;i.BUFFER_SIZE=k.BUFFER_SIZE;i.NUM_INPUT=k.NUM_INPUT;i.NUM_OUTPUT=k.NUM_OUTPUT;i.error=v;i.read=w;i.file=z;i.ajax=l;i.toFrequencies=j;i.convertTime=h;i.noConflict=C;i.getCurrentTime=function(){return audiocontext.currentTime};i.toString=function(){return"XSound"};r.XSound=i;r.X=i})(window);